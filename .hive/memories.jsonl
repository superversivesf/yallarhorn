{"id":"mem-008f173d3bc6e3f7","information":"KokoroTtsEngine audio persistence fix: When persisting audio bytes to disk from a TTS engine: (1) Add OutputDirectory property to TtsConfig with sensible default like \"./output/audio\"; (2) Use lazy initialization to create directory only when needed; (3) Use File.WriteAllBytesAsync for async file I/O; (4) Generate unique filenames using segmentId + format extension; (5) Return the actual file path in AudioUrl instead of fake protocol URLs like \"audio://\". Key gotcha: Directory.CreateDirectory is synchronous but cheap - no need for async wrapper.","created_at":"2026-02-21T06:12:18.566Z","tags":"tts,audio-persistence,file-io,kokoro,dotnet"}
{"id":"mem-00a348c995e6e7e5","information":"Fixed null dereference in AAXtoM4BConvertor.cs AddMetadataToM4A method. The bug was at line 329 where regex.Match() was passed potentially null title via aaxInfo?.format.tags.title (inconsistent null-conditional chain). Fix pattern: extract nullable value to local variable, add null check before regex.Match(). Also fixed null-conditional chain on line 351 from aaxInfo.format.tags.copyright to aaxInfo?.format?.tags?.copyright.","created_at":"2026-02-22T02:40:18.832Z","tags":"null-dereference,regex,C#,null-conditional,AAXtoM4BConvertor"}
{"id":"mem-01b32e1ebc202572","information":"Yallarhorn Server Startup: Port 5001 (chosen due to macOS AirPlay conflict with port 5000). Three startup methods: 1) Docker (recommended) - `docker compose up -d` uses docker-compose.yml with named volumes, 2) CLI commands - `config validate`, `config lint`, `auth hash-password`, 3) Direct run - `dotnet run --project src/Yallarhorn`. Config file yallarhorn.yaml is required, mounted at /app/yallarhorn.yaml:ro in container. Health endpoint at /health. Development uses docker-compose.override.yml automatically.","created_at":"2026-02-27T10:39:13.848Z","tags":"yallarhorn docker server startup configuration port"}
{"id":"mem-023e9673ce327fc3","information":"Model tests for Skaldforge use NUnit + AwesomeAssertions (FluentAssertions). Test patterns: [TestFixture], [Test], Should(). assertions. Model classes tested: Character, VoiceHints, VoiceAssignment, SynthesisJob, VoiceParameters, JobError. Tests cover construction, property validation, enums, voice mapping scenarios. Collections initialized with new() syntax. Required properties use 'required' keyword (C# 11+).","created_at":"2026-02-19T22:49:04.360Z","tags":"testing,nunit,awesomeassertions,models,skaldforge,dotnet10"}
{"id":"mem-029f5c10017fab0a","information":"System.CommandLine preview (3.0.0-preview) uses SetAction() method with ParseResult and CancellationToken parameters, Options use Options.Add() method, Commands use Subcommands.Add() method. The Option constructor takes aliases and description is a property, not a constructor parameter. RootCommand.Parse(args).Invoke() returns the exit code synchronously.","created_at":"2026-02-26T05:53:17.602Z","tags":".NET,System.CommandLine,CLI,tutorial"}
{"id":"mem-02be5821e81709d1","information":"AudioPipeline music integration: Added IMusicGenerator and IAudioStitcher dependencies to AudioPipeline constructor. Music is generated per scene after voice synthesis using InferMoodFromScene(). Music ducking applied via IAudioStitcher.MixWithDuckingAsync(). The MusicConfig comes through AudioPipelineOptions.Music property. Added SegmentType.Mixed enum value for combined voice+music segments. Added MixWithDuckingAsync to IAudioStitcher interface and SoundFlowStitcher delegates to FFmpegStitcher. Adapter pattern bridges Music namespace types to Core.Interfaces types.","created_at":"2026-02-23T00:11:48.074Z","tags":"audio-pipeline,music-generation,ducking,dependency-injection"}
{"id":"mem-02d9ef220ee41ecf","information":"Created Playlist DTOs in Odeon.Core.DTOs namespace:\n- PlaylistResponseDto: Contains Id, Name, Description, CreatedAt, UpdatedAt, and Items (IReadOnlyList<PlaylistItemDto>)\n- PlaylistItemDto: Contains Id, VideoId, VideoTitle, ThumbnailUrl, Position, AddedAt\n- CreatePlaylistRequest: Contains Name, Description (optional)\n- AddPlaylistItemRequest: Contains VideoId, Position (optional)\n\nFollowed Odeon patterns: record types, XML comments, uppercase DTOs directory","created_at":"2026-02-23T08:56:57.975Z","tags":"odeon,dotnet,dto,playlist"}
{"id":"mem-033e2c073a6972f9","information":".NET modernization audit: Logger.cs and ChapterConvertor.cs successfully modernized. Key patterns applied: (1) Primary constructor syntax for simple initialization, (2) String interpolation with format specifiers ($\"{value:F0}\"), (3) Null-conditional operators for safe navigation (?. and ??), (4) Collection empty fallback pattern (?? []), (5) Changed public class to internal for visibility consistency. All 47 other warnings in project are from other files (AAXCtoM4BConvertor, AAXtoM4BConvertor, Program, FFProbeAnalyzer).","created_at":"2026-02-21T22:31:28.280Z","tags":"csharp,modernization,nullable-safety,string-interpolation,primary-constructor"}
{"id":"mem-03a2db51e6413b89","information":"Romcal calendar packages (@romcal/calendar.*) version 3.0.0-alpha.0 show peer dependency warnings \"incorrect peer dependency 'romcal@1.3.0'\" but they still function correctly. This is a known versioning issue with the alpha releases - the packages work with romcal 1.3.0 despite the warning. Do not downgrade romcal to resolve; the warning can be safely ignored during development.","created_at":"2026-02-20T20:10:52.756Z","tags":"romcal,dependencies,peer-dependency,liturgical-calendar,gotcha"}
{"id":"mem-03a3e9b4d25b2c1f","information":"EF Core case-insensitive search: Use EF.Functions.Like(column, $\"%{searchTerm}%\") instead of ToLower().ToLower() which prevents index usage. SQLite's LIKE is case-insensitive by default for ASCII characters. EF.Functions.Like works correctly with both SQLite and InMemoryDatabase for testing. Added indexes on searchable columns (Title, Description, ChannelName) to improve query performance.","created_at":"2026-02-17T22:09:51.610Z","tags":"ef-core,sqlite,case-insensitive,search,index"}
{"id":"mem-0490f35a7e0fa44c","information":"KokoroTtsEngine implementation: Maps ITtsEngine interface to KokoroClient API. Key patterns:\n1. Voice mapping: KokoroVoiceMapper.ToTtsVoice() converts Kokoro API voices to TtsVoice with language code parsing (af_heart → American Female)\n2. Batch synthesis: Uses SemaphoreSlim for concurrency control in parallel processing\n3. Voice caching: GetVoicesAsync caches voices locally to avoid repeated API calls\n4. Audio format mapping: MapAudioFormat/MapFromKokoroFormat handles format conversion between Skaldforge and Kokoro\n5. Voice ID parsing: Format is {lang}{gender}_{name} where lang codes are: a=American, b=British, e=Spanish, f=French, g=German, etc. Gender is m/f suffix.","created_at":"2026-02-21T05:08:58.949Z","tags":"kokoro,tts,implementation,voice-mapping"}
{"id":"mem-05318887e4454801","information":"Prayer JSON format in sancta_via_prayer_companion: Each prayer file has fields: id (slug), title, text (full prayer with \\n for newlines), translation (optional object with latin key), attribution, notes, categories (array matching metadata categories), description, tags (array), isLiturgical (boolean), liturgicalPriority (0-10), liturgicalSeason (null or season name), timeOfDay (optional). Metadata file tracks all prayers with same fields except text/translation/attribution/notes. New categories must be added to both categoryGroups (with id, title, description, icon, order) and categories (with id, title, description, groupId) arrays. Files named using snake_case: prayer_name.json.","created_at":"2026-02-22T02:34:13.380Z","tags":"prayer json format data model sancta_via"}
{"id":"mem-05bce067fa55f479","information":"Yallarhorn uses a dual authentication model: feed_auth for /feed/* endpoints (read-only RSS/Atom access) and admin_auth for /api/* endpoints (read-write management API). No YouTube API required - uses yt-dlp directly. BCrypt password hashing recommended with work factor 11. Health endpoint /api/v1/health is intentionally public for load balancer checks.","created_at":"2026-02-24T09:53:57.805Z","tags":"yallarhorn,authentication,http-basic-auth,bcrypt,aspnet-core"}
{"id":"mem-0663fc55d453aa55","information":"## Skaldforge Technical Debt Analysis (Feb 2026)\n\n**What:** Completed comprehensive codebase scan for technical debt markers.\n\n**Key Findings:**\n\n1. **Placeholder Code (3 files):**\n   - `src/Skaldforge.Tts/Class1.cs` - Empty placeholder\n   - `src/Skaldforge.Audio/Class1.cs` - Empty placeholder  \n   - `src/Skaldforge.Ai/Class1.cs` - Empty placeholder\n\n2. **Placeholder Test:**\n   - `tests/Skaldforge.Tests/UnitTest1.cs` - Empty test method with no assertions\n\n3. **Placeholder CLI:**\n   - `src/Skaldforge.Cli/Program.cs` - \"Hello World\" only, no commands implemented\n\n4. **Missing Implementations (6 interfaces defined but no services):**\n   - `IStoryParser` - No implementation exists\n   - `ICharacterAnalyzer` - No implementation exists\n   - `IVoiceMapper` - No implementation exists\n   - `ITtsEngine` - No implementation exists\n   - `IAudioStitcher` - No implementation exists\n   - `IManuscriptRepository` - No implementation exists\n\n5. **Missing CI/CD:**\n   - No `.github/workflows/` directory\n   - No build, test, or lint automation\n\n6. **TODO.md Status (467 lines):**\n   - Milestone 1: ~60% complete (models/interfaces done, implementations missing)\n   - Milestone 2: 0% complete (AI integration)\n   - Milestone 3: 0% complete (TTS/audio pipeline)\n   - Milestone 4: 0% complete (export/release)\n   - ~350+ tasks remain unchecked\n\n**No explicit HACK/FIXME comments found in source code.** The debt is primarily \"missing implementations\" rather than \"bad code that needs fixing.\"\n\n**Root Cause:** Project is early-stage with solid architecture (models, interfaces, config) but implementations not yet built.","created_at":"2026-02-19T18:35:16.923Z","tags":"skaldforge,technical-debt,analysis,codebase-status,missing-implementations"}
{"id":"mem-067c0877cbbd0e88","information":"Fixed Yallarhorn.csproj target framework from net9.0 to net10.0. Simple PropertyGroup edit in the csproj file.","created_at":"2026-02-24T04:46:20.358Z","tags":"dotnet,csproj,targetframework"}
{"id":"mem-07056a3b9795c7b4","information":"Yallarhorn test suite: 1,130 tests passing, 11 integration tests intentionally skipped (require live API/database). Tests run with `dotnet test` in solution root. No failures found during P8-001 task.","created_at":"2026-02-26T05:34:34.786Z","tags":"yallarhorn,testing,dotnet,xunit"}
{"id":"mem-082e4874ae340347","information":"When testing Flutter widgets that use Riverpod's StreamProvider.periodic (like currentDateProvider in sancta_via_liturgical_calendar_riverpod), tests will fail with \"A Timer is still pending even after the widget tree was disposed\" because periodic streams never complete.\n\nSolution: Override the provider in tests with a simple stream that emits once:\n```dart\ncurrentDateProvider.overrideWith(\n  (ref) => Stream.value(DateTime.now()),\n)\n```\n\nThis prevents the periodic timer from running and allows tests to complete successfully.","created_at":"2026-02-25T05:55:29.751Z","tags":"flutter,riverpod,testing,stream-provider,timer,gotcha"}
{"id":"mem-0898ddf5f29cb424","information":"When creating C# domain models for Skaldforge:\n\n1. Use nullable reference types (enabled in Directory.Build.props)\n2. Use `required` keyword for mandatory properties in models\n3. Enable `<GenerateDocumentationFile>true</GenerateDocumentationFile>` in .csproj for XML docs\n4. Use enum types for constrained string values (genre, emotion, voice pitch, etc.)\n5. JSON property names use snake_case (audio_settings) but C# properties use PascalCase - use [JsonPropertyName] attribute\n6. Project uses Central Package Management in Directory.Packages.props\n7. Code style rules are enforced: braces required for all control flow statements\n8. Models should match JSON schema in docs/TECHNICAL_SPECS.md exactly","created_at":"2026-02-19T10:16:11.673Z","tags":"csharp,dotnet,skaldforge,models,nullable,domain-models"}
{"id":"mem-09399bd4641ea6c0","information":"ChatterboxTtsEngine unit test patterns: When mocking ChatterboxClient with NSubstitute, pass a valid URL (\"http://localhost\", 30) to the Substitute.For call since HttpClient requires a valid URI - empty strings cause UriFormatException. The client's internal methods (MapEmotionToExaggeration, MapSpeedToTemperature) are internal static, so test them indirectly through SynthesizeAsync by capturing the ChatterboxSynthesisRequest passed to the mock client.","created_at":"2026-02-22T23:30:08.365Z","tags":"testing,nsubstitute,chatterbox,tts,mocking"}
{"id":"mem-0c343912ca71724c","information":"When wiring routes into a Flutter go_router with StatefulShellRoute, nested routes must use relative paths (not absolute). For example, under a StatefulShellBranch with path '/bible', nested routes use 'reading-plan' not '/bible/reading-plan'. The full path '/bible/reading-plan' is only used for context.push() navigation calls. Route constants in AppRoutes should store the full path for navigation use.","created_at":"2026-02-26T20:33:18.659Z","tags":"flutter,go_router,navigation,routes,StatefulShellBranch"}
{"id":"mem-0ca30b5cb616c2a6","information":"Yallarhorn startup pipeline configuration pattern: Use `WebApplication` with `UseYallarhornPipelineAsync()` for async database initialization (since Main now supports top-level await). The pattern uses `EnsureCreatedAsync()` for SQLite which works well without migrations. DevelopmentSeeder is registered as scoped service and called within a service scope during startup. Background workers (RefreshWorker, DownloadWorker) are registered as HostedServices. Rate limiting uses `AddRateLimiterServices()` for DI configuration and `UseRateLimiter()` + `UseRateLimitHeaders()` in the pipeline.","created_at":"2026-02-26T01:35:31.930Z","tags":"yallarhorn,startup,pipeline,dependency-injection,background-workers,database-initialization"}
{"id":"mem-0cc747e5e6b2d160","information":"AAXtoM4BConvertor code quality: (1) ProgressMeter method was dead code - removed along with unused Xabe.FFmpeg.Events import. (2) Codebase already uses is null/is not null pattern - string.IsNullOrEmpty() is idiomatic for strings. (3) Author count threshold 4 extracted to MaxAuthorCountForIndividualDisplay constant.","created_at":"2026-02-22T02:11:15.685Z","tags":"code-quality,AAXtoM4BConvertor,refactoring,constants"}
{"id":"mem-0cf6435c073de9bb","information":"ASP.NET Core IHostedService registration pattern: Use `AddHostedService()` with factory lamdas when workers need constructor arguments from configuration. Workers can be conditionally registered based on configuration options. Pattern: `services.AddHostedService(sp => new WorkerType(dependencies...))`. This allows injecting configured values (like poll intervals) from config classes.","created_at":"2026-02-26T03:19:31.338Z","tags":"dotnet,ihostedservice,di,background-workers,configuration"}
{"id":"mem-0d1bb145be0e1150","information":"Controller tests in Yallarhorn should mock FindAsync() and GetAllAsync() methods, not GetPagedAsync(). Controllers perform client-side pagination after fetching data from the repository. EpisodesController uses FindAsync() for filtered queries, ChannelsController uses FindAsync() for filtered queries and GetAllAsync() for unfiltered queries. Tests should return all items and let the controller handle pagination/sorting.","created_at":"2026-02-27T04:36:16.213Z","tags":"yallarhorn,testing,moq,controller,repository,pagination"}
{"id":"mem-0d30ed5ece763181","information":"CharacterHint pattern for Skaldforge: When implementing user-provided hints that override LLM-extracted values, use a separate CharacterHint model with nullable properties. Matching is done by ID first (case-insensitive), then by name. Only non-null hint properties are applied during merge. VoiceHints uses a separate VoiceHintOverrides class for the same pattern. The CharacterExtractionPrompt.FormatHintsForPrompt() helper formats hints for LLM prompt injection.","created_at":"2026-02-20T02:37:22.694Z","tags":"skaldforge,character-analyzer,hint-merging,LLM-override"}
{"id":"mem-0e4a26684c3f68e8","information":"Yallarhorn test investigation: User reported 67 test errors from dotnet test. Root cause was constructor signature mismatches in RefreshWorkerTests and DownloadWorkerTests - tests were passing wrong mock types (IChannelRefreshService instead of IServiceScopeFactory). However the fixes were already in place when we went to fix them. All worker tests now pass (46 tests). If user still sees errors, they may need to clean/rebuild: `dotnet clean && dotnet build`.","created_at":"2026-02-27T00:46:30.478Z","tags":"yallarhorn,dotnet,testing,constructor-mismatch,IServiceScopeFactory"}
{"id":"mem-0e985da2f3a4fafa","information":"TestRunner consolidation complete: StitchRunner and MusicRunner merged into TestRunner. Key migrations: --three-track mode for stitch command with volume controls, --seed option for music command. Deprecated projects removed from solution and directories deleted.","created_at":"2026-02-26T21:35:59.602Z","tags":"skaldforge,consolidation,testrunner,stitchrunner,musicrunner"}
{"id":"mem-0f16b486884aac65","information":"FFmpegStitcher normalization fails when Xabe.FFmpeg cannot find ffmpeg binary. Fix: Call FFmpeg.SetExecutablesPath() at startup to point to system ffmpeg (e.g., /opt/homebrew/bin on macOS). Without this, Xabe defaults to downloading its own ffmpeg which may not work correctly with loudnorm filter or may have path resolution issues. The stitcher was failing with \"Could not find file\" errors even though the normalization appeared to complete - this was because Xabe was not properly configured.","created_at":"2026-02-26T04:20:45.364Z","tags":"ffmpeg,xabe,normalization,stitcher,configuration"}
{"id":"mem-0f5d1fd2dccbae97","information":"Program.cs magic number extraction completed: SpinnerDelayMs=50 was extracted as a public const for spinner animation delays. The loop sleep was already using TimeSpan.FromMinutes(5) correctly. MaxAuthorsBeforeVarious=4 is defined in AaxToM4BConvertor.cs and AaxcToM4BConvertor.cs (where it's used), not in Program.cs. No string.Empty issues found in Program.cs (no empty string literals present there).","created_at":"2026-02-22T02:21:09.633Z","tags":"harmony,magic-numbers,constant-extraction,csharp,program.cs"}
{"id":"mem-0f9b0a2043a51e9c","information":"Sancta Via Flutter Monorepo Structure: \n- 5 Apps: prayer_companion (1.1.29), novena_companion (1.1.36), liturgical_calendar_app (1.1.35), confession_companion (1.1.37), bible_reading_app (1.1.42)\n- 5 Packages: sancta_via_liturgical_calendar (pure Dart), sancta_via_liturgical_calendar_riverpod, sancta_via_shared_ui, sancta_via_bible_data (pure Dart), sancta_via_bible_data_riverpod\n- Key Pattern: Each pure Dart data package has a corresponding Riverpod wrapper\n- All apps depend on liturgical calendar for dynamic theming\n- Build system: Makefile per app + melos.yaml for workspace\n- App Store metadata in each pubspec.yaml under app_store: key","created_at":"2026-02-24T09:40:42.284Z","tags":"monorepo,flutter,structure,packages,apps,dependencies"}
{"id":"mem-11c58b20393a80f8","information":"Skaldforge project structure discovery for audio stitching:\n1. Main stitching implementation: /Users/jason/Repos/skaldforge/src/Skaldforge.Stitching/FFmpegStitcher.cs - 905 lines, handles combining audio segments into chapters using FFmpeg. Contains ad-hoc Console.WriteLine debug logging, no structured logging.\n2. Stitching config: /Users/jason/Repos/skaldforge/src/Skaldforge.Stitching/StitchingConfig.cs\n3. FFmpeg wrapper: /Users/jason/Repos/skaldforge/src/Skaldforge.Stitching/FFmpegWrapper.cs\n4. Chapter-related code is primarily in FFmpegStitcher.cs (StitchChapterAsync, ExportAsync with chapter timings) and TestRunner/Program.cs (chapter filtering and stitching workflow)\n5. Logging infrastructure exists in /Users/jason/Repos/skaldforge/src/Skaldforge.Core/Configuration/LoggingConfig.cs - defines LogLevel enum and LoggingConfig class with LogLevel, LogFilePath, ConsoleOutput properties. However, this config is NOT currently used by the stitcher - it uses raw Console.WriteLine calls.\n6. No demo.json found in audio-output directory - searched entire project and found domo.json at root, but no audio-output/demo.json.\n7. Audio outputs exist in /Users/jason/Repos/skaldforge/audiobook-output/ with chapter_001 and chapter_002 directories containing WAV files.\n\nThe stitching code currently uses debug Console.WriteLine statements throughout. The LoggingConfig exists but is not integrated into the stitching module.","created_at":"2026-02-24T09:36:11.830Z","tags":"skaldforge,audio-stitching,path-discovery,logging,chapter-processing"}
{"id":"mem-13d623f86e130b11","information":"SoundFlow WAV loading - use ReadOptions constructor for auto-detection\n\n**Problem:** `StreamDataProvider(AudioEngine, AudioFormat, Stream)` constructor hardcodes the audio format. When loading WAV files with different sample rates (e.g., Kokoro TTS at 24000Hz vs config default at 44100Hz), SoundFlow's internal WavReader calculates incorrect stream positions, causing `ArgumentOutOfRangeException: Non-negative number required` when setting `FileStream.Position`.\n\n**Fix:** Use `StreamDataProvider(AudioEngine, Stream, ReadOptions)` constructor which auto-detects format from the file header:\n```csharp\n// BEFORE (broken):\nvar stream = File.OpenRead(filePath);\nreturn new StreamDataProvider(_engine, _audioFormat, stream);\n\n// AFTER (fixed):\nvar stream = File.OpenRead(filePath);\nreturn new StreamDataProvider(_engine, stream, new ReadOptions());\n```\n\nThe `ReadOptions` constructor allows SoundFlow to read the WAV header and determine the actual sample rate, channels, and sample format from the file itself.","created_at":"2026-02-22T02:23:53.555Z","tags":"SoundFlow,WAV,audio,bug-fix,ArgumentOutOfRangeException,StreamDataProvider"}
{"id":"mem-149f0a5834de5bb2","information":"FFmpegStitcher fix for 2x duration expansion: Pre-converting all audio to uniform 44100Hz stereo 16-bit PCM before concatenation fixes the static and duration doubling caused by mixing formats. Result: 156MB (31.5 min) → 80MB (15.8 min). The issue was FFmpeg's concat filter producing wrong duration when mixing sample rates.","created_at":"2026-02-26T07:19:12.930Z","tags":"ffmpeg stitching audio-merge bug-fix duration"}
{"id":"mem-15050147eed869d9","information":"Docker documentation created for Yallarhorn podcast server. Key details: Uses port 5001, requires yt-dlp and ffmpeg. Data stored in /app/data, config via yallarhorn.yaml. Supports both named volumes and host bind mounts. Includes health check at /health endpoint. Multi-stage Dockerfile with .NET 10 SDK and ASP.NET runtime.","created_at":"2026-02-26T09:42:16.826Z","tags":"docker,deployment,yallarhorn,documentation,port-5001"}
{"id":"mem-172b43ced951a8a3","information":".NET 10 ASP.NET Core project structure: Use net10.0 target framework with Microsoft.NET.Sdk.Web SDK. Include Scalar.AspNetCore package for OpenAPI UI, requires `using Scalar.AspNetCore;` directive. Test projects use Microsoft.NET.Test.Sdk, xunit, xunit.runner.visualstudio, and FluentAssertions. Requires `using Xunit;` for Fact attribute. Directory.Build.props with source link fails warning in non-git directories (expected).","created_at":"2026-02-24T19:41:38.045Z","tags":".net,aspnet,csproj,xunit,testing,structure"}
{"id":"mem-18cca09f98cc5069","information":"Novena JSON format in novena_companion app requires: id (kebab-case filename without .json), title, description, saint, feast_day, intention_category, difficulty, duration_minutes, intention, instructions, background_info, days[9] (each with day, title, opening_prayer, daily_prayer, closing_prayer, reflection, intention_prayer, scripture), source, notes. The database initializer auto-discovers novenas from assets/novenas/*.json but has a fallback list that should be updated. All novenas in the app follow a consistent 9-day structure with daily themed reflections.","created_at":"2026-02-22T04:58:32.265Z","tags":"novena-companion,json-format,flutter,database-initializer"}
{"id":"mem-191fab0f7374f808","information":"PRAYER APP STRUCTURE (sancta_via_prayer_companion):\n- Prayers stored as individual JSON files in assets/prayers/ directory\n- Metadata index at assets/prayers/prayers_metadata.json\n- Runtime SQLite database (prayers.db) migrated from JSON on first launch\n- Data model: Prayer class with id, title, text, translations, categories, tags, isLiturgical, liturgicalPriority, liturgicalSeason, timeOfDay\n- 6 category groups: essential, daily, liturgical, marian, saints, sacramental\n- 7 categories: essential, morning, evening, mass, marian, saints, confession\n- 67 prayers currently defined\n- Key files: models/prayer.dart, repositories/prayer_repository.dart, database/prayer_database.dart\n- Liturgical seasons: lent, easter, christmas, ordinary, corpus_christi\n- Time of day: morning, evening, anytime\n- Architecture: Repository pattern with singleton, Riverpod providers","created_at":"2026-02-22T02:23:25.064Z","tags":"prayer,flutter,data-model,structure,sancta_via"}
{"id":"mem-19dad71a199f7ebb","information":"FFmpegStitcherTests TearDown fix: File/directory lock issue resolved by:\n1. Adding [NonParallelizable] attribute to test class to prevent concurrent test execution causing file locks\n2. Adding GC.Collect() + GC.WaitForPendingFinalizers() before cleanup to ensure disposed resources release file handles\n3. Adding retry logic (5 attempts, 100ms delay) for IOException and UnauthorizedAccessException in TearDown\n\nRoot cause: Tests running in parallel can cause temp directory cleanup races, and FFmpegWrapper disposal may not immediately release file handles.","created_at":"2026-02-21T07:50:22.793Z","tags":"testing,nunit,file-lock,cleanup,dispose"}
{"id":"mem-19e59d690b9d35ee","information":"Bug fix: _generateBookId() crashed on short book names (1-2 chars). Root cause: used original bookName.length for condition but operated on modified (cleaned) string after replaceAll(). Fix: assign cleaned string to variable first, then use its length for both condition and substring.","created_at":"2026-02-20T04:38:40.991Z","tags":"dart,bug-fix,substring-bounds,defensive-programming"}
{"id":"mem-1a375ae0945c6b7d","information":"ASP.NET Core Exception Handling Middleware Pattern:\n1. Use middleware with RequestDelegate for pipeline chaining\n2. Switch expressions for exception-to-status-code mapping must order derived types BEFORE base types (e.g., ArgumentNullException before ArgumentException) to avoid CS8510 \"pattern is unreachable\" errors\n3. Use IWebHostEnvironment.IsDevelopment() to conditionally include stack traces\n4. Use HttpContext.TraceIdentifier as fallback for request ID\n5. Set Content-Type to \"application/json\" and serialize ErrorDetails model with System.Text.Json","created_at":"2026-02-24T20:24:10.136Z","tags":"ASP.NET Core,middleware,exception handling,testing"}
{"id":"mem-1a7d8dfb2408e3bb","information":"Skaldforge TestRunner CLI created at src/Skaldforge.TestRunner. When using Spectre.Console tables, always escape user/exception content with Markup.Escape() to prevent parsing errors. HttpClient typed client DI requires Microsoft.Extensions.Http package. AudioPipeline requires VoiceAssignments when characters exist and VoiceMapper is null - provide default mappings or skip voice mapping.","created_at":"2026-02-21T06:31:22.520Z","tags":"skaldforge,cli,spectre-console,dependency-injection,httpclient,audio-pipeline"}
{"id":"mem-1a957a1cde309d61","information":"Yallarhorn ChannelRefreshService pattern: Use IYtDlpClient.GetChannelVideosAsync() to fetch video list, filter by rolling window using EpisodeCountConfig, dedupe by video_id using IEpisodeRepository.GetByVideoIdAsync(), create Episode records, queue via IDownloadQueueService.EnqueueAsync(). Update Channel.LastRefreshAt timestamp. Use IChannelRepository.GetEnabledAsync() for RefreshAllChannelsAsync(). Tests require mocking IYtDlpClient and IDownloadQueueService with real SQLite database for EpisodeRepository.","created_at":"2026-02-25T07:37:59.576Z","tags":"yallarhorn channel-refresh yt-dlp episode-discovery patterns"}
{"id":"mem-1cc1db9c03985905","information":"Created YallarhornDbContext with: 5 DbSets (Feed, Source, Episode, RollingWindowConfig, DownloadJob), OnModelCreating configures all entity relationships (one-to-one, one-to-many, many-to-one), property constraints (max lengths, required fields), indexes, and enum conversions. SaveChangesAsync auto-updates UpdatedAt timestamp on Feed and Source entities. SQLite configuration uses DatabaseOptions for connection string and sensitive data logging.","created_at":"2026-02-24T08:04:06.517Z","tags":"entity-framework,dbcontext,sqlite,ef-core,yallarhorn"}
{"id":"mem-1fbae56d260848ed","information":"Skaldforge project assessment shows ~35% completion. StoryParser fully implemented with validation. Active blockers: CI/CD (B1), CLI commands (B2), placeholder projects (B5). Test infrastructure configured with NUnit + AwesomeAssertions. .NET 9 upgrade in progress.","created_at":"2026-02-19T21:39:55.917Z","tags":"skaldforge,assessment,project-status,blockers,tech-debt"}
{"id":"mem-21fe5842670f4017","information":"N+1 Query Fix Pattern for SQLite/Flutter: To fix N+1 query problems in SQLite with sqflite, create a batch loading helper method that:\n1. Loads all parent records (e.g., prayers) in one query\n2. Extracts IDs from parent records\n3. Uses SQL IN clause with placeholders to batch-load all related records (categories, tags, translations) in just 3 queries instead of N*3\n4. Builds a map from ID to relations object\n5. Provides a helper method to construct final objects from parent records + relations map\n\nThis reduces database queries from O(N) to O(1) for each relation type, dramatically improving performance for collections.","created_at":"2026-02-23T00:27:52.556Z","tags":"sqlite,flutter,performance,n+1-query,batch-loading,sqflite"}
{"id":"mem-225ac810925a6db7","information":"ProseParser implementation pattern: When parsing LLM JSON responses for Manuscript objects, parse characters first (needed for cross-reference validation), then scenes, then chapters. Use IdTracker class to generate sequential IDs (char_001, scene_001, chapter_001) and track existing IDs to avoid duplicates. Cross-reference validation should check: (1) dialogue speakerId → character id, (2) chapter scene references → scene ids, (3) orphaned scenes not referenced by any chapter. NarratorConfig only has VoiceId, VoiceHints, and Pace - no Name or Provider properties. AudioSettings.OutputFormat is an enum (AudioFormat), not a string.","created_at":"2026-02-20T03:28:02.674Z","tags":"csharp,parsing,json,manuscript,id-generation,validation,skaldforge"}
{"id":"mem-22ab45dc505b2e8f","information":"xUnit test async pattern: In this C# project, tests use `async Task` return type with `await Task.CompletedTask;` for consistency, even when tests don't call async code. This avoids xUnit analyzer warnings about not using ConfigureAwait(false) in tests. The pattern: `[Fact] public async Task TestName() { /* assertions */ await Task.CompletedTask; }`","created_at":"2026-02-22T23:37:19.086Z","tags":"xunit,async,testing,c#,pattern"}
{"id":"mem-26a7b05a74ca428a","information":"Analyzed auto-play next video logic for Odeon Flutter app. Key findings:\n\n1. **Video end detection**: Currently only partial - `_onPositionChanged` checks `position >= duration` but doesn't trigger any auto-play action. Need to add completion listener using `_player.stream.completed` from media_kit.\n\n2. **Queue/playlist state**: Does NOT exist in VideoPlayerNotifier. VideosProvider manages video list but NOT playback queue. Need new state: `List<Video> queue`, `int currentIndex`, methods to add/remove/reorder.\n\n3. **Seamless transition**: Would require loading next video before current ends, pre-buffering, and smooth UI transitions. Complex but doable.\n\n4. **Audio service integration**: OdeonAudioHandler already extends QueueHandler but doesn't use queue. AudioService has built-in skipToNext/skipToPrevious that could be leveraged.\n\nComplexity: MEDIUM-HIGH - requires new state management, completion detection, and queue lifecycle management.","created_at":"2026-02-23T06:55:31.080Z","tags":"odeon,flutter,video-player,auto-play,queue,playlist"}
{"id":"mem-26af22b1251a477c","information":"FFmpeg C# Process Client Implementation: \n- Use ProcessStartInfo with RedirectStandardOutput/RedirectStandardError for FFmpeg process execution\n- Parse stderr for progress (frame=, time=, bitrate=, speed= patterns via regex)\n- Use ffprobe -v quiet -print_format json -show_format -show_streams for media info\n- Progress callback pattern: Read stderr line by line, parse with regex, invoke callback\n- Timeout pattern: CancellationTokenSource.CreateLinkedTokenSource with CancelAfter\n- Audio transcode: -vn -acodec [libmp3lame|aac|libvorbis] -b:a -ar -ac\n- Video transcode: -c:v libx264 -preset -crf -c:a aac -movflags +faststart","created_at":"2026-02-25T06:03:02.126Z","tags":"ffmpeg,C#,process,transcoding,progress-parsing"}
{"id":"mem-275ba2fbc96f4041","information":"Xabe.FFmpeg API patterns (v5.2.6):\n- Use `FFmpeg.Conversions.New()` (plural \"Conversions\") to create a conversion instance\n- `Start(arguments)` on IConversion returns `IConversionResult`, not bool\n- For progress: wire up `conversion.OnProgress += (sender, args) => { ... }` before calling Start\n- Use `Probe.New().Start(\"-version\")` for version info (not FFmpeg.GetFFmpegPathAsync which doesn't exist)\n- Set custom FFmpeg path via `FFmpeg.SetExecutablesPath(directoryPath)` before any operations\n- FFmpeg needs to be in PATH or SetExecutablesPath must be called - Xabe auto-discovers from PATH","created_at":"2026-02-21T07:26:32.600Z","tags":"xabe.ffmpeg,dotnet,audio,wrapper,api-patterns"}
{"id":"mem-27d66e9c04ae1e00","information":"DTO Modernization in Harmony-2.0: 1) AudibleVoucherDto MUST keep Newtonsoft.Json because AAXCtoM4BConvertor uses JsonConvert.DeserializeObject (line 63). 2) Files using System.Text.Json (AaxInfoDto, AudibleChaptersDto, AbsMetadata) can migrate from Newtonsoft.Json to System.Text.Json with JsonPropertyName attributes. 3) Class name conflict: AaxInfoDto and AudibleChaptersDto both defined 'Chapter' class with different structures - resolved by renaming to AaxChapter and keeping Chapter (both under Harmony.Dto namespace). 4) AudibleLibraryDto uses CsvHelper with convention-based mapping (property names match TSV headers) - keep camelCase property names, only add nullable annotations. 5) All consumer code uses PropertyNameCaseInsensitive=true with JsonSerializer so property names can be PascalCase with JsonPropertyName mapping.","created_at":"2026-02-21T22:27:59.130Z","tags":"dotnet,dto,serialization,modernization,harmony"}
{"id":"mem-28b3c70e516e87f4","information":"FFProbeAnalyzer.cs audit completed. File had naming issue (FFprobeAnalyzer → FFProbeAnalyzer), unused variable, redundant usings. Added ConfigureAwait(false) for async calls. CRITICAL: Found logic bug - Probe.New().Start() with malformed command string (trailing quote without opening quote), result was unused, method always returns true making validation meaningless. This needs manual review.","created_at":"2026-02-21T22:33:20.924Z","tags":"FFProbeAnalyzer,audit,modernization,async,bug-found"}
{"id":"mem-29045397c253f586","information":"Unit tests for MusicConfig defaults and MixWithDuckingAsync. Key learnings: The FFmpegWrapper class has non-virtual methods and cannot be easily mocked with NSubstitute. For testing FFmpegStitcher.MixWithDuckingAsync, focus on validation tests (file existence checks, disposal checks) and use the FFmpegCommands static method tests for unit testing the FFmpeg argument generation. The test file follows established patterns from FFmpegStitcherTests.cs and uses FluentAssertions + NSubstitute + NUnit.","created_at":"2026-02-23T00:25:34.785Z","tags":"unit-testing,ffmpeg,music-ducking,skaldforge"}
{"id":"mem-2980fa26dc4f10ef","information":"## Audio Duration Discrepancy in Skaldforge Stitching\n\n### Problem\nThe stitched output file is nearly 2x longer than expected (31.5 min vs 16.2 min from concat list).\n\n### Root Cause Analysis\n1. **Duration Mismatch**: Expected ~970s from concat list, actual output is 1890s (ratio: 1.95x ≈ 2x)\n2. **Pre-normalization file (stereo, 1890s)** is already doubled - the concat step produces wrong duration\n3. FFmpeg concat command in FFmpegStitcher.cs line 298:\n   ```\n   -f concat -safe 0 -i \"{concatListPath}\" -ar 44100 -ac 2 -c:a pcm_s16le\n   ```\n\n### Likely Cause\nThe concat demuxer may be incorrectly handling mono→stereo conversion, potentially causing each mono input to become left+right copies (effectively 2x samples when converted to stereo and then processed).\n\nWhen concatenating mono files (TTS at 24kHz mono) to stereo output (44.1kHz stereo) while simultaneously resampling, FFmpeg may be creating extra samples.\n\n### Source File Format Issues\n- TTS: 24000 Hz, mono, s16 (16-bit PCM)\n- SFX/Music: 44100 Hz, stereo, flt (32-bit float)\n- The mix of formats during concat + resample + channel conversion may cause issues\n\n### Additional Notes\n- The intro_preview.wav is mono (correct)\n- Music files are stereo 32-bit float\n- The loudnorm filter appears to work correctly\n- No clipping detected in source files\n\n### Recommendation\nEither:\n1. Concat as mono, then normalize\n2. OR pre-convert all inputs to target format before concat\n3. OR verify the concat demuxer behavior with mixed sample rates/channels","created_at":"2026-02-26T05:54:55.762Z","tags":"audio ffmpeg stitching duration bug debugging"}
{"id":"mem-2a0230f8750e6053","information":"FFmpeg 3-track audio mixing pattern:\n1. Use FFmpeg's amix filter: [track1][track2][track3]amix=inputs=3:duration=longest:dropout_transition=2[aout]\n2. Apply volume filters per track: [0:a]volume=1.0[narration];[1:a]volume=0.7[sfx];[2:a]volume=0.3[music]\n3. Generate silence gaps with anullsrc lavfi: -f lavfi -i anullsrc=r=44100:cl=stereo -t <seconds>\n4. Position audio using adelay filter: -af \"adelay=<ms>|<ms>\" (channel-specific delay)\n5. Default volume hierarchy: Narration 100%, SFX 70%, Music 30%","created_at":"2026-02-26T09:34:46.722Z","tags":"ffmpeg audio mixing 3-track amix volume ducking"}
{"id":"mem-2a474b4b4a651b7c","information":"AudibleVoucherDto.cs uses Newtonsoft.Json attributes ([JsonProperty]) because the consumer AAXCtoM4BConvertor.cs uses JsonConvert.DeserializeObject for deserialization. This design decision is documented at the file level to explain why System.Text.Json is not used, preventing future maintainers from inadvertently breaking compatibility.","created_at":"2026-02-22T02:22:26.880Z","tags":"newtonsoft.json,documentation,design-decision,DTO,deserialization"}
{"id":"mem-2c313adb103bb838","information":"Flutter Sancta Via Design Patterns: All apps use Riverpod (FutureProvider for async data, StateNotifierProvider for mutable state, StateProvider for simple values), Repository pattern with singleton and caching, GoRouter for navigation, ConsumerWidget for UI. Known issues: N+1 queries in database layer, DateTime.now() in build methods, missing accessibility semantics. Use AppLogger for all logging. Avoid StatefulWidget for business logic. Always use repository, never direct DB access. Required: single quotes, trailing commas, explicit types (no implicit-casts/dynamic).","created_at":"2026-02-22T23:57:02.811Z","tags":"flutter architecture riverpod repository pattern"}
{"id":"mem-2c4b599523cbe489","information":"WHEN: Fixing duplicate provider definitions in Flutter Riverpod apps\nWHAT: Provider definitions should live in the repository file (not in multiple provider files) following clean architecture. Use `export` statements in provider files to re-export the provider for convenience.\nWHY: Multiple definitions of the same provider name cause provider resolution conflicts. The repository file is the canonical location since it defines the type being provided.\nPATTERN:\n1. Define provider in repository file: `final myRepositoryProvider = Provider<MyRepository>((ref) => MyRepository());`\n2. Re-export in provider files that need it: `export '../repositories/my_repository.dart' show myRepositoryProvider;`\n3. Remove duplicate definitions from provider files","created_at":"2026-02-20T05:18:09.832Z","tags":"flutter,riverpod,provider,duplicate,clean-architecture"}
{"id":"mem-2e2c580f044cd4aa","information":"TODO.md implementation checklist best practice: Include phase-based structure with checkboxes, detailed subtasks for each component, progress summary table, and future enhancements section. Use `[ ]` for incomplete items and `[x]` for complete items.","created_at":"2026-02-20T20:27:39.885Z","tags":"todo,checklist,implementation,typescript,bun"}
{"id":"mem-2f06ae7d2ebd67d8","information":"Flutter model files with no external package imports copy cleanly between apps in a monorepo. The reading_plan.dart model was pure Dart (no external imports), so it required no import path changes when copying from sancta_via_bible_reading_app to sancta_via_unified. When the file has only dart:core types (String, int, DateTime, List), no modifications are needed for monorepo package path adjustments.","created_at":"2026-02-26T09:58:09.110Z","tags":"flutter,monorepo,dart-models,copy-pattern"}
{"id":"mem-2f94af0e225d064e","information":"Added system-wide download interval configuration to docs/DOCKER_SETUP.md. This includes:\n- New section 3.2.1 \"System-Wide Download Interval\" with default \"0 */2 * * *\" (every 2 hours)\n- Configuration via environment variable: YALLARHORN__SCHEDULER__DOWNLOADINTERVAL\n- Configuration via appsettings.json: Scheduler:DownloadInterval\n- Code examples showing how the scheduler uses this single interval for all feeds\n- Updated docker-compose examples to include scheduler configuration\n- Fixed section numbering for 5.4-5.9 after adding scheduler section","created_at":"2026-02-24T03:10:37.433Z","tags":"docker,scheduler,configuration,download-interval"}
{"id":"mem-30f858b72ec935e3","information":"Fixed null dereference in AAXCtoM4BConvertor.cs AddMetadataToM4A method (lines 344-366). The issue was using `aaxInfo?.format.tags.title` which only guards aaxInfo but accesses .tags without null-conditional. The pattern `aaxInfo?.format.tags.title` causes NullReferenceException if format or tags is null. Fixed by extracting title to local variable with full null-conditional chain: `var title = aaxInfo?.format?.tags?.title;` then checking `if (title is not null)` before using in regex operations. This matches the pattern in AAXtoM4BConvertor.cs.","created_at":"2026-02-22T02:43:18.877Z","tags":"null-dereference,taglib,metadata,aaxc,bugfix"}
{"id":"mem-32f72a56f5b6b3f3","information":"When using both System.Text.Json and Newtonsoft.Json in the same file, use type alias `using STJ = System.Text.Json;` to avoid ambiguous JsonSerializer reference errors. This pattern allows clear disambiguation: `STJ.JsonSerializer.Deserialize<T>()` for System.Text.Json and `Newtonsoft.Json.JsonConvert.DeserializeObject<T>()` for Newtonsoft.Json.","created_at":"2026-02-22T05:04:17.457Z","tags":"dotnet,json,serialization,testing,ambigous-reference"}
{"id":"mem-34dfdf6792cfc97b","information":"ChapterConverter testing patterns in Harmony: The class is internal but testable via InternalsVisibleTo. Create temp directories with Guid for isolation. Use StringBuilder/JsonSerializer to create test chapter files. Test both Audible chapters JSON path and AaxInfo fallback path. Key edge cases: null chapters, empty chapters, nested chapters (flattening), special characters, Unicode, time calculations (ms conversion, end time = duration - 1).","created_at":"2026-02-22T04:27:11.464Z","tags":"testing xUnit FluentAssertions ChapterConverter Harmony"}
{"id":"mem-34e2733c1c6d95f2","information":".NET 9 upgrade package versions: Spectre.Console 0.50.0, NUnit 4.3.2, NUnit3TestAdapter 5.0.0, NUnit.Analyzers 4.6.0, coverlet.collector 6.0.2, AwesomeAssertions 8.0.2, NSubstitute 5.3.0, Microsoft.NET.Test.Sdk 17.13.0, Microsoft.Extensions.Configuration.* 9.0.2, System.Text.Json 9.0.2, JsonSchema.Net 7.3.4. Spectre.Console 0.49.2 does not exist - use 0.50.0 instead.","created_at":"2026-02-19T21:50:22.163Z","tags":"dotnet,nuget,upgrade,net9.0"}
{"id":"mem-35226c83e4791917","information":"FFmpeg command building patterns for C#:\n1. Path escaping: Single-quote wrap paths and escape internal single quotes with '\\'' for concat demuxer\n2. Filter graph paths need double-escape for backslashes and colons (\\ -> \\\\, : -> \\:)\n3. Concat demuxer uses file list format: \"file '/path/to/file'\" per line\n4. Loudness normalization uses loudnorm filter with I (integrated), TP (true peak), LRA (loudness range)\n5. Crossfade chain: for N inputs, chain acrossfade filters: [0:a][1:a]acrossfade...[a0];[a0][2:a]acrossfade...\n6. Two-pass normalization: measure with print_format=json, then apply with measured_I, measured_TP, measured_LRA, measured_thresh, offset\n7. M4B chapter format: FFmetadata with [CHAPTER] blocks, TIMEBASE=1/1000, START/END in milliseconds","created_at":"2026-02-21T07:34:18.860Z","tags":"ffmpeg audio c# stitching loudnorm crossfade m4b audiobook"}
{"id":"mem-35aec5fe80a714ca","information":"Centralized concurrency pattern in .NET: Create IConcurrencyManager interface with named SemaphoreSlim properties (DownloadSemaphore, SyncSemaphore). Register as singleton in DI. This consolidates throttling logic that was previously duplicated across services (DownloadService, VideoDownloadBackgroundService both had their own SemaphoreSlim with same config key). Benefits: consistent throttling, single source of truth, easier debugging, centralized configuration.","created_at":"2026-02-17T22:58:26.829Z","tags":"dotnet,concurrency,semaphore,di,singleton,throttling"}
{"id":"mem-38023619dd0c2d9f","information":"Architecture documentation best practice: Include ASCII diagrams for data flow visualization when Mermaid/draw.io isn't available in the target system. Multi-stage Docker builds reduce image size for Bun applications by ~50%. Romcal calendar loading pattern: use a record mapping diocese keys to imported calendar modules, with type guards for validation.","created_at":"2026-02-20T20:25:13.061Z","tags":"architecture,docker,romcal,bun,documentation"}
{"id":"mem-383615e8f3729f2f","information":"Fixed audio service foreground service configuration for Android. Key changes:\n1. Added androidNotificationOngoing: true to AudioServiceConfig to keep notification visible\n2. Added WAKE_LOCK and REQUEST_IGNORE_BATTERY_OPTIMIZATIONS permissions to AndroidManifest\n3. Added turnScreenOn and showWhenLocked attributes to both MainActivity and AudioService in AndroidManifest\n4. Kept audio handler initialization in video_player_provider clean - it properly initializes on first video load and uses the audio handler when available","created_at":"2026-02-23T06:12:08.719Z","tags":"android,audio-service,foreground-service,media-playback"}
{"id":"mem-384ca73090336645","information":"Fixed test method name typo \"Disccovered\" → \"Discovered\" in VideoServiceTests.cs. Simple rename refactor, all tests pass after fix.","created_at":"2026-02-18T02:40:52.328Z","tags":"test,typo,rename,refactor"}
{"id":"mem-38eed238e450d9e8","information":"When modifying JSON manuscript files like domo.json to add intro chapters/scenes: (1) Add new chapter object at START of Chapters array with Id like \"chapter_000\", (2) Add new scene object at START of Scenes array with matching Id, (3) Use Narration for attribution text, SceneBreak: false, PauseAfterSeconds for pause duration. Maintains ID linking between chapter Scenes array and scene objects.","created_at":"2026-02-26T03:10:11.145Z","tags":"domo.json manuscript json intro chapter scene attribution skaldforge"}
{"id":"mem-39edf4f568ddcd77","information":"LITURGICAL COLORING AUDIT FINDINGS:\n1. CRITICAL: `sancta_via_liturgical_calendar_riverpod/lib/src/providers/ui_providers.dart` lines 133-150 has `_getLiturgicalColor()` that ignores colorIntensity setting\n2. CRITICAL: `sancta_via_novena_companion/lib/providers/liturgical_calendar_provider.dart` lines 4-11 has duplicate `LiturgicalColor` enum - should import from `sancta_via_liturgical_calendar`\n3. CRITICAL: Color value inconsistency between riverpod ui_providers (uses Material Colors) vs shared_ui (uses explicit hex values)\n4. MINOR: `sancta_via_confession_companion/lib/main.dart` uses different pattern (currentLiturgicalDayProvider) vs other apps (currentLiturgicalColorProvider)\n5. MINOR: `sancta_via_liturgical_calendar_app/lib/screens/day_detail/day_detail_screen.dart` line 167 uses hardcoded amber instead of liturgical gold","created_at":"2026-02-24T09:54:17.655Z","tags":"liturgical,coloring,audit,theming,riverpod,inconsistency"}
{"id":"mem-3a1d60b80446ccf9","information":"ToLower() should be replaced with ToLowerInvariant() for culture-agnostic lowercase string operations in .NET. This prevents the Turkish I problem and ensures consistent behavior across locales. Important: Do NOT change ToLower() calls in LINQ-to-Entities queries or EF.Functions - those need database-side translation and cannot use ToLowerInvariant().","created_at":"2026-02-18T02:43:49.523Z","tags":".NET,culture,invariant,ToLower,ToLowerInvariant,Turkish I problem"}
{"id":"mem-3a4aa7bbaf22f25a","information":"In sancta_via_unified app, Prayer and Calendar features are FULLY IMPLEMENTED in features/prayer/ and features/calendar/ but NOT wired up in routes.dart. The routes.dart file uses PlaceholderScreen for both (lines 127-129 for Prayer, lines 221-223 for Calendar) instead of the actual PrayerListScreen and CalendarScreen. To wire them up, import the feature exports (prayer.dart, calendar.dart) and replace the PlaceholderScreen widgets with the real screens. Tab labels are defined in TabConfig class at lines 54-91 - Confession label needs to change to 'Examin'.","created_at":"2026-02-26T09:13:40.343Z","tags":"sancta_via,flutter,routes,feature-wiring,navigation"}
{"id":"mem-3c08804d214c270c","information":"Updated youtube-dl integration design in docs/YTDLP_INTEGRATION.md to add video transcoding capabilities:\n\n1. Added Section 3.5 \"Video Transcoding with FFmpeg\" covering:\n   - FFmpeg integration architecture (TranscodingService class)\n   - Quality settings: low (1000kbps/128kbps/480p), medium (2500kbps/128kbps/720p), high (5000kbps/192kbps/1080p), 4k (15000kbps/256kbps/1440p), best (20000kbps/320kbps/original)\n   - Codec options: H.264 (libx264), H.265 (libx265), VP9, AV1, copy for video; AAC, MP3, Opus, Vorbis, copy for audio\n   - Batch transcoding with BatchTranscoder class\n   - Error handling for failed transcodes with TranscodeErrorClassifier (7 error categories: FFmpegNotFound, InvalidInput, OutputError, DiskSpaceError, EncodingError, CodecError, ProcessError, Unknown)\n   - Integration with download pipeline\n\n2. Referenced transcoding_configs table from DATA_MODEL.md for per-feed transcoding configuration\n\n3. Updated version history to 1.1.0","created_at":"2026-02-24T02:54:11.281Z","tags":"youtube-dl,ffmpeg,video-transcoding,mp4,design"}
{"id":"mem-3e539510749d1df0","information":"Skaldforge test patterns: Use NUnit + FluentAssertions (AwesomeAssertions). Tests follow Arrange-Act-Assert pattern with [TestFixture] and [Test] attributes. Group related tests with #region blocks. Test both required properties and all properties. Test lookup methods (GetScene, GetCharacter, GetChapter) for found/not-found cases. Test hierarchy relationships between Manuscript-Chapters-Scenes-Characters-Dialogue. Use collection assertions like Should().HaveCount(), Should().Contain().","created_at":"2026-02-19T22:55:27.127Z","tags":"testing,nunit,fluent-assertions,dotnet,patterns"}
{"id":"mem-3f088786d7287a6d","information":"Created PlaylistsController with 7 endpoints: GET /api/v1/playlists, GET /api/v1/playlists/{id}, POST /api/v1/playlists, PUT /api/v1/playlists/{id}, DELETE /api/v1/playlists/{id}, POST /api/v1/playlists/{id}/items, DELETE /api/v1/playlists/{id}/items/{itemId}. Follows controller patterns with [ApiController], [EnableRateLimiting], XML docs, ProducesResponseType attributes, and proper error handling. Includes UpdatePlaylistRequest DTO inline in controller file.","created_at":"2026-02-23T09:22:40.894Z","tags":"[\"controller\",\"playlist\",\"api\",\"odeon\"]"}
{"id":"mem-3f215d07643cd937","information":"## AppLogger Import Conflict Resolution Pattern\n\n**Problem:** When an app imports both `sancta_via_shared_ui` (which exports `AppLogger`) AND a local `utils/logger.dart` (which also defines `AppLogger`), Dart reports an ambiguous import error.\n\n**Solution:** Add `hide AppLogger` to the shared_ui import in files that need both:\n```dart\nimport 'package:sancta_via_shared_ui/sancta_via_shared_ui.dart' hide AppLogger;\nimport '../utils/logger.dart';\n```\n\n**Alternative:** If the local logger is the only one needed, use a prefix on the local import:\n```dart\nimport 'package:sancta_via_shared_ui/sancta_via_shared_ui.dart';\nimport '../../utils/logger.dart' as app_logger;\n// Use: app_logger.AppLogger.debug('message');\n```\n\n**Files commonly affected:**\n- `lib/main.dart` (imports both packages)\n- Provider files that use both shared_ui themes and local logging\n- Settings providers\n\n**API Difference:** \n- Shared UI: Instance-based (`AppLogger.bibleReading.debug()`)\n- Local: Static methods (`AppLogger.debug()`)\nThese APIs are incompatible - choose one pattern consistently per file.","created_at":"2026-02-21T05:23:46.508Z","tags":"flutter,import-conflict,AppLogger,sancta_via,shared_ui,dart"}
{"id":"mem-3f90111df0b0c2a8","information":"Three Makefiles had copy-paste bugs with incorrect APP_NAME variable. The sancta_via_prayer_companion had full package name instead of short name, while confession_companion and novena_companion both had 'bible_reading_app' from a copy-paste error. When copying Makefiles between apps, always update: APP_NAME variable, header comment, and all echo statements referencing the app name.","created_at":"2026-02-20T05:21:20.992Z","tags":"makefile,copy-paste-bug,build-config"}
{"id":"mem-3fe92e65ab60f3a2","information":"Docker setup design for Yallarhorn podcast feed generator completed. Key design decisions: (1) Base image: mcr.microsoft.com/dotnet/aspnet:10.0-bookworm-slim with multi-stage build for minimal footprint (~180MB); (2) yt-dlp installed via pip3 for media extraction; (3) Volume mounts: /data/media (episodes), /data/db (SQLite), /config, /logs; (4) Cron scheduling: dual approach with internal NCrontab + external cron daemon; (5) Environment variables follow YALLARHORN__ prefix pattern for nested config; (6) Docker-compose includes dev (hot reload) and production (security hardening, resource limits) variants; (7) Security: non-root user (yallarhorn:1000), read-only root filesystem option, network isolation.","created_at":"2026-02-24T01:47:47.218Z","tags":"docker,cron,.net10,yt-dlp,volume-mounts,configuration"}
{"id":"mem-41b1dc8dc0621784","information":"Core library desugaring fix for flutter_local_notifications on Android. The SanctaVia app uses Kotlin DSL (.kts) Gradle files. To enable desugaring: 1) Add isCoreLibraryDesugaringEnabled = true to compileOptions block in android/app/build.gradle.kts. 2) Add dependencies block with coreLibraryDesugaring(\"com.android.tools:desugar_jdk_libs:2.0.4\"). Note the Kotlin DSL syntax uses \"isCoreLibraryDesugaringEnabled\" not \"coreLibraryDesugaringEnabled true\" (Groovy syntax) and uses parentheses in dependency declaration.","created_at":"2026-02-25T22:41:30.293Z","tags":"android,flutter_local_notifications,gradle,kotlin-dsl,desugaring"}
{"id":"mem-42ab06f2b0c089bf","information":"Deleted video tracking implementation in Odeon: When users delete videos from the database, the system now tracks the YouTube Video ID and Channel ID in a DeletedVideos table. This prevents the sync process from re-importing videos the user explicitly deleted. Key implementation: 1) DeletedVideo entity with unique index on (ChannelId, VideoId), 2) VideoService.DeleteVideoAsync saves to DeletedVideos before removing the Video record, 3) VideoService.DiscoverVideosAsync filters out deleted video IDs when discovering new videos from yt-dlp.","created_at":"2026-02-20T20:44:51.754Z","tags":"odeon,ef-core,sync,deletion-tracking,video-management"}
{"id":"mem-43bf9dc223974a43","information":"Added EF Core migration on startup in Program.cs - uses ApplicationDbContext with GetPendingMigrationsAsync() to check for pending migrations, then calls MigrateAsync() if needed. Logs the migration process with Serilog. Skips migration in Testing environment.","created_at":"2026-02-23T21:59:07.854Z","tags":"ef-core,migrations,program.cs,startup"}
{"id":"mem-4588043b6930477e","information":"Kokoro-FastAPI TTS integration for Skaldforge:\n- 66 voices in 10 languages, naming: {lang}{gender}_name (e.g., af_heart = American Female)\n- Main synthesis: POST /v1/audio/speech (OpenAI-compatible)\n- Captioned synthesis: POST /dev/captioned_speech (returns word timestamps)\n- Voice listing: GET /v1/audio/voices\n- Voice blending: \"af_bella(2)+af_heart(1)\" for weighted mixing\n- No auth required, sample rate 24000Hz\n- Formats: wav, mp3, opus, flac, pcm\n- Speed/pitch via speed and volume_multiplier params","created_at":"2026-02-21T04:50:46.725Z","tags":"kokoro,tts,audio,integration,api"}
{"id":"mem-45d2db312df87f7e","information":"RefreshWorker IHostedService pattern for periodic background tasks: Use Timer for periodic execution, track in-flight tasks with Task field under lock, use CancellationTokenSource for graceful shutdown, make StartAsync/StopAsync idempotent with boolean flags. Always perform initial refresh on startup before starting timer.","created_at":"2026-02-25T08:56:01.391Z","tags":"csharp,IHostedService,background-worker,timer,refresh"}
{"id":"mem-463ed008babd035c","information":"Chatterbox TTS client pattern: Created HTTP client for Chatterbox TTS API with WAV header parsing for duration detection. Key design: Use _ownsHttpClient flag to control disposal when HttpClient is provided externally (DI scenario). WAV parsing walks through chunks to find fmt and data chunks for accurate duration calculation.","created_at":"2026-02-22T21:51:11.203Z","tags":"TTS,HTTP-client,C#,WAV-parsing,dependency-injection"}
{"id":"mem-4666b9ec411e0d85","information":"DownloadPipeline orchestrator pattern: Use ExecuteAsync with cancellation token support, wrap download/transcode stages in try-catch blocks for proper error handling, update episode status through stages (Pending→Downloading→Processing→Completed), throw OperationCanceledException for cancellation to propagate properly, cleanup temp files even on failure. Use IDownloadCoordinator.ExecuteDownloadAsync<T> with Func<CancellationToken, Task<T>> for proper concurrency control.","created_at":"2026-02-25T08:42:22.784Z","tags":"C# async pipeline cancellation error-handling orchestrator"}
{"id":"mem-466b7b2ac85ced79","information":"Skaldforge is a .NET 8 audiobook generation system using Kokoro TTS and Ollama AI. The codebase follows DDD with hexagonal architecture. Core library (Skaldforge.Core) is scaffolded with 13 domain models, 6 interfaces (ITtsEngine, IVoiceMapper, IStoryParser, IManuscriptRepository, IAudioStitcher, ICharacterAnalyzer), 8 config classes. Implementation libraries (Skaldforge.Tts, Skaldforge.Audio, Skaldforge.Ai, Skaldforge.Cli, Skaldforge.Tests) are empty placeholders. When implementing, start with Skaldforge.Core interfaces and work outward. Models are well-documented with XML comments.","created_at":"2026-02-19T18:32:10.254Z","tags":"skaldforge,dotnet,architecture,ddd,hexagonal,audiobook,tts"}
{"id":"mem-46ceec5d8990ac45","information":"Skaldforge Integration - ChatterBox TTS Docker API + TangoFlux SFX:\n\n**Services Running:**\n1. ChatterBox TTS Docker API - http://jason.lan:4123 (travisvn/chatterbox-tts-api with blackwell support)\n2. ComfyUI with TangoFlux - http://jason.lan:8188 (CUDA 12.8 for RTX 5060 Ti)\n\n**New Components Created:**\n- `src/Skaldforge.Core/Interfaces/ISfxGenerator.cs` - Interface for SFX generation\n- `src/Skaldforge.Sfx/TangoFluxSfxGenerator.cs` - TangoFlux-based SFX generator via ComfyUI\n- `src/Skaldforge.IntegrationRunner/Program.cs` - Test runner for all integrations\n\n**Updated:**\n- `src/Skaldforge.Tts/Chatterbox/ChatterboxClient.cs` - Changed DefaultBaseUrl to http://jason.lan:4123\n\n**Key Insights:**\n- ChatterBox TTS in TTS-Audio-Suite ComfyUI node had numba/librosa incompatibility with RTX 5060 Ti\n- Solution: Run ChatterBox as standalone Docker API via travisvn/chatterbox-tts-api\n- TangoFlux for SFX and music works fine in ComfyUI with CUDA 12.8\n- AudioPipeline.cs already supports IMusicGenerator and IAudioStitcher for background music with ducking\n\n**TTS API Endpoints (ChatterBox Docker):**\n- POST /v1/audio/speech - Basic TTS with JSON body {input, exaggeration, cfg_weight, temperature}\n- POST /v1/audio/speech/upload - TTS with voice file upload\n- GET /health - Health check\n\n**TangoFlux Workflow JSON structure stored in workflows/ directory for SFX and music generation.","created_at":"2026-02-26T00:48:06.839Z","tags":"skaldforge,integration,chatterbox,tangoflux,docker,rtx-5060,cuda-128"}
{"id":"mem-48704ee078974b5a","information":"SANCTAVIA unified app scaffold created at apps/sancta_via with complete pubspec.yaml. Dependencies consolidated from 5 apps: flutter_riverpod ^2.6.1, go_router ^15.1.2, and all 6 local packages. Note: bible_data and bible_data_riverpod have SHORT names (not sancta_via_bible_data) - use correct path references when depending on them. Directory structure uses features/ subfolders (bible, calendar, confession, novena, prayer) plus config, models, repositories, services, utils.","created_at":"2026-02-25T05:44:26.512Z","tags":"flutter,monorepo,scaffold,sanctavia,pubspec,dependencies"}
{"id":"mem-490431ad37225107","information":".NET Modernization Audit Pattern: When auditing C# files for .NET 10 modernization, safe auto-fixes include: (1) String interpolation replacing concatenation, (2) Pattern matching `is null`/`is not null` replacing `== null`/`!= null`, (3) Lowercase `string.Empty` per conventions, (4) Removing double semicolons, (5) Removing redundant newlines in WriteLine calls. High-priority manual review items: (1) Async/await patterns - `.Wait()` calls should be converted to `await`, (2) Null reference warnings CS8602/CS8604 from nullable reference types, (3) `.Result` on Task should use `await` instead.","created_at":"2026-02-21T22:47:30.427Z","tags":".net csharp modernization async csharp-audit"}
{"id":"mem-4c42b0bd9c8cb995","information":"FFmpegStitcher can accept FFmpegWrapper via constructor injection for DI scenarios. When doing so, added _ownsFFmpeg flag (default true) to control whether Dispose should also dispose the wrapper (false when injected). This pattern prevents premature disposal of shared resources.","created_at":"2026-02-21T10:05:56.342Z","tags":"dotnet,di,ffmpeg,dispose-pattern,skaldforge"}
{"id":"mem-4c6c3e4e72eeffa2","information":"GoRouter date parsing error handling pattern: Use a top-level `redirect` callback to validate path parameters before route matching. Parse path segments with `state.uri.pathSegments` and use try-catch to handle invalid formats. Return redirect path ('/') on error, null otherwise. Also use `DateTime.tryParse()` as a defensive fallback in builder for defense-in-depth.","created_at":"2026-02-23T00:35:28.919Z","tags":"flutter,gorouter,error-handling,date-parsing,validation"}
{"id":"mem-4cac91f6fe140dbd","information":"Boolean logic bug pattern: Using || with \"not equals\" conditions creates a tautology that's always true. The pattern `if (x != A || x != B)` is ALWAYS true (every x is either not-A or not-B). Correct pattern is `if (x != A && x != B)` to check that x is neither A nor B. Found in prayer_detail_screen.dart where title visibility logic was broken.","created_at":"2026-02-20T05:13:44.247Z","tags":"boolean-logic,bug-pattern,dart,flutter"}
{"id":"mem-4cf77d417c664d7b","information":"CharacterParser pattern for LLM JSON parsing:\n- Use JsonDocument for parsing (not JsonSerializer) to handle malformed JSON gracefully\n- Extract JSON from markdown code blocks using regex: `@\"```(?:json)?\\s*\\n?(.*?)\\n?\\`\\`\\`\"`\n- Handle both wrapped {\"characters\": [...]} and direct [...] arrays\n- Use TryGetString with null checks to safely get string values from JsonElement\n- ParseEnum helper normalizes values (strips spaces, hyphens, underscores) before TryParse\n- Required fields (id, name) should be validated first; skip entire character if missing\n- Return tuple (List<Character>, List<string> Errors) to report partial success with errors","created_at":"2026-02-20T00:36:06.939Z","tags":"csharp,json-parsing,llm-response,enum-parsing,markdown-extraction"}
{"id":"mem-4d4112071c0ea7f1","information":"Yallarhorn YouTube Channel Workflow: \n1. Add channels via YAML config (ChannelSeeder) or REST API (ChannelsController)\n2. RefreshWorker discovers new episodes hourly via ChannelRefreshService using yt-dlp --flat-playlist\n3. Episodes are queued in DownloadQueueService with status Pending\n4. DownloadWorker processes queue, using DownloadPipeline (yt-dlp download → ffmpeg transcode)\n5. FeedType determines output: Audio (MP3), Video (MP4), or Both\n6. Exponential backoff for retries: 0, 5min, 30min, 2hr, 8hr (max 5 attempts)\n7. Manual refresh via POST /api/v1/channels/{id}/refresh or /api/v1/refresh-all","created_at":"2026-02-27T10:41:16.394Z","tags":"yallarhorn,youtube,workflow,architecture,download-pipeline,channels"}
{"id":"mem-4e5199483367e305","information":"Catholic Bible OT/NT split: Old Testament has 46 books (orders 1-46), New Testament has 27 books (orders 47-73). The centralized helper functions `BibleBookMapping.isOldTestamentByOrder(int)` and `BibleBookMapping.isOldTestamentByIndex(int)` should be used instead of inline comparisons like `bookOrder <= 46` or `i < 46`. Deuterocanonical books (Tobit, Judith, 1-2 Maccabees, Wisdom, Sirach, Baruch) are orders 40-46 and are part of the Old Testament in Catholic canon.","created_at":"2026-02-20T05:04:26.228Z","tags":"bible,old-testament,new-testament,catholic,book-order,deuterocanonical"}
{"id":"mem-4ecabd14cd086fb4","information":"DELETE API endpoints with cascade operations should return a wrapper object with 'message' and 'deleted' fields per API spec. Example: Ok(new { message = \"Channel deleted successfully\", deleted = result }). This matches the Yallarhorn API specification pattern for delete operations.","created_at":"2026-02-25T23:52:08.835Z","tags":"API,pattern,DELETE,response-format,Yallarhorn"}
{"id":"mem-4eefa6c095fcce8e","information":"Flutter Riverpod Refactoring Pattern: Converting mutable StateNotifier to immutable state + Provider-based service.\n\nPROBLEM: StateNotifier<ApiClient> with mutable _baseUrl/_apiKey fields - Riverpod cannot detect state changes because object reference stays the same.\n\nSOLUTION (Approach 3 from advisory report):\n1. Create immutable state class (ApiConfig with final fields, copyWith, equality)\n2. Refactor service (ApiClient) to accept immutable state in constructor\n3. Create StateNotifierProvider for state (ApiConfigNotifier managing ApiConfig)\n4. Create Provider for service (watches state, creates service on state change)\n5. Update all dependent providers to import new provider file\n\nKEY FILES:\n- lib/models/api_config.dart (immutable state)\n- lib/services/api_client.dart (accepts config)\n- lib/providers/api_config_provider.dart (all providers)\n- lib/providers/auth_provider.dart (uses new providers)\n\nGOTCHA: Test files need updating - old constructor calls must use new config parameter.","created_at":"2026-02-17T04:26:25.423Z","tags":"Flutter,Riverpod,StateNotifier,immutable state,refactoring"}
{"id":"mem-4fefde73908f4294","information":"Android Auto support with audio_service and media_kit: media_kit doesn't natively support Android Auto. Use audio_service package as a wrapper. Key implementation: 1) Create AudioHandler that bridges media_kit Player to audio_service's MediaBrowserServiceCompat, 2) Use androidStopForegroundOnPause: false in AudioServiceConfig for Android 12+ (cannot combine with androidNotificationOngoing: true - causes assertion error), 3) AndroidManifest needs FOREGROUND_SERVICE_MEDIA_PLAYBACK permission and service declaration with android.media.browse.MediaBrowserService intent filter, 4) Video won't display on Android Auto (headless only - audio playback only).","created_at":"2026-02-22T01:20:36.436Z","tags":"flutter,android-auto,audio_service,media_kit,mobile"}
{"id":"mem-50aef1832a55276b","information":"Odeon Backend Code Quality Review Findings: 1) PagedResult uses object instead of generic T, causing dynamic casting in tests - should be refactored to PagedResult<T>. 2) VideosController.cs contains multiple classes (PagedVideosResponse, DownloadResponse) violating one-class-per-file rule. 3) EF navigation properties use null-forgiving operator (null!) - consider nullable pattern instead. 4) Case-insensitive search uses ToLower() - prefer ToLowerInvariant() or EF.Functions.Like. 5) Test naming follows Method_Scenario_ExpectedResult pattern correctly. 6) FluentAssertions and Moq patterns are correctly implemented. 7) Structured logging uses property names correctly. 8) Exception handling uses specific types and preserves stack trace properly.","created_at":"2026-02-17T03:10:51.695Z","tags":"odeon,csharp,code-review,conventions,testing,fluentassertions,moq,nullable-reference-types"}
{"id":"mem-52f25e05f2a9aeb5","information":"Fixed CS0104 ambiguous reference error in ComfyUiMusicGeneratorAdapter.cs. Root cause: file imported both Skaldforge.Core.Interfaces and Skaldforge.Music namespaces, both containing MusicGenerationRequest and MusicGenerationResult classes. Solution: use explicit namespace qualification (Core.Interfaces.MusicGenerationRequest) to disambiguate. This is a common C# issue when two namespaces contain types with the same name.","created_at":"2026-02-23T03:22:36.187Z","tags":"csharp,build-error,namespace-ambiguity,disambiguation"}
{"id":"mem-540db4dab265ef33","information":"ChatterBox TTS numba/librosa incompatibility issue:\n\nError: `numba.core.errors.TypingError: No implementation of function Function(<built-in function empty>) found for signature`\n\nDependency chain: ChatterBox → perth → librosa → numba\n\nCurrent fix attempts that FAILED:\n- pip install --upgrade numba librosa\n- pip install numba==0.60.0 librosa==0.10.2\n- pip install numba==0.58.1 librosa==0.10.1\n\nRoot cause: perth (audio watermarking library) pulls in librosa which uses numba JIT compilation that's incompatible with current numba version in the venv.\n\nAlternative TTS engines that work:\n- F5-TTS (F5TTSEngineNode) - has speed control, no perth dependency\n- IndexTTS-2 (IndexTTSEngineNode) - has emotion control, may have different deps\n\nWhen ChatterBox was working before, it was in CPU mode on a different Python environment setup.","created_at":"2026-02-25T22:55:28.328Z","tags":"chatterbox,comfyui,numba,librosa,error"}
{"id":"mem-544c9e072bf2a2aa","information":"WHY: Code review flagged \"synchronous SaveChanges in VideoService\" but the code was already fixed.\n\nLEARNING: Always verify the actual code state before making changes. VideoService.cs already uses SaveChangesAsync() everywhere (lines 123, 261, 289, 367, 414). The test file (VideoServiceTests.cs) has 34 synchronous SaveChanges() in setup methods, which is acceptable in test setup but could be improved.","created_at":"2026-02-17T22:04:07.648Z","tags":"SaveChanges,async,VideoService,EF Core,false-positive"}
{"id":"mem-5467b9fb90e15765","information":"SoundFlow audio library integration learnings:\n1. SoundFlow uses AudioEngine (MiniAudioEngine is the default implementation) as the main entry point\n2. Key types: AudioEngine, AudioFormat, SampleFormat, ChannelLayout, ISoundDataProvider, StreamDataProvider, RawDataProvider\n3. SoundFlow.Structs.AudioFormat conflicts with Skaldforge.Core.Models.AudioFormat - use type alias\n4. SoundFlow.Interfaces namespace contains ISoundDataProvider, ISoundDecoder, ISoundEncoder\n5. SoundFlow does NOT have LUFS normalization - delegate to FFmpeg for that\n6. SoundFlow WAV encoding uses engine.CreateEncoder(stream, \"wav\", audioFormat)\n7. RawDataProvider takes (float[] samples, int sampleRate) for creating silence or generated audio\n8. StreamDataProvider takes (AudioEngine engine, AudioFormat format, Stream stream) for loading audio files\n9. SoundFlow.Backends.MiniAudio contains MiniAudioEngine which is the cross-platform backend\n10. SoundFlow.Providers namespace has RawDataProvider, StreamDataProvider for data sources","created_at":"2026-02-22T00:24:41.228Z","tags":"soundflow,audio,stitching,implementation,dotnet"}
{"id":"mem-548d7b8d22824b1a","information":"Yallarhorn DownloadWorker pattern: IHostedService with continuous processing loop that polls queue with configurable interval (default 5s). Key implementation details:\n- Use CancellationTokenSource for graceful shutdown\n- Processing loop: GetNextPendingAsync → MarkInProgressAsync → ExecuteAsync → MarkCompleted/MarkFailed\n- Check GetRetryableAsync first for exponential backoff retries\n- Idempotent StartAsync/StopAsync using boolean flags with lock\n- Store processing loop Task to await during shutdown\n- MarkFailedAsync with CancellationToken.None to ensure failure is recorded even during cancellation\n- Error isolation: catch exceptions in loop, log, delay briefly, continue","created_at":"2026-02-25T09:45:49.560Z","tags":"IHostedService,background worker,download queue,C#,graceful shutdown"}
{"id":"mem-54b3d2a596870a78","information":"Created OllamaClient HTTP wrapper with pattern: inject HttpClient and AiConfig via constructor. Configure BaseAddress and Timeout from AiConfig. Use snake_case_lower JsonNamingPolicy for Ollama API. OllamaRequest/Response models for /api/generate. OllamaChatRequest/Response with OllamaMessage for /api/chat. OllamaException includes HttpStatusCode for error handling.","created_at":"2026-02-20T00:28:14.365Z","tags":"ollama,httpclient,api-wrapper,pattern"}
{"id":"mem-551799e8b32d306c","information":"tempus-bede is a liturgical calendar API using romcal with Bun runtime and Hono framework. Supports 6 dioceses (united-states, england, italy, france, spain, germany). REST endpoints: GET / (API info), GET /today, GET /date/:date, GET /health. Uses calendar caching for performance. Multi-stage Dockerfile with health check. TypeScript with strict typing for LiturgicalDayResponse and ErrorResponse interfaces.","created_at":"2026-02-20T20:53:48.115Z","tags":"tempus-bede,romcal,liturgical-calendar,bun,hono,api,documentation"}
{"id":"mem-57240b220115738b","information":"SQLite schema design for podcast downloader: Use TEXT for IDs (UUID), ISO 8601 timestamps, WAL mode for concurrency, partial indexes for filtered queries. Key tables: channels (YouTube sources), episodes (downloaded content), download_queue (retry with exponential backoff). Rolling window implemented via LIMIT on episode_count_config. Deduplication via unique video_id. CHECK constraints for enum-like fields (status, feed_type).","created_at":"2026-02-24T08:37:20.073Z","tags":"sqlite,schema-design,podcast,data-model"}
{"id":"mem-57a22f46bfc3cfd7","information":"WHY: Created shared_ui/UnifiedSettingsScreen pattern for settings - it provides reusable theme, color intensity, accessibility, and notifications components with automatic SharedPreferences persistence. \n\nWHAT: SettingsScreen uses UnifiedSettingsScreen from sancta_via_shared_ui with:\n- themeModeProvider and colorIntensityProvider for theme persistence\n- baseSettingsProvider for accessibility/language settings\n- AppInfo for app metadata\n- appSpecificSettings slot for feature navigation links\n\nPATTERN: All Sancta Via apps should use UnifiedSettingsScreen as base, passing app-specific settings via the appSpecificSettings parameter.","created_at":"2026-02-25T20:13:06.565Z","tags":"flutter,riverpod,settings,shared_ui,SharedPreferences"}
{"id":"mem-58a106492c45f307","information":"ASP.NET Core API pagination pattern: Use PaginationQuery model with Page (int, default 1), Limit (int, default 50, max 100), Sort (optional), Order (\"asc\"/\"desc\"). Implement setters to normalize values. PaginatedResponse<T> should include Data list, Page, Limit, TotalCount, TotalPages, HasNext, HasPrevious computed properties, and HATEOAS Links dictionary with self/first/last/next/prev keys. Use factory method Create() to generate pagination links from basePath.","created_at":"2026-02-25T22:21:22.786Z","tags":"aspnetcore,api,pagination,hateoas,rest"}
{"id":"mem-59b8ffe5a6a83d9c","information":"Created PlaylistCard widget at frontend/lib/widgets/playlist_card.dart. Uses Card with InkWell for tap handling, displays thumbnail of first video using CachedNetworkImage, shows playlist name, item count, and optional description. Follows existing VideoCard and ChannelCard patterns - uses AspectRatio 16:9 for thumbnail, proper theming with Theme.of(context), and placeholder for empty thumbnails.","created_at":"2026-02-23T20:01:13.161Z","tags":"[\"flutter\",\"widget\",\"playlist\",\"frontend\"]"}
{"id":"mem-5a07cb8f9bf45a91","information":"Flutter stream subscriptions returned from `.listen()` must be stored in instance variables and cancelled in dispose() to prevent memory leaks. Always track StreamSubscription<T>? references and call .cancel() before setting to null. The pattern: `_subscription = stream.listen(callback)` then `await _subscription?.cancel(); _subscription = null;` in dispose. This prevents events firing after widget disposal and avoids memory leaks.","created_at":"2026-02-17T22:15:38.418Z","tags":"flutter,dart,stream,dispose,memory-leak,riverpod,statenotifier"}
{"id":"mem-5a2b6e1c682e0748","information":"Yallarhorn test fixes: \n1. ConfigValidateCommandTests/ConfigLintCommandTests: YAML config files must use snake_case (poll_interval, max_concurrent_downloads, download_dir, etc.) because the deserializer uses UnderscoredNamingConvention.\n2. CommandLineHandler: Parse() returns null only when BOTH no command AND no configPath specified - allowing --config flag to return options.\n3. Test parallel execution: Tests that capture Console.Out need [Collection(\"ConsoleOutput\")] with DisableParallelization = true to prevent pollution.\n4. YouTube URL validation: Channels must have youtube.com URLs, not generic URLs. Valid patterns: @channelname, /c/, /channel/, /user/","created_at":"2026-02-27T04:46:02.525Z","tags":"yallarhorn,tests,yaml,naming-convention,console-output,parallel-tests"}
{"id":"mem-5ab8a48c952e634c","information":"Created .dockerignore for Yallarhorn Docker build optimization. Excluded: version control (.git/, .gitignore), build artifacts (bin/, obj/), IDE configs (.vs/, .idea/), documentation (docs/), tests (tests/), environment files (.env, appsettings.*.json), OS files (.DS_Store), Docker self-reference (Dockerfile, docker-compose*.yml), and CI/CD configs. This prevents large unnecessary files from being included in Docker build context, improving build speed and reducing image size.","created_at":"2026-02-26T09:13:31.982Z","tags":"docker,dockerignore,build-optimization"}
{"id":"mem-5b6bb5a259030b6c","information":"DomoGenerator Program.cs build fixes: When using Skaldforge.Music types (MusicMood, MusicGenerationRequest), they are defined in Skaldforge.Core.Interfaces, not Skaldforge.Music namespace. The Skaldforge.Music namespace contains ComfyUiMusicGenerator. To use both, import Skaldforge.Core.Interfaces (for the types) and Skaldforge.Music (for the implementation).","created_at":"2026-02-26T01:45:56.078Z","tags":"csharp,build-errors,namespaces,Skaldforge.Music"}
{"id":"mem-5cdb33fa5771d6f1","information":"ASP.NET Core API pattern for paginated endpoints: Use PaginationQuery class for query params, PagedResult<TEntity> from repository with GetPagedAsync(), then map to PaginatedResponse<TResponse> with HATEOAS links. Controllers should follow pattern: verify resource exists (404 if not), build predicate for filtering, get paged results, map entities to responses with HATEOAS links, build pagination response. Use lowercase status strings in API responses (e.g., \"completed\" not \"Completed\").","created_at":"2026-02-25T23:09:12.552Z","tags":"aspnetcore,api,pagination,tdd,yallarhorn"}
{"id":"mem-5d355809d80dade2","information":"Created generic PagedResult<T> class in Odeon.Core/DTOs/ with pagination metadata. Uses ICollection<T> for Items, calculated properties PageNumber/TotalPages/HasPreviousPage/HasNextPage. Factory methods: Empty() and Create(). File naming convention: PagedResult{T}.cs for generic types.","created_at":"2026-02-17T08:42:58.675Z","tags":"dotnet,dto,pagination,generic,odeon"}
{"id":"mem-5d596b0b79f1fd7c","information":"Debug logging for file write tracking in SoundFlowStitcher: The output path is computed as Path.Combine(_config.OutputDirectory, $\"chapter_{request.ChapterId}_{timestamp}.wav\"). Key places to log: (1) StitchChapterInternalAsync start - log config.OutputDirectory and FullPath, (2) Before WriteAudioAsync - log the computed outputPath and Directory.Exists, (3) In WriteAudioAsync - log stream.Name and File.Exists after write, (4) After StitchResult creation - log the OutputUrl and verify file exists. This helps diagnose where stitched files are being written vs expected.","created_at":"2026-02-22T03:25:31.513Z","tags":"soundflow,stitching,debug,file-write,logging"}
{"id":"mem-5ddabfc3ea6787c7","information":"Sancta Via architecture patterns documented in APP_BUILD_RULES.md: 1) Repository with nullable caching + migration awareness + AppLogger, 2) Riverpod with Provider/FutureProvider/FutureProvider.family/StateNotifierProvider types, 3) BaseSettingsModel in shared_ui with app-specific wrappers using _ref.listen() sync, 4) GoRouter with named routes + path parameters + centralized error handling, 5) currentLiturgicalColorProvider + ColorIntensity enum (vibrant/muted) + ColorScheme.fromSeed(), 6) Mockito @GenerateMocks + DI in setUp() + mirror lib/ in test/. Key code patterns extracted from prayer_repository.dart, prayer_providers.dart, prayer_app_settings_provider.dart, and theme_providers.dart.","created_at":"2026-02-24T20:01:33.934Z","tags":"flutter,riverpod,architecture,patterns,sancta-via"}
{"id":"mem-608e83478b3dea07","information":"ODEON Backend Architecture Review Findings (2026-02-17): .NET 10 Clean Architecture implementation. GOOD overall compliance. Layering: Core (domain/interfaces) → Infrastructure (services/DbContext) → Api (controllers) → BackgroundJobs. DI lifetimes: Singleton for IYtDlpService (stateless), IDownloadQueue (state); Scoped for IChannelService, IVideoService, ISyncService, IDownloadService (DbContext consumers). Issues found: 1) VideoListItemDto in Infrastructure/Services violates layer - should be in Core/DTOs, 2) VideoService.cs:160-162 sync SaveChanges() in progress callback, 3) Channel entity missing data annotations. AGENTS.md compliance: High - file-scoped namespaces, naming conventions, nullable enabled, async EF Core, constructor DI only, structured logging.","created_at":"2026-02-17T03:00:52.583Z","tags":".NET,clean-architecture,dependency-injection,architecture-review,Odeon"}
{"id":"mem-61194bce1cca2651","information":"Feed Caching Implementation (P4-006):\n- Uses IMemoryCache from Microsoft.Extensions.Caching.Memory for in-memory caching\n- Key format: \"feed:channel:{channelId}:{feedType}\" or \"feed:combined:{feedType}\"\n- GetOrCreateAsync pattern follows standard cache-aside with double-checked locking\n- Default cache duration: 5 minutes absolute, 2 minutes sliding expiration\n- InvalidateChannelAsync removes both audio and video feed types for a channel\n- Thread-safe key tracking using a lock for invalidation purposes\n- FeedGenerationResult contains XmlContent (string), Etag (string), LastModified (DateTimeOffset)\n- ETags should be SHA256 hashes of feed content for conditional request support","created_at":"2026-02-25T22:03:18.023Z","tags":"caching,IMemoryCache,feeds,performance"}
{"id":"mem-61304cac9a3cf44f","information":"CharacterAnalyzer tests use NSubstitute for mocking IOllamaClient. Key patterns: Use Arg.Any<T>() for loosely-typed mocks, Arg.Do<T>() to capture arguments for assertions. For async exceptions, use Returns(Task.FromException<T>(exception)) instead of ThrowsAsync which doesn't exist for Task<T>. CharacterParser expects {\"characters\": [...]} wrapper - direct arrays at root cause InvalidOperationException. IOllamaClient.GenerateAsync returns Task<OllamaResponse> with a Response string property containing JSON.","created_at":"2026-02-20T01:18:29.652Z","tags":"testing,NSubstitute,mocking,CharacterAnalyzer,dotnet,NUnit"}
{"id":"mem-61a4b780a9d86801","information":"Fixed calendar month view in sancta_via_liturgical_calendar_app. The issue was an extra closing parenthesis ), in the _buildCalendarGrid method that caused a bracket mismatch. The calendar already had dynamic row calculation (rowsNeeded = ((firstDayOffset + daysInMonth - 1) ~/ 7) + 1, gridItemCount = rowsNeeded * 7) but the syntax error prevented it from compiling. After removing the extra ), the file analyzes correctly and all tests pass.","created_at":"2026-02-22T23:10:59.989Z","tags":"flutter,calendar,dynamic-rows,syntax-fix"}
{"id":"mem-61d55e69c2f3b5f4","information":"AudioPipeline tests require using a custom SynchronousProgress&lt;T&gt; class instead of Progress&lt;T&gt; for unit tests. The built-in Progress&lt;T&gt; uses SynchronizationContext which may not capture callbacks properly in async unit tests, leading to flaky tests where progress reports appear empty. Creating a simple IProgress&lt;T&gt; implementation that invokes the callback synchronously solves this issue.","created_at":"2026-02-21T05:57:42.295Z","tags":"testing,c#,unit-testing,async,progress-reporting"}
{"id":"mem-6401716ef42f0190","information":"Atom 1.0 feed generation in C# uses XmlWriter with Atom namespace \"http://www.w3.org/2005/Atom\". Key elements: feed/id, feed/title, feed/subtitle, feed/link (alternate), feed/link rel=\"self\", feed/updated, feed/author/name, entry/id (yt:videoId format), entry/title, entry/link, entry/summary, entry/content type=\"html\" (CDATA), entry/published, entry/updated, entry/link rel=\"enclosure\". Timestamps must use UTC format with Z suffix (yyyy-MM-ddTHH:mm:ssZ). Enclosure uses link@rel=\"enclosure\" with href, length, type, title attributes in Atom (different from RSS which uses <enclosure url=\"\" length=\"\" type=\"\"/>).","created_at":"2026-02-25T21:43:58.578Z","tags":"atom-feed,xml,podcast,csharp,feed-generator"}
{"id":"mem-646ba0c641a71f7e","information":"## ProseConverter Orchestration Pattern\n\nWhen implementing orchestration services in Skaldforge:\n\n1. **Interface Pattern**: Define interface in `Skaldforge.Core/Interfaces` with result classes\n   - Include `Success`, `HasErrors`, `HasWarnings` boolean properties\n   - Return `ProseConversionResult` with `Manuscript?` and error/warning lists\n\n2. **Service Implementation**: Create service in `Skaldforge.Ai/Services`\n   - Inject `IOllamaClient` interface (not concrete class)\n   - Use static methods from prompt classes (e.g., `ProseAnalysisPrompt.CreateUserPrompt`)\n   - Temperature 0.3 from `RecommendedTemperature` constant for deterministic output\n   - Instantiate parser in constructor: `new ProseParser()`\n\n3. **Error Handling Layers**:\n   - Input validation (null/empty checks)\n   - OllamaException for LLM API errors\n   - HttpRequestException for network issues\n   - OperationCanceledException for cancellation\n   - General Exception catch-all\n\n4. **Statistics Pattern**: Use `Stopwatch.StartNew()` and `BuildStatistics()` helper method","created_at":"2026-02-20T03:32:31.630Z","tags":"skaldforge,orchestration,pattern,prose-converter,ollama,ai-services"}
{"id":"mem-6479dfb64a60f8be","information":"TranscodeService orchestrates audio/video transcoding based on channel FeedType enum (Audio/Video/Both). Uses IFfmpegClient interface for dependency injection. Key patterns: 1) Mock returns for methods with output parameters require ReturnsAsync with lambda to capture actual parameter values, not It.IsAny<string>() which returns null. 2) TranscodeOptions.VideoCodec maps to FFmpeg codec names (h264->libx264, h265->libx265). 3) Output paths follow pattern: downloads/{channelId}/audio/{videoId}.{format} and downloads/{channelId}/video/{videoId}.{format}","created_at":"2026-02-25T07:19:13.817Z","tags":"transcode,ffmpeg,csharp,testing,moq"}
{"id":"mem-658b4230ab1c3a07","information":"GoRouter StatefulShellRoute to Standard Nested Routes Migration Pattern:\n\nWHY: StatefulShellRoute provides tab-like navigation with preserved branch state, but for dashboard/card-based navigation, standard nested routes are simpler and more appropriate.\n\nKEY INSIGHT:\n1. Home at `/` instead of `/home` - cleaner URL structure for root dashboard\n2. Routes naturally nest by path: `/bible/reading-plan` is a child of `/bible`\n3. Static routes MUST come before dynamic parameter routes (`:bookName`) - GoRouter tests static first\n4. Theming doesn't need shell-level wrapping when using Riverpod - providers work at any level\n\nFILES THAT NEED CHANGES:\n- routes.dart - Complete rewrite from StatefulShellRoute to GoRoute\n- Any screen using `context.go('/home')` → `context.go('/')`\n- Hardcoded route strings in providers/screens need namespacing (`/reading-plan` → `/bible/reading-plan`)\n\nNAVIGATION BEHAVIOR CHANGE:\n- OLD: StatefulShellRoute preserves navigation stack per branch\n- NEW: Standard back navigation - back always returns to parent, eventually to home\n- This is DESIRED for dashboard pattern - users tap card, explore feature, press back to dashboard","created_at":"2026-02-27T10:53:17.903Z","tags":"flutter,gorouter,routing,architecture,navigation"}
{"id":"mem-66b623a70906bf82","information":"Yallarhorn test failure patterns: (1) Controller tests mocking wrong repository methods - controllers use FindAsync()/GetAllAsync() for client-side pagination, not GetPagedAsync(). (2) CLI argument parsing with System.CommandLine - when only flags like --config are provided without command, need to handle gracefully (return configPath not null). (3) Config validation tests need valid YouTube URLs (https://www.youtube.com/@channel), not generic URLs. (4) YAML config deserialization uses snake_case keys (poll_interval not pollInterval). (5) Console output tests need [Collection] attribute with DisableParallelization to prevent parallel execution pollution.","created_at":"2026-02-27T04:47:18.313Z","tags":"yallarhorn,dotnet,testing,moq,xunit,system-commandline"}
{"id":"mem-67e62efb67acab22","information":"Flutter copy/share implementation: Use Clipboard.setData(ClipboardData(text: text)) for copy (requires import 'package:flutter/services.dart') and Share.share(text, subject: title) for share (requires share_plus package). When clipboard data comes from an AsyncValue provider, use .when() to handle data/loading/error states properly. Always run 'flutter pub get' after adding new packages to pubspec.yaml.","created_at":"2026-02-23T00:32:38.415Z","tags":"flutter,clipboard,share,share_plus"}
{"id":"mem-681dc15a3bfeb5b9","information":"PATCH /api/v1/channels/{id} implementation complete for Yallarhorn. Key patterns: (1) Use HttpPatch attribute for partial updates, (2) Apply updates only to non-null fields in request, (3) Always update UpdatedAt timestamp, (4) Use Range(1,1000) validation for episode_count_config, (5) Use RegularExpression for feed_type enum validation with case-insensitive parsing, (6) Return Ok(new { data = response }) for consistency with other endpoints.","created_at":"2026-02-25T23:25:26.947Z","tags":"dotnet,aspnetcore,api,pattern,rest"}
{"id":"mem-6a0aab64735dfb98","information":"ASP.NET Core feed endpoints pattern: When implementing feed endpoints with conditional request support (ETag/If-None-Match, Last-Modified/If-Modified-Since), use Response.Headers to set cache headers and Request.Headers.IfNoneMatch/IfModifiedSince to check conditional requests. For per-channel feeds, use Try/Catch around cache factory to handle NotFound scenarios when feed service returns null. Cache key pattern: \"channel:{channelId}:{feedType}\" for channel feeds, \"combined:{feedType}\" for combined feeds.","created_at":"2026-02-25T22:12:47.973Z","tags":"aspnet-core,feed-endpoints,conditional-requests,http-caching,podcast"}
{"id":"mem-6b83fc2a75a24e12","information":"Romcal 1.3.0 uses calendarFor() API with country names in camelCase (e.g., 'unitedStates', 'england'). The @romcal/calendar.* packages at 3.0.0-alpha.0 expect romcal 3.0.0-alpha.0 but work with 1.3.0's built-in calendars. Romcal generates dates as ISO strings in moment field. Romcal has no TypeScript types, so we created src/types/romcal.d.ts with declarations. Calendar caching with Map<string, Map<string, RomcalDay>> pattern works well for O(1) lookup.","created_at":"2026-02-20T20:38:37.694Z","tags":"romcal,typescript,liturgical-calendar,caching"}
{"id":"mem-6c1c5179d53a3f08","information":"C# logging abstraction pattern for DI-ready components:\n\n1. **ILogger interface**: Create interface with LogDebug/LogInformation/LogWarning/LogError/LogCritical methods, plus LogLevel property and IsEnabled() check. This allows different implementations without tying to Microsoft.Extensions.Logging.\n\n2. **Constructor injection pattern**: Support both LoggingConfig and direct ILogger injection:\n```csharp\n// Default constructor - no logging\npublic MyService() : this(config: null, logger: NullLogger.Instance) { }\n\n// Config-based constructor - creates internal logger\npublic MyService(Config? config, LoggingConfig? loggingConfig = null) {\n    _logger = loggingConfig != null ? new ConsoleFileLogger(loggingConfig) : NullLogger.Instance;\n    _ownsLogger = true;\n}\n\n// DI-friendly constructor - accepts injected logger\npublic MyService(Config config, ILogger logger, bool ownsFFmpeg = false, bool ownsLogger = false) {\n    _logger = logger ?? NullLogger.Instance;\n    _ownsLogger = ownsLogger;\n}\n```\n\n3. **Ownership flags**: Track which resources you own vs were injected so Dispose() only cleans up what you created. This is crucial for DI scenarios where the container manages lifetime.\n\n4. **Null logger**: Always provide a NullLogger.Instance singleton for scenarios where logging is disabled or not needed - prevents null checks everywhere.\n\n5. **File logging**: Use StreamWriter with AutoFlush=true for immediate writes. Create directory if it doesn't exist. Wrap in lock for thread-safety.\n\n6. **LogLevel filtering**: Use IsEnabled(LogLevel) check at the start of logging methods to avoid expensive string formatting for filtered logs.","created_at":"2026-02-24T09:54:03.558Z","tags":"C# logging dependency-injection patterns IDisposable"}
{"id":"mem-6c5836e8ae82de7c","information":"yt-dlp does not require YouTube API keys - it extracts metadata directly from YouTube. When documenting YouTube download tools, only HTTP Basic Auth for feed endpoints and admin management API should be included in authentication configuration. No api_credentials section is needed.","created_at":"2026-02-24T09:10:33.238Z","tags":"yt-dlp,youtube,configuration,authentication,no-api-required"}
{"id":"mem-6cee42aeaa4bb23d","information":"ChatterBox TTS in ComfyUI (TTS Audio Suite by diodiogod):\n\n**Common Issues**:\n- batch_size=0 is CORRECT (sequential processing recommended, not a bug)\n- Parameter position 6 in widgets_values should use \"auto\" for chunking mode, not hardcoded 100\n- FFmpeg must be installed separately for audio processing\n- Reference audio must be valid WAV, 3-10 seconds minimum for voice cloning\n- Empty output usually means: missing reference audio, wrong parameter type, or model not downloaded\n\n**Valid Parameters for ChatterBox**:\n- exaggeration: 0.0-2.0 (emotion expressiveness)\n- cfg_weight: 0.0-1.0 (speaker guidance)\n- temperature: 0.1-2.0 (randomness, 0.5 recommended)\n- seed: 0-4294967295\n- batch_size: 0 (sequential, recommended)\n\n**Key Insight**: \"100\" in workflow JSONs is likely in a position that should be a dropdown/mode selector, not a raw value. Check against known parameter ranges.\n\n**Community Resources**:\n- GitHub: https://github.com/diodiogod/TTS-Audio-Suite\n- Discord: https://discord.gg/EwKE8KBDqD\n- TTS Audio Suite v4.21+ evolved from \"ChatterBox SRT Voice\"","created_at":"2026-02-25T22:07:43.607Z","tags":"chatterbox,comfyui,tts,community,parameters,troubleshooting"}
{"id":"mem-6e0d3013ca97f78e","information":"SoundFlow RawDataProvider uses F32 (float32) sample format internally, but AudioFormat.Format was set to S16 (int16). This format mismatch causes WAV headers to claim S16 while actual audio data is F32, resulting in static/distortion. Fix: Always set AudioFormat.Format to F32 when using RawDataProvider, or convert samples to S16 before writing. When debug logging shows \"Provider.AudioFormat: Format=F32\" but \"_audioFormat.Format=S16\", the output will be corrupted.","created_at":"2026-02-22T05:10:25.853Z","tags":"soundflow,audio-format,f32,s16,bug-fix,wav"}
{"id":"mem-7060cc71e062cf70","information":"ASP.NET Core 10 Serilog Configuration Pattern:\n1. Use builder.AddYallarhornLogging() extension that reads LoggingOptions from config\n2. Log.Logger must be set before AddSerilog() call\n3. builder.Host.UseSerilog() sets up request logging\n4. MapHealthChecks requires WebApplication, not IApplicationBuilder\n5. HealthReport is in Microsoft.Extensions.Diagnostics.HealthChecks namespace\n6. JSON output template uses {PropertyName} syntax, Serilog rolling interval maps directly to Serilog.RollingInterval enum","created_at":"2026-02-24T20:15:02.941Z","tags":"aspnet-core,serilog,logging,di,health-checks,options-pattern"}
{"id":"mem-707acd41dacbf83a","information":"Path.GetDirectoryName() can return null for malformed paths (e.g., root paths without directory separators or invalid path formats). Always guard with null check before using the result with Directory.GetFiles() or other directory operations. In Harmony's GenerateCover method, the fix wraps directory-dependent code in `if (directory is not null)` block, allowing fallback to FFmpeg extraction when directory is null.","created_at":"2026-02-22T00:22:40.438Z","tags":"csharp null-safety Path.GetDirectoryName NullReferenceException bug-fix"}
{"id":"mem-70cbbcfcf204798b","information":"Created PlaylistsScreen following existing screen patterns (ChannelsScreen). Key implementation details:\n- Uses ConsumerStatefulWidget with StateNotifierProvider pattern\n- Load playlists in initState via Future.microtask\n- Pull-to-refresh via RefreshIndicator\n- Empty state with create button\n- FAB to create new playlist\n- PopupMenuButton on each card for delete action\n- Delete confirmation dialog with proper BuildContext handling (capture scaffoldMessenger before async gap)\n- Create playlist dialog with form validation","created_at":"2026-02-23T20:07:31.099Z","tags":"flutter,screen,playlists"}
{"id":"mem-70ed315c2860a133","information":"Odeon Flutter Frontend Structure: Complete inventory of 25 Dart files across 5 modules. Uses Riverpod for state management (StateNotifierProvider pattern), go_router for navigation with auth guards, media_kit for video playback. Key modules: 6 screens (home, login, video_detail, channels, settings, episodes), 2 widgets (video_card, channel_card), 5 providers (auth, videos, channels, api_config, video_player), 5 services (api_client 503 lines, auth_service, notification_service, background_polling_service, playback_position_service), 6 models. All implementations complete. Only TODO found: channel_card.dart:46 for navigating to channel videos. Architecture follows clean separation: Models → Services → Providers → Screens → Widgets.","created_at":"2026-02-20T09:01:02.245Z","tags":"flutter,mobile,riverpod,odeon,frontend,inventory,discovery"}
{"id":"mem-714b0723e7f35599","information":"For testing Console output in C#, use `Console.SetOut()` with `StringWriter` and `StringBuilder`. The test class should implement `IDisposable` to restore original `Console.Out` in the `Dispose` method. Note: `FluentAssertions` `.Should().Contain()` requires string arguments, convert chars with `.ToString()` for comparison.","created_at":"2026-02-22T04:19:56.132Z","tags":"csharp testing xunit console-output fluent-assertions"}
{"id":"mem-71e6c50fca9d67b5","information":"## SancaVia Unified App Feasibility Analysis\n\n**Finding:** Unification is FEASIBLE with moderate risk. 5 apps share 6 packages with excellent architectural consistency.\n\n**Critical Issues Found:**\n1. Route conflicts: All 5 apps define `path: '/'` - need namespacing\n2. Provider conflicts: `favoriteExaminationsProvider` and `defaultExaminationProvider` have duplicate names with different return types in confession_companion\n3. No ShellRoute: All apps use flat GoRoute, need StatefulShellRoute for unified tabs\n\n**Effort Estimate:** 206 hours (5 weeks, risk-adjusted 6-8 weeks)\n\n**Recommendation:** Start with provider naming fixes, create unified app scaffold with StatefulShellRoute","created_at":"2026-02-24T21:39:16.386Z","tags":"sancta-via,flutter,unification,feasibility,architecture,riverpod,gorouter"}
{"id":"mem-724aede7bb9214a4","information":"SoundFlowStitcher DI registration in TestRunner: Replace FFmpegStitcher with SoundFlowStitcher in BuildServices() method. Remove FFmpegWrapper registration (not needed for SoundFlowStitcher). SoundFlowStitcher constructor takes optional StitchingConfig, same as FFmpegStitcher, so registration is straightforward: services.AddSingleton<IAudioStitcher, SoundFlowStitcher>();","created_at":"2026-02-22T01:53:37.967Z","tags":"c#,di,soundflow,stitching,testrunner"}
{"id":"mem-72a1ab0a03f44650","information":"Added 7 playlist methods to ApiClient in frontend/lib/services/api_client.dart:\n- getPlaylists(): GET /api/v1/playlists - returns List<Playlist>\n- getPlaylist(id): GET /api/v1/playlist/{id} - returns Playlist\n- createPlaylist(name, description): POST /api/v1/playlist - returns Playlist\n- updatePlaylist(id, name, description): PUT /api/v1/playlist/{id} - returns Playlist\n- deletePlaylist(id): DELETE /api/v1/playlist/{id} - returns bool\n- addPlaylistItem(playlistId, videoId): POST /api/v1/playlist/{id}/items - returns PlaylistItem\n- removePlaylistItem(playlistId, itemId): DELETE /api/v1/playlist/{id}/items/{itemId} - returns bool\nUsed existing patterns: _handleRequest for typed responses, _handleVoidRequest for bool returns, and custom implementation with httpClient for List<Playlist> response like getChannels() method.","created_at":"2026-02-23T19:36:56.742Z","tags":"api_client,playlist,dart,flutter"}
{"id":"mem-75e72b4d551c5d9e","information":"Skaldforge build configuration setup: Directory.Build.props includes net8.0 target, nullable enabled, implicit usings, warnings as errors, version 0.1.0, MIT license, and CI/CD support. Directory.Packages.props uses central package management with Spectre.Console 0.49.1, xunit 2.9.2, FluentAssertions 6.12.0, NSubstitute 5.1.0, Microsoft.Extensions.Configuration 8.0.x, System.Text.Json 8.0.5, and JsonSchema.Net 7.3.0. .editorconfig enforces 4-space indents, LF line endings, final newline, unused using removal, using sorting, and comprehensive C# naming conventions with underscore-prefixed private fields.","created_at":"2026-02-19T10:08:27.367Z","tags":"build-configuration,dotnet,csharp,editorconfig,central-package-management"}
{"id":"mem-77150f27c79d9d0a","information":"When testing ASP.NET Core controllers that use controllers with nested data objects (like Ok(new { data = response })), the JSON deserialization must account for the wrapper object. Use JsonDocument.Parse and GetProperty(\"data\") to extract nested content before deserializing to the target type.","created_at":"2026-02-26T04:09:27.749Z","tags":"testing,aspnet-core,json,controllers"}
{"id":"mem-780d8f333c7038ea","information":"FeedService generates RSS/Atom feeds per channel. Uses IEpisodeRepository.GetDownloadedAsync(channelId, feedType, limit) which already filters by status=Completed and appropriate file path (audio/video/both). Episode count defaults to 50 if EpisodeCountConfig is <=0. ETag is SHA256 hash of XML content. Service injects IRssFeedBuilder, IAtomFeedBuilder, IChannelRepository, IEpisodeRepository.","created_at":"2026-02-25T21:50:22.617Z","tags":"feed-service,rolling-window,C#,yallarhorn,TDD"}
{"id":"mem-78234e291da31a29","information":"Skaldforge project planning completed successfully. Decomposed into 6 documentation tasks: PROJECT_CHARTER (vision/goals), ARCHITECTURE (system design with Mermaid diagrams), TECHNICAL_SPECS (JSON schema, APIs, C# structure), MILESTONES (8-week timeline), TODO (350+ checklists), README (entry point). Feature-based decomposition worked well for documentation tasks. Workers completed in parallel where dependencies allowed.","created_at":"2026-02-19T09:39:13.035Z","tags":"coordinator,decomposition,documentation,skaldforge,planning,feature-based-strategy"}
{"id":"mem-78e1806f2efcadc0","information":"When writing tests with AwesomeAssertions (FluentAssertions fork), use `BeGreaterThanOrEqualTo` not `BeGreaterOrEqualTo`. When verifying async calls with NSubstitute's Received(), use `await` with the Received() call for async methods.","created_at":"2026-02-20T03:38:31.116Z","tags":"testing,nunit,awesomeassertions,nsubstitute"}
{"id":"mem-7987cfcb29ef0843","information":"StatefulShellRoute pattern for go_router ^15.x: Use StatefulShellRoute.indexedStack with branches array containing StatefulShellBranch objects. Each branch has its own routes list with a single GoRoute. Use NoTransitionPage for instant tab switches. The navigationShell.currentIndex tracks active tab. ScaffoldWithBottomNav wraps navigationShell and uses NavigationBar with NavigationDestination widgets.","created_at":"2026-02-25T06:01:40.666Z","tags":"go_router,StatefulShellRoute,flutter,bottom-navigation,tabs"}
{"id":"mem-79c5420431141ba3","information":"SoundFlowStitcher unit tests should use the same patterns as FFmpegStitcherTests.cs - using FluentAssertions, NSubstitute, NUnit with [TestFixture] and [NonParallelizable]. Key test patterns: 1) CreateTestWavFile helper creates minimal valid WAV file with RIFF header and silent audio data. 2) Dispose tests should verify ObjectDisposedException is thrown by all public methods. 3) Silence caching test verifies same duration returns same file path. 4) AudiobookMetadata type has ambiguity between Skaldforge.Core.Interfaces and Skaldforge.Stitching namespaces - use fully qualified name.","created_at":"2026-02-22T02:09:21.297Z","tags":"testing,soundflow,stitching,patterns"}
{"id":"mem-7c6b069392d14c85","information":"When copying Flutter features to a new namespace, use these patterns:\n1. Create namespaced routes with a helper class (e.g., PrayerRoutes) with static const paths\n2. Prefix all providers with the feature name (e.g., prayerSettingsProvider, prayerCategoriesProvider)\n3. Use barrel files (models.dart, providers.dart, etc.) for clean exports\n4. Copy models first, then database/repositories, then providers, then widgets, then screens\n5. Update all imports to use relative paths within the feature\n6. Use shared_ui package for common theming and settings components\n7. Run flutter analyze after each major component to catch errors early","created_at":"2026-02-25T06:53:04.087Z","tags":"flutter,feature-copy,namespacing,architecture,riverpod"}
{"id":"mem-7ca5806a8c149bab","information":"Created MusicConfig class in Skaldforge.Core/Configuration with ducking parameters (VolumeDb, DuckVolumeDb, DuckAttackMs, DuckReleaseMs) and IMusicGenerator interface in Skaldforge.Core/Interfaces. MusicMood enum duplicated in Core to maintain clean architecture (Core doesn't reference Music project). AudioPipelineOptions now has MusicConfig? Music property for optional background music. Pattern follows existing config classes (TtsConfig, AudioConfig) with XML docs and sensible defaults.","created_at":"2026-02-22T23:48:50.722Z","tags":"music config ducking interface architecture"}
{"id":"mem-7dc5024351fd399d","information":"SoundFlow StreamDataProvider format mismatch bug: When using StreamDataProvider(AudioEngine, AudioFormat, Stream) with a hardcoded AudioFormat that doesn't match the actual WAV file, SoundFlow's WavReader calculates incorrect stream positions causing ArgumentOutOfRangeException. Fix: Use StreamDataProvider(AudioEngine, Stream, ReadOptions) constructor which auto-detects format from WAV header. This is especially important when working with TTS output that may use non-standard sample rates (e.g., Kokoro TTS uses 24000Hz, not 44100Hz).","created_at":"2026-02-22T02:25:30.972Z","tags":"soundflow,wav,audio-format,bug-fix"}
{"id":"mem-7ded67b35269553c","information":"Yallarhorn podcast client feed endpoints (from FeedController.cs):\n- Per-channel feeds: /feed/{channelId}/audio.rss, /feed/{channelId}/video.rss, /feed/{channelId}/atom.xml\n- Combined feeds: /feeds/all.rss, /feeds/all-video.rss, /feeds/all.atom\n- Media files: /feeds/{channelId}/{type}/{filename}\n- Supported MIME types: audio/mpeg (mp3), audio/mp4 (m4a), audio/aac, audio/ogg, video/mp4, video/webm\n- HTTP caching: ETag (SHA256), Last-Modified, Cache-Control: public max-age=300 stale-while-revalidate=60\n- Conditional requests: If-None-Match, If-Modified-Since return 304 Not Modified\n- Authentication is OPTIONAL - configured via Auth.FeedCredentials.Enabled in appsettings","created_at":"2026-02-27T10:41:37.801Z","tags":"yallarhorn podcast feeds endpoints rss atom"}
{"id":"mem-7f1e620587996154","information":"ASP.NET Core RateLimiter implementation pattern for Yallarhorn:\n1. Use AddRateLimiter() with AddPolicy() for different rate limit policies (read/write/trigger)\n2. Use SlidingWindowRateLimiter with partitions by IP address for per-client limiting\n3. Use custom OnRejected handler to return JSON 429 response with RATE_LIMITED error code\n4. Middleware adds X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Reset headers\n5. Rate limits: Read (GET): 100/min, Write (POST/PUT/PATCH/DELETE): 30/min, Trigger (refresh/retry): 10/min\n6. Use X-Forwarded-For header for client IP when behind proxy","created_at":"2026-02-26T00:34:16.107Z","tags":"aspnet-core,rate-limiting,middleware,yallarhorn"}
{"id":"mem-7f93737627a35766","information":"In Harmony AAXtoM4BConvertor, AudibleLibraryDto properties (authors, narrators, genres, series_title, series_sequence) are nullable strings. When using Split() on these, use null-conditional operator with null-coalescing: `data.authors?.Split(\",\") ?? Array.Empty<string>()`. For string concatenation with series info, check !string.IsNullOrWhiteSpace(series_title) first to avoid creating malformed strings like \" #5\" when title is null. The old pattern `new List<string>() { data?.series_title + \" #\" + data?.series_sequence }` creates \"# \" when both are null or \" #5\" when only sequence exists.","created_at":"2026-02-22T03:37:30.410Z","tags":"C#,null-safety,Split,string-concatenation,TagLib,metadata"}
{"id":"mem-803135e2f957b0c9","information":"Skaldforge project has comprehensive planning documentation:\n\n**Planning Documents Found:**\n- `docs/TODO.md` - Granular task checklist with 467 lines, tracking all 4 milestones\n- `docs/MILESTONES.md` - 8-week timeline with 4 milestones, dependency graph, risk mitigation\n- `docs/TECHNICAL_SPECS.md` - Full JSON schema, API endpoints, CLI commands, C# project structure\n- `docs/ARCHITECTURE.md` - System design, data flow diagrams, tech stack decisions, integration points\n- `docs/PROJECT_CHARTER.md` - Vision, goals, MVP scope, success criteria\n\n**Key Planned Features (MVP):**\n1. JSON manuscript parser with validation\n2. AI-powered character voice analysis (via Ollama)\n3. Voice-to-character mapping with human approval workflow\n4. Kokoro TTS integration for synthesis\n5. Audio stitching and export (MP3/M4B)\n6. Terminal UI (Spectre.Console)\n\n**Phase 2+ Roadmap:**\n- Music Engine (ComfyUI integration)\n- Sound Effects (scene-based SFX)\n- Real-time Preview\n- Multi-project Support\n- Web UI (Blazor)\n- Cloud Deployment\n- Voice Cloning\n- Collaboration Features\n\n**Current Implementation Status:**\n- Core models exist (Manuscript, Character, Scene, DialogueLine, etc.)\n- Configuration classes complete\n- Interfaces defined (IStoryParser, IVoiceMapper, ITtsEngine, etc.)\n- Minimal implementation code (placeholder classes in Tts/Audio/Ai projects)\n\n**TODO Categories:**\n- M1 (Weeks 1-2): Project setup, CI/CD, Core Models, JSON Parser, CLI skeleton, Config system\n- M2 (Weeks 3-4): Ollama client, Character Analyzer, Voice Mapper, TUI approval workflow\n- M3 (Weeks 5-6): Kokoro TTS client, Synthesis engine, Audio pipeline, Cache system\n- M4 (Weeks 7-8): Audio stitching, Export (MP3/M4B/WAV/FLAC), E2E testing, Documentation","created_at":"2026-02-19T18:17:20.358Z","tags":"skaldforge,planning,roadmap,milestones,architecture,documentation"}
{"id":"mem-81111f5541d09f7b","information":"When copying Flutter features between apps in a monorepo: 1) Namespace all routes under a feature path (e.g., /calendar/*), 2) Prefix all Riverpod providers with the feature name (e.g., calendarSelectedDateProvider), 3) Use shared packages for theming and data (sancta_via_shared_ui, sancta_via_liturgical_calendar), 4) Follow the feature folder structure: config/, providers/, screens/, widgets/, 5) Create a library export file (e.g., calendar.dart) for clean imports.","created_at":"2026-02-25T07:41:47.899Z","tags":"flutter,monorepo,feature-copy,namespacing,riverpod,go_router"}
{"id":"mem-812b9e91261be940","information":"Skaldforge test patterns: Use NUnit + FluentAssertions (AwesomeAssertions package). Follow existing ModelTests.cs pattern with region-based organization. Tests use `// Arrange & Act` comments and FluentAssertions `.Should()` syntax. Configuration classes have sensible defaults that need testing. Pre-existing errors: Genre.SciFi (not Scifi), NarratorPace (not SpeakingPace for NarratorConfig).","created_at":"2026-02-19T23:03:48.883Z","tags":"testing,nunit,fluentassertions,skaldforge,c#"}
{"id":"mem-81d6fbd24b09d09e","information":"## Odeon .NET Backend Architecture Discovered\n\n### Key Findings:\n1. **API Endpoints**: 4 controllers (Videos, Channels, Sync, Health) with 12+ endpoints\n2. **Download Stack**: yt-dlp + FFmpeg auto-transcode to H.264/AAC\n3. **Missing Features**: No playlist support, no quality selection, no subtitles\n4. **Background Services**: ChannelSyncBackgroundService (60min interval), VideoDownloadBackgroundService (concurrent)\n5. **Security**: API key auth, rate limiting, path traversal prevention\n\n### Key Files:\n- YtDlpService.cs (645 lines) - Core download logic, format string configurable\n- DownloadService.cs (416 lines) - Auto-transcode via FFmpeg\n- VideosController.cs (469 lines) - Main API endpoints\n\n### Database:\n- Channel 1:N Video with cascade delete\n- Entities: Video, Channel, ApiKey\n\n### Why This Matters:\nAdding playlist support would require new endpoints, new entity relationships, and download batch processing. Quality selection requires API changes to DownloadVideoRequest and YtDlpService.","created_at":"2026-02-20T09:05:49.662Z","tags":"odeon,backend,.NET,yt-dlp,architecture,discovery"}
{"id":"mem-83715674dcd54e44","information":"FFmpegStitcher segment ordering bug fix: Segments were sorted alphabetically by SceneId, but dialogue segments have null SceneId (becomes empty string) causing them to sort BEFORE scene narration. This broke story order. FIX: Preserve manifest order instead - segments are already in correct sequence from the manifest. Changed from OrderBy( SceneId).ThenBy(...) to simple ToList() to preserve original order.","created_at":"2026-02-26T05:25:22.958Z","tags":"FFmpegStitcher,segment-ordering,bug-fix,audiobook-stitching"}
{"id":"mem-8687d3f7e6d10357","information":"Flutter API client patterns in Odeon:\n- Models use `fromJson` factory constructor and `toJson()` method\n- Enums use `fromString`/`toApiString` pattern and switch expressions\n- Enums use string values for API serialization (not ints like VideoStatus)\n- API methods either use `_handleRequest<T>` for typed responses or direct HTTP calls for list endpoints\n- Void operations use `_handleVoidRequest` helper\n- Paged responses include: items list, totalCount, page, limit, hasMore fields","created_at":"2026-02-20T09:11:09.893Z","tags":"flutter,dart,api-client,models,patterns"}
{"id":"mem-86b646be351b6148","information":"FFmpegStitcher testing approach: Use minimal valid WAV file headers (44 bytes + audio data) for integration tests that need actual audio files. This avoids dependency on external audio files and creates self-contained tests. The WAV header format: RIFF header + fmt chunk (16 bytes) + data chunk with sample data. Unit tests for FFmpegCommands focus on string output verification (no FFmpeg needed). FFmpegWrapper tests stub file operations but require actual FFmpeg for ExecuteAsync tests (use Assert.Ignore for missing FFmpeg).","created_at":"2026-02-21T07:45:25.584Z","tags":"testing,ffmpeg,audio,wav-header,unit-tests"}
{"id":"mem-8746fd786d09be92","information":"sancta_via_shared_ui package analysis completed. Main issues: 1) No tests (critical), 2) Missing analysis_options.yaml (high), 3) Duplicated liturgical color definitions between app_theme.dart and liturgical_color_extensions.dart (high), 4) _getLanguageFlag method duplicated 3 times in language_selector.dart (high), 5) Path dependency prevents pub.dev publishing (high), 6) Silent exception handling in 8 catch blocks (medium), 7) Deprecated RadioListTile groupValue/onChanged properties (medium), 8) Deprecated withOpacity() usage in 5 files (medium). Positives: Clean architecture, good immutability patterns, excellent documentation, Material 3 design.","created_at":"2026-02-20T03:48:32.346Z","tags":"sancta_via_shared_ui,analysis,code-quality,flutter,dart"}
{"id":"mem-87d705e447ef11ea","information":"Git and GitHub repo initialization completed successfully using pattern: 1) git init && git branch -M main, 2) gh repo create --public --description \"...\" --source=. --remote=origin, 3) git add . && git commit, 4) git push -u origin main. The gh CLI automatically creates the remote on GitHub and sets origin locally in one step.","created_at":"2026-02-27T21:25:11.248Z","tags":"git,github,initialization,gh-cli"}
{"id":"mem-885121f185e890a6","information":"FFmpeg concat demuxer requires single quotes in file paths to be escaped. If a path contains a single quote (e.g., \"O'Brien's chapter.wav\"), the concat file line must be written as: `file 'path with '\\'' escaped quote'`. The pattern `'\\''` means: end the string, add an escaped literal single quote, start a new string. In C#: `path.Replace(\"'\", \"'\\\\''\")`. This is already correctly handled in `FFmpegCommands.EscapePath()` and `FFmpegStitcher.WriteConcatFileAsync()`, but was missing in `FFmpegStitcher.ExportAsync()` when building the concat file content directly.","created_at":"2026-02-21T10:37:08.875Z","tags":"ffmpeg,concat-demuxer,path-escaping,single-quote"}
{"id":"mem-89aeb3526a46ba9f","information":"ChatterBox TTS for ComfyUI TTS-Audio-Suite - Key Parameter Fixes:\n\n1. **UnifiedTTSTextNode widget_values order** (CRITICAL):\n   `[\"text\", \"narrator_voice dropdown\", seed, \"seed_behavior\", enable_chunking, max_chars, \"chunk_method\", silence_ms, enable_cache, batch_size]`\n   \n   The `seed_behavior` parameter (dropdown: \"fixed\", \"increment\", \"randomize\") was MISSING from the workflow I created. This caused type mismatches.\n\n2. **Correct ChatterBoxEngineNode parameters**:\n   - language: STRING dropdown (\"English\", \"German\", etc.) - NOT integer!\n   - device: STRING dropdown (\"auto\", \"cuda\", \"cpu\")\n   - exaggeration: FLOAT 0.0-2.0 (default 0.5, try 0.7 for dramatic)\n   - temperature: FLOAT 0.0-1.0 (default 0.8)\n   - cfg_weight: FLOAT 0.0-1.0 (default 0.5, use ~0.3 for fast speakers)\n   - crash_protection_template: STRING \"hmm ,, {seg} hmm ,,\"\n\n3. **Empty 1-second clips** are caused by:\n   - Wrong parameter types (integers where strings/floats expected)\n   - Missing seed_behavior parameter\n   - Device set incorrectly (use \"auto\")\n\n4. **Official example workflow**: https://github.com/diodiogod/TTS-Audio-Suite/blob/main/example_workflows/Chatterbox%20integration.json\n\n5. **Voice cloning**: Use CharacterVoicesNode to load voice reference, connect to opt_narrator input on UnifiedTTSTextNode.\n\n6. **batch_size=0 is CORRECT** - sequential processing is recommended for quality.","created_at":"2026-02-25T22:10:56.793Z","tags":"chatterbox,comfyui,tts,tts-audio-suite,workflow"}
{"id":"mem-89e14393b0d45a93","information":"FFmpeg concat mixed format fix: When concatenating audio files with different formats (e.g., mono 24kHz TTS with stereo 44.1kHz SFX/Music), FFmpeg's concat demuxer produces incorrect output (2x duration expansion and static). \n\nSOLUTION: Pre-convert each input file to a uniform format (44100Hz stereo 16-bit PCM) BEFORE concatenation, then use `-c copy` for the concat step. This ensures:\n1. All inputs have identical codec settings (sample rate, channels, bit depth)\n2. The concat demuxer can perform a simple binary concatenation without re-encoding\n3. No duration expansion or static artifacts\n\nKey change in FFmpegStitcher.cs:\n- Added PreConvertToUniformFormatAsync() method that converts each input file\n- Modified the segment processing loop to convert each file before adding to concat list\n- Changed concat command from `-ar 44100 -ac 2 -c:a pcm_s16le` to `-c copy`\n\nWHY it matters: FFmpeg's concat demuxer simply concatenates streams without re-encoding. If inputs have different formats, it either fails or produces corrupted output. Pre-converting ensures format uniformity.","created_at":"2026-02-26T05:57:54.242Z","tags":"ffmpeg,audio,concat,format-conversion,duration-expansion,static-fix"}
{"id":"mem-8a3238263e1420e5","information":"xUnit async test pattern: Convert test methods from `void` to `async Task` signature. If no actual async work to await, use `await Task.CompletedTask;` to satisfy the pattern. AVOID `ConfigureAwait(false)` in xUnit tests - it triggers analyzer warning xUnit1030 about bypassing parallelization limits.","created_at":"2026-02-22T23:19:03.339Z","tags":"xunit,async,testing,c#"}
{"id":"mem-8adbecbca380e62c","information":"When creating xUnit test projects in a solution, the main project may pick up test files from subdirectories. Add ItemGroup with Compile Remove and EmbeddedResource Remove entries to the main .csproj to exclude the test project folder. Example: `<ItemGroup><Compile Remove=\"Harmony.Tests\\**\\*.cs\" /></ItemGroup>`","created_at":"2026-02-21T23:06:19.531Z","tags":"dotnet,test-project,xunit,solution-configuration"}
{"id":"mem-8b0db721c11c4cdc","information":"Created multi-stage Docker configuration for tempus-bede Bun application. Uses oven/bun:1-alpine base image with non-root user for security. Healthcheck uses wget spider mode for efficiency. The build stage separates dependencies installation from source copy for layer caching optimization.","created_at":"2026-02-20T20:40:10.266Z","tags":"docker,bun,deployment,alpine,multi-stage"}
{"id":"mem-8b8f4ba91005d2e6","information":"FFmpegStitcher successfully combines audio segments into complete audiobooks. The stitcher handles TTS narration, dialogue, and SFX by concatenating them in order with scene transitions. Error messages about missing temp files can be false positives - check for the final output file in the output directory since File.Move happens before cleanup checks. Output format: WAV 44.1kHz mono PCM. For debugging: set breakpoints in FFmpegStitcher.StitchChapterAsync (line 89).","created_at":"2026-02-26T02:46:17.601Z","tags":"ffmpeg,stitching,audiobook,debugging,false-positive-error"}
{"id":"mem-8bc786cf3b856c3a","information":"Spectre.Console Markup.Escape() tests: The method correctly escapes square brackets by doubling them ([ -> [[, ] -> ]]). Edge cases tested: empty string, no brackets (passthrough), single brackets, nested brackets, newlines/tabs preserved, Unicode/emoji preserved, null throws ArgumentNullException. Important: double-escaping is NOT idempotent - escaped strings get escaped again. Use Markup.Escape() once on any dynamic text before passing to AnsiConsole.MarkupLine().","created_at":"2026-02-21T10:28:25.668Z","tags":"spectre-console,testing,markup-escaping,csharp"}
{"id":"mem-8bd747d9bf02e0db","information":"WHY: Holy Spirit Novena is the original novena of the Church, prayed from Ascension to Pentecost. Each of 9 days focuses on one of the Seven Gifts of the Holy Spirit.\n\nWHAT: Created holy-spirit.json following the established novena JSON schema with:\n- id: holy-spirit\n- 9 days: Day 1-7 (Seven Gifts), Day 8 (Fruits), Day 9 (Pentecost)\n- Traditional prayers: Veni Sancte Spiritus, Veni Creator Spiritus, Sequence for Pentecost\n- Includes opening_prayer, daily_prayer, closing_prayer, reflection, intention_prayer, scripture per day\n\nGOTCHAS:\n- The app auto-discovers novenas from assets/novenas/*.json via AssetManifest.json\n- There's a fallback hardcoded list in novena_database_initializer.dart that should also be updated\n- JSON structure follows divine-mercy.json as the reference template\n- Each day needs: day, title, opening_prayer, daily_prayer, closing_prayer, reflection, intention_prayer, scripture","created_at":"2026-02-22T05:08:19.175Z","tags":"novena_companion,holy-spirit,json,seven-gifts,pentecost"}
{"id":"mem-8c1277d8b39b62c5","information":"Added analysis_options.yaml to missing Flutter packages in monorepo. Standard template includes flutter_lints with rules: implicit-casts/dynamic false, prefer_single_quotes, require_trailing_commas, sort_pub_dependencies. For packages using 'lints' instead of 'flutter_lints', update pubspec.yaml to use flutter_lints for consistency.","created_at":"2026-02-20T08:54:52.449Z","tags":"flutter,linting,analysis_options,monorepo"}
{"id":"mem-8cb905a0687ab659","information":"Created global exception handling middleware for Yallarhorn project. Files created:\n- src/Yallarhorn/Middleware/ExceptionHandlingMiddleware.cs - catches unhandled exceptions, logs them with Serilog, returns standardized JSON error responses\n- src/Yallarhorn/Middleware/ErrorResponse.cs - DTO for standardized error responses with errorId, status, error, message, details, timestamp, path, method\n\nIntegration: Added `app.UseGlobalExceptionHandling()` in Program.cs before other middleware.\n\nException mapping: Handles ArgumentNullException/ArgumentException (400), KeyNotFoundException (404), UnauthorizedAccessException (401), InvalidOperationException (400), TimeoutException (503), HttpRequestException (503), and default (500).\n\nKey implementation details:\n- Uses ILogger<ExceptionHandlingMiddleware> for logging\n- Error details only shown in development or when DebugMode=true\n- Each error has unique 8-char errorId for correlation\n- Uses standard Microsoft.Extensions.Logging patterns with LogError/LogWarning/LogInformation","created_at":"2026-02-24T07:04:52.757Z","tags":"middleware,exception-handling,serilog,aspnet-core"}
{"id":"mem-8d31654700eeba40","information":"Added seasonal prayers to sancta_via_prayer_companion: O Antiphons (Dec 17-23, all 7 in single JSON with antiphons array), Christmas Proclamation (from Roman Martyrology), and updated Veni Sancte Spiritus (Golden Sequence for Pentecost). All include full Latin translations, attribution, and liturgicalSeason metadata. Prayer JSON format uses: id, title, text, translation.latin, attribution, notes, categories, description, tags, isLiturgical, liturgicalPriority, liturgicalSeason, timeOfDay.","created_at":"2026-02-22T02:56:11.886Z","tags":"prayer-format seasonal advent christmas pentecost json"}
{"id":"mem-8d3bab91ff0aa800","information":"Flutter monorepo build verification: All 5 apps (bible_reading_app, confession_companion, liturgical_calendar_app, novena_companion, prayer_companion) use pubspec_overrides.yaml for local path dependencies. Run `flutter pub get` and `flutter analyze --no-pub` per app - not `flutter build apk` which is too slow for verification. All apps have only info/warning lint issues, no compilation errors.","created_at":"2026-02-21T05:27:43.756Z","tags":"flutter,build,verification,monorepo,sancta_via"}
{"id":"mem-8e4c02a979ddbd3e","information":"ChannelSyncBackgroundService already uses Parallel.ForEachAsync with IConcurrencyManager.MaxSyncParallelism for parallel channel synchronization. The implementation creates a new scope per channel for thread-safe DbContext usage and properly handles cancellation tokens. Testing Parallel.ForEachAsync behavior requires focused tests that verify the parallelism controls rather than mocking the entire service provider chain.","created_at":"2026-02-17T23:18:12.669Z","tags":"parallel foreach async sync background service concurrency"}
{"id":"mem-907cc6eca9027fc5","information":"Marian antiphon prayer JSON format in sancta_via_prayer_companion: Each prayer file uses id (snake_case), title (English + Latin in parentheses), text (English), translation.latin (full Latin text), attribution, notes, categories (array, e.g., [\"marian\"]), description, tags (array), isLiturgical (boolean), liturgicalPriority (number 1-10), liturgicalSeason (string or null), timeOfDay (string like \"evening\" or \"anytime\"). The 4 Marian antiphons are: 1) Alma Redemptoris Mater (Advent to Candlemas Feb 2), 2) Ave Regina Caelorum (Candlemas to Holy Wednesday, Lent), 3) Regina Caeli (Easter season), 4) Salve Regina (Ordinary Time remaining). Each is sung at Compline (evening prayer).","created_at":"2026-02-22T02:44:29.500Z","tags":"prayer-format marian antiphon liturgical json sancta_via"}
{"id":"mem-90d8d9a1dee4709e","information":"Created PlaylistScreen in Flutter - displays videos in a playlist with play all button, individual video playback, and remove from playlist functionality. Uses VideoCard widget, VideoPlayerNotifier for playback, PlaylistsProvider for data. Added route /playlist/:id in router.dart. Connected PlaylistsScreen to navigate to PlaylistScreen on tap.","created_at":"2026-02-23T20:22:26.801Z","tags":"flutter,playlist,screen,video_player"}
{"id":"mem-91c76e9ac273deb5","information":"TextChunker implementation: Use Regex with Compiled | IgnoreCase | Multiline options for chapter/scene break pattern matching. Word counting via Split with RemoveEmptyEntries for efficiency. When handling text boundaries, be careful with \\r\\n vs \\n handling across platforms.","created_at":"2026-02-20T05:20:18.718Z","tags":"text-chunking,regex,csharp,prose-processing"}
{"id":"mem-929418fa7882bc47","information":"AAXCtoM4BConvertor code quality improvements: (1) Removed redundant 'this.' qualifiers - C# style prefers underscore-prefixed private fields accessed without 'this.' (2) Standardized null checks to 'is null'/'is not null' pattern - this is the modern C# pattern matching syntax (3) Extracted magic numbers to constants with XML documentation: MaxAuthorsBeforeVarious (4) and DefaultAacBitrate (\"64k\")","created_at":"2026-02-22T02:17:10.705Z","tags":"c#,code-quality,refactoring,null-checks,constants"}
{"id":"mem-92ac7841fec73466","information":"Background audio playback for Flutter media_kit + audio_service requires multiple fixes: 1) Initialize AudioService at startup (not lazy), 2) Add androidNotificationOngoing:true to config, 3) Add WAKE_LOCK and REQUEST_IGNORE_BATTERY_OPTIMIZATIONS permissions, 4) Add turnScreenOn and showWhenLocked to AndroidManifest activity/service, 5) Add WidgetsBindingObserver to handle app lifecycle, 6) Use wakelock_plus to prevent CPU sleep, 7) Configure AudioSession with proper AndroidAudioAttributes (movie contentType, media usage) and audio focus (gain). The audio_service already handles Android foreground service setup but needs proper initialization timing and wake lock.","created_at":"2026-02-23T06:26:15.602Z","tags":"flutter,audio_service,background-playback,mobile,android"}
{"id":"mem-92aeb6dbfe520e9f","information":"Harmony testing patterns: Use InternalsVisibleTo in Harmony.csproj to allow test project to access internal classes. CommandLineParser default values are set via Option attribute's Default parameter, not property initializers - test by inspecting the attribute, not the property. For testing private methods, use reflection with TargetInvocationException handling to unwrap the actual exception.","created_at":"2026-02-22T01:24:17.587Z","tags":"testing,dotnet,xunit,reflection,internals-visible-to"}
{"id":"mem-938aab216a65db73","information":"Flutter DropdownMenu is the Material 3 replacement for DropdownButtonFormField. The `value` property is deprecated in favor of `initialSelection`. Use DropdownMenu<T> with dropdownMenuEntries (list of DropdownMenuEntry) instead of items (list of DropdownMenuItem). Leading icon uses leadingIcon instead of decoration.prefixIcon. The inputDecorationTheme can be applied for border styling.","created_at":"2026-02-20T19:58:12.851Z","tags":"flutter,material3,dropdown,deprecation"}
{"id":"mem-939bdfe5bbf6ce7f","information":"C# Utility Library Implementation Pattern:\n- Static classes with pure functions are ideal for utility classes (no state, thread-safe)\n- TDD approach: write comprehensive tests first covering edge cases, then implement\n- FileSizeFormatter: Use 1024-based KB/MB/GB units with smart decimal trimming (trim trailing zeros for clean output)\n- DurationFormatter: Use integer division for HH:MM:SS format, support milliseconds variant\n- SlugGenerator: Use Regex for text normalization - lowercase, replace non-alphanumeric with hyphens, collapse consecutive hyphens\n- EnvVarExpander: Manual parsing (char-by-char) is more reliable than regex for nested braces; support ${VAR}, ${VAR:-default}, ${VAR:?error} syntax\n- Tests: Use FluentAssertions for readable assertions, create 15-20 tests per utility covering edge cases","created_at":"2026-02-24T20:07:26.774Z","tags":"C#,utilities,TDD,static-classes,pure-functions,regex,formatting"}
{"id":"mem-94aaffdf63f2ba13","information":"Added playlist queue state to VideoPlayerProvider in Flutter/Riverpod. Added: currentPlaylist (List<Video>), currentIndex (int), with computed properties: hasPlaylist, isFirstVideo, isLastVideo, nextVideo, previousVideo. Methods: playPlaylist(playlist, startIndex), playNext(), playPrevious(), shuffle(startPlaying), clearPlaylist(). Video completion auto-advance implemented via _completedSubscription listening to player.stream.completed.","created_at":"2026-02-23T19:54:19.692Z","tags":"flutter,riverpod,video-player,playlist,media-kit"}
{"id":"mem-951810c36c9c1d3e","information":"## Flutter AppLogger Import Conflict Resolution\n\n**Problem:** When a Flutter app has a local `utils/logger.dart` exporting `AppLogger` AND imports a shared package (`sancta_via_shared_ui`) that also exports `AppLogger`, Dart reports an ambiguous import error: \"The name 'AppLogger' is defined in the libraries 'package:sancta_via_shared_ui/...' and 'package:my_app/utils/logger.dart'\".\n\n**Root Cause:** Two libraries export the same symbol, creating ambiguity at import sites.\n\n**Solution:**\n1. Keep the local logger.dart as the canonical source (self-contained)\n2. Add `hide AppLogger` to the shared_ui import in consuming files:\n   ```dart\n   import 'package:sancta_via_shared_ui/sancta_via_shared_ui.dart' hide AppLogger;\n   import 'utils/logger.dart';\n   ```\n\n**Alternative:** Remove local logger.dart entirely and re-export from shared_ui with app-specific prefix, but this creates more coupling.\n\n**Affected Files Pattern:** Any file that imports both the shared_ui package AND uses AppLogger needs the `hide AppLogger` clause.\n\n**Verification:** Run `flutter analyze --no-pub` after fixes to confirm no ambiguous import errors.","created_at":"2026-02-21T05:28:50.454Z","tags":"flutter,dart,import-conflict,applogger,shared-ui,monorepo"}
{"id":"mem-9663946aa4f8494d","information":"Yallarhorn project is now feature-complete. All phases 1-8 are done: project setup, data layer, download pipeline, feed generation, API, authentication, integration tests, and CLI. Server runs on port 5001, all 1,130+ tests pass, endpoints tested with curl. Stale Hive cells have been cleaned up.","created_at":"2026-02-26T05:57:55.985Z","tags":"yallarhorn,project-complete,phases-done"}
{"id":"mem-96acb3ade21ec31c","information":"ComfyUiMusicGenerator was not implementing IMusicGenerator interface but had duplicate local type definitions (MusicMood, MusicGenerationRequest, MusicGenerationResult). Fixed by: (1) Adding `: IMusicGenerator` to class, (2) Removing duplicate types, (3) Adding `using Skaldforge.Core.Interfaces;`, (4) Implementing IsHealthyAsync (delegates to ComfyUiClient.IsHealthyAsync), (5) Implementing GetSupportedMoods (returns MoodMappings.Keys).","created_at":"2026-02-26T01:40:07.284Z","tags":"C# interface inheritance music generator IMusicGenerator"}
{"id":"mem-97c7bf088fe9e636","information":"Docker deployment for .NET 10 applications requiring yt-dlp and ffmpeg:\n\n**Multi-stage build pattern:**\n1. Build stage: Use `mcr.microsoft.com/dotnet/sdk:10.0` for compilation\n2. Tools stage: Install yt-dlp and ffmpeg in `runtime-deps:10.0-bookworm-slim`\n3. Runtime stage: Use `aspnet:10.0-bookworm-slim` as final base\n\n**Key considerations:**\n- yt-dlp installation via pip3 is more reliable than binary download\n- Debian bookworm-slim variant includes minimal Python for yt-dlp\n- Copy Python libraries from tools stage to runtime stage for yt-dlp to work\n- Non-root user (UID 1000) for security\n- /config and /data volume mounts for stateless container\n- HEALTHCHECK using `/api/v1/health` endpoint with curl\n\n**Resource considerations:**\n- Minimum 1GB RAM (2-4GB recommended)\n- FFmpeg transcoding uses 1-2 cores per stream\n- Storage: ~3-4GB per 50 audio episodes, ~25-40GB per 50 video episodes","created_at":"2026-02-24T12:49:51.067Z","tags":"docker,.net,deployment,yt-dlp,ffmpeg,multi-stage-build"}
{"id":"mem-987d8cecd7ef8737","information":"Implemented IValidateOptions pattern for configuration validation in Yallarhorn. AppOptionsValidator class validates all configuration sections at startup: Database (DataSource required, ConnectionTimeout > 0, valid JournalMode/Synchronous modes), Scheduler (valid cron expression via NCrontab, valid TimeZoneId, numeric constraints), YtDl (required BinaryPath/MediaStoragePath/ArchiveDirectory, format enums, timeouts), App (required Name, valid BaseUrl URI, rolling counts). Uses Microsoft.Extensions.Options.IValidateOptions<T> pattern with ValidateOnStart(). Build succeeded.","created_at":"2026-02-24T06:23:08.692Z","tags":"[\"configuration\",\"validation\",\"IValidateOptions\",\"AppOptions\",\".NET\"]"}
{"id":"mem-98bfe7c58898177c","information":"Added DbSet&lt;Playlist&gt; Playlists and DbSet&lt;PlaylistItem&gt; PlaylistItems to ApplicationDbContext following the existing pattern of other DbSet declarations. Build verified successfully.","created_at":"2026-02-23T08:47:49.613Z","tags":"ApplicationDbContext,DbSet,Playlist,PlaylistItem,EntityFramework"}
{"id":"mem-9a56d60e36a03af6","information":"Skaldforge configuration classes created in src/Skaldforge.Core/Configuration/ with nullable reference types, XML documentation, and sensible defaults. Uses central package management (Directory.Packages.props). Projects require GenerateDocumentationFile=true in project file to enable IDE0005 enforcement. The existing AudioFormat enum in Models/AudioSettings.cs differs from AudioOutputFormat in Configuration/AudioConfig.cs - both serve different purposes.","created_at":"2026-02-19T10:39:23.596Z","tags":"skaldforge,configuration,csharp,dotnet"}
{"id":"mem-9b02b0358c74612a","information":"FFmpeg concat demuxer requires specific file format: each line must be `file '/path/to/audio.wav'` with single quotes around the path. If paths contain single quotes (e.g., \"O'Brien's Chapter.wav\"), they must be escaped as `'\\''` (end quote, escaped literal quote, start quote). In Skaldforge, there were two code paths generating concat files - one had escaping (WriteConcatFileAsync) and one didn't (ExportAsync). Always check ALL code paths when fixing escaping bugs.","created_at":"2026-02-21T10:42:04.992Z","tags":"ffmpeg,concat,escaping,bug-fix"}
{"id":"mem-9b178f14cedbdeb2","information":"Flutter calendar GridView dynamic height: Use `shrinkWrap: true` on GridView.builder to make it size to content. Calculate rows dynamically with `((firstDayOffset + daysInMonth - 1) ~/ 7) + 1`. Some months need 4 rows (Feb starting Sunday), others need 5 or 6. May 2026 is a 6-row month (31 days starting Friday).","created_at":"2026-02-22T23:12:53.172Z","tags":"flutter,calendar,gridview,dynamic-height"}
{"id":"mem-9bb74f801dfb47fc","information":"ASP.NET Core controller pagination pattern: Use PaginationQuery class with default values (page=1, limit=50, max=100). Use PaginatedResponse<T>.Create() to build response with HATEOAS links. For filtering, build Expression<Func<T, bool>> predicates dynamically and pass to repository's GetPagedAsync(). Use IChannelRepository.GetPagedAsync() for pagination with ordering.","created_at":"2026-02-25T22:46:43.411Z","tags":"aspnet-core,pagination,controller,api,c#,hateoas"}
{"id":"mem-9c84124a262d7708","information":"SoundFlowStitcher WAV loading debug logging: Added comprehensive debug logging to diagnose StreamDataProvider creation failures. Key logging points: (1) LoadAudioProviderAsync logs file path, size, stream position/length, engine state; (2) LogWavHeader manually parses WAV header to log sample rate, channels, bits per sample, format validation; (3) StitchChapterInternalAsync logs each segment being processed with metadata; (4) ConcatenateProvidersAsync logs provider count and sample reads; (5) ReadAllSamples logs sample count and early termination detection; (6) WriteAudioAsync logs encoding progress. The null check for _engine was added to prevent CS8604 compiler warning.","created_at":"2026-02-22T02:38:31.025Z","tags":"soundflow,debug-logging,wav-loading,audio-stitching,diagnostics"}
{"id":"mem-9cae5d464acd42db","information":"Implemented auto-mark video as watched at 10% threshold in Flutter provider. Added _watchedMarked flag to prevent duplicate calls, checks for short videos (<10s), already watched videos, and handles network failures gracefully by resetting flag on error. Uses 90% progress threshold (within 10% of end) and calls _apiClient.markVideoWatched() asynchronously.","created_at":"2026-02-23T08:14:32.563Z","tags":"flutter,video-player,auto-mark-watched,feature-implementation"}
{"id":"mem-9cd695dc211eaafb","information":"Bug fix in Harmony-2.0: Thread.Sleep(600) was sleeping 600ms instead of 5 minutes. Changed to Thread.Sleep(TimeSpan.FromMinutes(5)) to match the documented behavior in the HelpText \"5 minute sleep between each run\". When using Thread.Sleep with int parameter, it's milliseconds - use TimeSpan for clarity with longer durations.","created_at":"2026-02-21T23:54:28.607Z","tags":"bug,Thread.Sleep,C#,time-units,Harmony"}
{"id":"mem-9d43406f9534a9af","information":"ASP.NET Core Basic Auth Implementation Pattern: Create AuthenticationHandler<Options> with HandleAuthenticateAsync, HandleChallengeAsync. Use CryptographicOperations.FixedTimeEquals for timing-safe comparison. Support WWW-Authenticate header with realm for proper 401 challenge. Detect BCrypt format for auto-switching between hashed and plaintext passwords.","created_at":"2026-02-26T03:01:17.257Z","tags":"csharp,aspnet-core,authentication,basic-auth,security"}
{"id":"mem-9e48d4a27518b294","information":"## Skaldforge Project Architecture\n\n**What:** This is a .NET 8.0 C# audiobook production platform, NOT a Node.js project. There is no package.json - use Directory.Build.props and Directory.Packages.props for build configuration.\n\n**Key Architecture:**\n- 6-project solution: Core (models/interfaces), Cli (Spectre.Console), Ai (Ollama), Tts (Kokoro), Audio (FFmpeg), Tests\n- Core defines all interfaces: IStoryParser, ICharacterAnalyzer, IVoiceMapper, ITtsEngine, IAudioStitcher\n- Domain models: Manuscript → Chapter → Scene → DialogueLine with Character voice assignments\n- SynthesisJob tracks audio generation pipeline progress\n- Configuration in Skaldforge.Core/Configuration/ with default values\n\n**Development Status (as of Feb 2026):**\n- Milestone 1 ~60% complete: models/interfaces done, implementations NOT done\n- CLI is a placeholder \"Hello World\", needs command implementations\n- TTS/AI/Audio projects have no implementations, just Class1.cs placeholder\n- Tests project has only empty test file\n\n**Important Files:**\n- schemas/manuscript.schema.json - JSON schema for manuscripts\n- samples/sample-manuscript.json - Example manuscript\n- docs/TODO.md - Detailed progress tracking (467 lines of tasks)","created_at":"2026-02-19T18:22:45.236Z","tags":"dotnet,csharp,architecture,skaldforge,project-structure"}
{"id":"mem-9eaa01e06891c5e2","information":"ASP.NET Core BasicAuthHandler implementation:\n- Extend AuthenticationHandler<BasicAuthOptions> where BasicAuthOptions extends AuthenticationSchemeOptions\n- Use Task.FromResult for synchronous AuthenticateResult returns (no async)\n- Use CryptographicOperations.FixedTimeEquals for constant-time credential comparison to prevent timing attacks\n- HandleChallengeAsync sets WWW-Authenticate header with realm\n- Parse Basic auth: Base64 decode \"username:password\" after stripping \"Basic \" prefix\n- Handle colon-in-password by splitting only on first colon (IndexOf + Substring)\n- Return AuthenticateResult.NoResult() for missing/wrong-scheme headers, Fail() for invalid credentials\n- Test handler directly with Moq for IOptionsMonitor<BasicAuthOptions> and InitializeAsync(scheme, context)","created_at":"2026-02-26T02:49:24.562Z","tags":"aspnetcore,authentication,basicauth,security,testing,pattern"}
{"id":"mem-9f31162d605ffae3","information":"BCrypt password validation in ASP.NET Core: Use BCrypt.Net-Next package (v4.0.3). BCrypt hashes are 60 chars and start with $2a$, $2b$, or $2y$. Use BCrypt.Net.BCrypt.Verify(password, hash) for validation. For plaintext comparison (env var substitution), use CryptographicOperations.FixedTimeEquals() from System.Security.Cryptography to prevent timing attacks. Auto-detection: check IsBCryptHash() before choosing validation method.","created_at":"2026-02-26T02:53:31.978Z","tags":"authentication,bcrypt,security,timing-attacks,aspnet-core,password-validation"}
{"id":"mem-9f552334f707d7c3","information":"Program.cs modernization: Applied naming convention fixes (camelCase to PascalCase for Options class properties), fixed redundant ToString() call, used object initializer for CsvConfiguration, fixed redundant null assignment, fixed doc typo (MP3 to M4B). Top-level statements deferred as it requires moving Options class to separate file or making it file-scoped. Async Main and modern CLI patterns deferred. LoopMode implementation bug noted (Thread.Sleep(600) is 0.6 seconds not 5 minutes).","created_at":"2026-02-21T22:36:56.897Z","tags":".NET modernization,Program.cs,naming conventions,C# style"}
{"id":"mem-9fadbaaccb13df13","information":"Yallarhorn Worker Constructor Signatures (Feb 2026):\n- RefreshWorker(IServiceScopeFactory, ILogger<RefreshWorker>, TimeSpan?)\n- DownloadWorker(IServiceScopeFactory, IDownloadCoordinator, ILogger<DownloadWorker>, TimeSpan?)\n\nTests were using old signatures with wrong types/argument orders. Both workers require IServiceScopeFactory for DI, NOT the service interfaces directly. DownloadWorker requires IDownloadCoordinator (not IDownloadPipeline or IDownloadQueueService).","created_at":"2026-02-26T20:54:39.246Z","tags":"yallarhorn,dotnet,constructor,worker,background-service,testing"}
{"id":"mem-a0a337a8fe939e5b","information":"P7-005 Server Startup Tests: ASP.NET Core 10.0 with OpenAPI requires InterceptorsNamespaces setting in test project csproj: <InterceptorsNamespaces>$(InterceptorsNamespaces);Microsoft.AspNetCore.OpenApi.Generated</InterceptorsNamespaces>. Integration tests for server startup should use TestServer pattern with HostBuilder, configure all services including mocked external dependencies (IYtDlpClient, IFfmpegClient, IDownloadCoordinator), and use endpoints.MapHealthChecks/MapControllers/MapGet for routing. Health endpoint returns \"Healthy\" (uppercase) and text/plain content type by default. Service registration tests should verify scoped vs singleton lifetimes using multiple scopes. Database initialization should use EnsureCreatedAsync in test setup with SQLite in-memory temporary files.","created_at":"2026-02-26T04:20:03.834Z","tags":"aspnet-core integration-test server-startup openapi-interceptors testserver health-checks service-registration dotnet-10"}
{"id":"mem-a1fba04dca6b7167","information":"Yallarhorn DI Registration Pattern: ServiceCollectionExtensions.AddYallarhornCoreServices registers all services using scopes: Repository interfaces (IChannelRepository, IEpisodeRepository, IDownloadQueueRepository) are Scoped; singleton clients (IYtDlpClient, IFfmpegClient, IDownloadCoordinator, IPipelineMetrics, IFileService, IRssFeedBuilder, IAtomFeedBuilder, IFeedCache, IStorageService) are Singleton; services with DbContext dependencies (ITranscodeService, IChannelRefreshService, IDownloadQueueService, IDownloadPipeline, IEpisodeCleanupService, IFeedService, ICombinedFeedService) are Scoped. SQLite connection string built from DatabaseOptions.Path. Note: AddDatabaseDeveloperPageExceptionFilter requires Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore package not included by default.","created_at":"2026-02-26T01:26:58.227Z","tags":"yallarhorn,dependency-injection,service-registration,scoped,singleton"}
{"id":"mem-a29869846d517795","information":"Calendar month view widget location in sancta_via monorepo: sancta_via_liturgical_calendar_app/lib/screens/calendar/calendar_screen.dart. Uses GridView.builder with fixed height (300px) and itemCount (42 cells = 6 rows). _buildCalendarGrid() method at lines 128-237, _buildCalendarDay() at lines 239-308. Providers in calendar_providers.dart. For dynamic row modification, need to calculate row count based on firstDayOffset and daysInMonth, then adjust height proportionally.","created_at":"2026-02-22T21:22:53.756Z","tags":"flutter,calendar,widget,path-discovery"}
{"id":"mem-a2ec7f1e6e619249","information":"Code review synthesis: SWARM_CODE_REVIEW.md created consolidating 28 findings (1 critical, 12 high, 12 medium, 3 low) from 6 worker agents. Key issues: mutable StateNotifier (critical), HTTP URLs exposing API keys, memory leaks in Flutter providers, BCrypt verification on every request, non-generic PagedResult. Report organized by severity with actionable recommendations and prioritized remediation roadmap.","created_at":"2026-02-17T03:19:20.958Z","tags":"code-review,synthesis,swarm-findings,architecture,security,performance"}
{"id":"mem-a43963be8b3b9469","information":"Added 'Add to playlist' to video context menu in Flutter/Odeon. Created VideoContextMenu widget with playlist selector dialog, added onAddToPlaylist callback to VideoCard, and integrated with EpisodesScreen. Uses PlaylistsNotifier.addItem() to add videos to playlists via API.","created_at":"2026-02-23T20:34:54.191Z","tags":"flutter,playlist,context-menu,video"}
{"id":"mem-a4dbd4ef3c878b44","information":"Async/await migration pattern for .NET console apps with FFmpeg:\n- Strategy: Minimal async - internal async methods with sync entry point (.GetAwaiter().GetResult())\n- FFmpeg: Xabe.FFmpeg IConversion.Start() returns Task<bool> - use await instead of .Wait()\n- FFProbeAnalyzer: Already_async - just needs callers to await\n- Tests: xUnit async Task test methods - do NOT use ConfigureAwait(false) in tests (xUnit1030 warning)\n- GetAaxInfo/GetAaxcInfo: Keep sync - Process.WaitForExit() is synchronous\n- TagLib: Keep sync - no async APIs available\n- Thread.Sleep bug found: 600ms was supposed to be 5 minutes - fixed to TimeSpan.FromMinutes(5)","created_at":"2026-02-22T23:44:23.036Z","tags":"async,await,C#,.NET,FFmpeg,Xabe.FFmpeg,xUnit,migration"}
{"id":"mem-a565de2a65c09f8b","information":"Added feed discovery index endpoint to API spec - GET /feeds/index that returns all available RSS feeds (individual channel feeds + video-firehose + audio-firehose) with metadata for podcast client discovery. Includes filter by type (channel, video-firehose, audio-firehose, all) and includeDisabled query parameters.","created_at":"2026-02-24T02:59:18.264Z","tags":"api,feed-discovery,rss,podcast,endpoint"}
{"id":"mem-a69d119c322f326f","information":"Architecture Patterns for Sancta Via Monorepo:\n\n1. REPOSITORY PATTERN: Singleton with optional DI for testing, built-in nullable caching fields, migration awareness, safe defaults on error. File: sancta_via_prayer_companion/lib/repositories/prayer_repository.dart\n\n2. RIVERPOD PROVIDERS: Layered architecture - Provider for simple state, FutureProvider for async data, FutureProvider.family for parameterized queries, StateNotifierProvider for mutable state with persistence. File: sancta_via_prayer_companion/lib/providers/prayer_providers.dart\n\n3. SETTINGS ARCHITECTURE: Composition pattern - BaseSettingsModel (shared_ui) contains common settings, app-specific settings wrap it, sync mechanism via _ref.listen(). Files: sancta_via_shared_ui/lib/src/models/base_settings_model.dart, sancta_via_shared_ui/lib/src/providers/base_settings_provider.dart\n\n4. NAVIGATION: GoRouter with named routes, path parameters, centralized error handling. File: sancta_via_prayer_companion/lib/config/routes.dart\n\n5. LITURGICAL THEMING: Dynamic theming via currentLiturgicalColorProvider, ColorIntensity enum (vibrant/muted), Material 3 ColorScheme.fromSeed(). Files: sancta_via_shared_ui/lib/src/config/app_theme.dart, sancta_via_prayer_companion/lib/main.dart\n\n6. TESTING: Mockito @GenerateMocks annotation, DI in setUp(), mirror lib/ structure in test/. File: sancta_via_prayer_companion/test/repositories/prayer_repository_test.dart\n\nWHY: These patterns ensure consistency across 5 apps in the monorepo, enabling code reuse via shared packages and reducing cognitive load for developers.","created_at":"2026-02-24T09:46:42.511Z","tags":"architecture,patterns,repository,riverpod,settings,navigation,theming,testing"}
{"id":"mem-a8d5196e8ac5df35","information":"C# async migration pattern: Replace .Wait() with await, .Result with await, add using System.Threading.Tasks, change void methods to Task, return Task<T> for methods returning values, use ConfigureAwait(false) for library calls. Keep sync methods that use sync-only APIs (like TagLib, Process.WaitForExit). Update callers to use .GetAwaiter().GetResult() or make async.","created_at":"2026-02-22T23:07:21.288Z","tags":"csharp async migration configureawait task"}
{"id":"mem-a90ba74991817694","information":"**yt-dlp C# Process Client Implementation**\n\nSuccessfully implemented YtDlpClient with these key patterns:\n\n1. **Process Execution Pattern**: Use `ProcessStartInfo` with `RedirectStandardOutput`, `RedirectStandardError`, `UseShellExecute=false`, `CreateNoWindow=true` for headless process execution.\n\n2. **Stream Reading Gotcha**: Cannot have two tasks reading from the same stream concurrently. If progress monitoring is needed, combine the error stream reading with progress parsing in a single task using `ReadStreamWithProgressAsync`.\n\n3. **Record vs Class for Progress**: DownloadProgress must be a `record` (not `class`) to use `with` expression syntax for immutable updates. The error `CS8858` indicates this issue.\n\n4. **JSON Parsing**: yt-dlp returns NDJSON (newline-delimited JSON) for flat playlists. Use `Split('\\n')` and parse each line separately.\n\n5. **Progress Regex Patterns**:\n   - Percentage: `(\\d+\\.?\\d*)%`\n   - Speed: `at\\s+([\\d.]+[KMGT]?i?B/s)`\n   - ETA: `ETA\\s+(\\d+:\\d+(?::\\d+)?)`\n\n6. **Timeout Handling**: Use `CancellationTokenSource.CreateLinkedTokenSource` with a timeout to handle both user cancellation and process timeout.\n\n7. **Test Design**: If yt-dlp is installed in the test environment, invalid URLs may return empty results instead of throwing. Design tests to accept either outcome.","created_at":"2026-02-25T05:53:13.159Z","tags":"c-sharp,process-execution,yt-dlp,json-parsing,stream-handling,tdd"}
{"id":"mem-af622f0c9a041837","information":"**.NET Target Framework Selection Gotcha:** When setting TargetFramework in .csproj files, check what runtimes are available on the target machine. A build may succeed even if the runtime isn't installed, but tests will fail at execution time. Also discovered that projects using Directory.Build.props for central configuration may need scope clarification - the TargetFramework can be set either centrally (preferred) or in individual project files (override pattern).","created_at":"2026-02-19T21:45:30.166Z","tags":"dotnet,target-framework,csproj,directory.build.props"}
{"id":"mem-afdbe45e1e3a11f4","information":"yt-dlp can extract YouTube metadata without API keys using --print-json --no-download. Output template includes video_id, title, description, duration, thumbnail, channel info. Use --flat-playlist for channel episode discovery. FFmpeg transcoding for podcasts: audio uses libmp3lame (MP3) or aac (M4A), video uses libx264 with CRF 23 (medium quality). Always use -movflags +faststart for streaming-ready MP4 files. CPU-only H.264 encoding with libx264 preset \"medium\" provides good balance of speed and quality for podcast workflows.","created_at":"2026-02-24T09:46:50.138Z","tags":"yt-dlp,ffmpeg,transcoding,youtube,download-pipeline,h264,podcast"}
{"id":"mem-b4ff88c3186a1f6c","information":"## FFmpeg Temp File Race Condition Bug\n\n**Root Cause:** Silence cache returns cached file paths that are then added to tempFiles and deleted by the finally block, causing stale cache entries.\n\n**Bug Pattern:**\n1. Job A calls GenerateSilenceAsync(500ms) → creates `stitch_RANDOM1.wav`, caches it\n2. Job A's tempFiles list includes this silence path\n3. Job A finishes → finally block CLEANUP DELETES the silence file\n4. Job B calls GenerateSilenceAsync(500ms) → returns CACHED path that doesn't exist\n5. FFmpeg tries to find the file → ERROR \"Could not find file\"\n\n**Fix:** Silence files should NOT be added to tempFiles cleanup list since they're cached for reuse across jobs. They are cleaned separately in Dispose() via _silenceCache cleanup.\n\n**Code pattern to AVOID:**\n```csharp\nvar silencePath = await GenerateSilenceAsync(...);\ntempFiles.Add(silencePath); // BUG - will delete cached file!\n```\n\n**Code pattern to USE:**\n```csharp\nvar silencePath = await GenerateSilenceAsync(...);\n// Don't add to tempFiles - silence files are cached for reuse\nfilesToProcess.Add(silencePath);\n```","created_at":"2026-02-21T21:55:49.568Z","tags":"ffmpeg,bug,race-condition,temp-files,silence-cache,debugging"}
{"id":"mem-b4ffe72ba5a5adf4","information":"Flutter Riverpod Architecture Review Findings (Odeon):\n1. CRITICAL: ApiClientNotifier wraps mutable ApiClient - state changes don't trigger notifications\n2. HIGH: VideosNotifier Timer not disposed - memory leak\n3. HIGH: _GoRouterRefreshNotifier ProviderSubscription not disposed\n4. HIGH: Video URL auth - getVideoFileUrl lacks API key for media_kit requests\n5. MEDIUM: Duplicate _StatusChip widget in video_card and video_detail_screen\n6. MEDIUM: TextField suffixIcon doesn't rebuild dynamically in episodes_screen\n7. Silent failures in _pollDownloadProgress catch block\n8. GOOD: Folder structure is excellent - clear separation of concerns\n9. GOOD: StateNotifier pattern used consistently across providers\n10. GOOD: const usage is well-applied in widgets and state classes","created_at":"2026-02-17T03:13:35.946Z","tags":"flutter riverpod architecture review odeon frontend"}
{"id":"mem-b5773203e6688a95","information":"Flutter novena_companion app code review findings: 1) Legacy monolithic files should be removed (novena_settings_screen_old_monolithic.dart, novena_app_settings_provider_old_complex.dart). 2) Excessive debug logging should be wrapped in kDebugMode checks. 3) SQL search query in NovenaDatabaseService.searchNovenas is vulnerable to injection - should use parameterized queries. 4) Test coverage is minimal - only 3 test files, no repository/provider/widget tests. 5) AuthService has potential race condition with _isAuthenticated mutable state. 6) active_novena_dashboard uses WidgetsBinding.instance.addPostFrameCallback for navigation - should use ref.listen instead. 7) Models lack const constructors and copyWith methods for efficient state updates. 8) No accessibility semantics labels in any widgets. 9) Hardcoded strings throughout - needs localization. 10) Settings migration happens on every load - should only migrate once.","created_at":"2026-02-22T23:41:20.746Z","tags":"flutter,code-review,novena,architecture,performance,testing,accessibility"}
{"id":"mem-b72e66604d33c698","information":"Prayer JSON files in sancta_via_prayer_companion use a specific format with fields: id, title, text, attribution, notes, categories, description, tags, isLiturgical, liturgicalPriority, liturgicalSeason, timeOfDay. Optional fields include translation (with latin subkey). The prayers_metadata.json is the index file that must be updated when adding new prayers. Categories include: essential, morning, evening, mass, marian, saints, confession, litany. The categoryGroups define display groupings.","created_at":"2026-02-22T02:51:24.794Z","tags":"prayer,json,data-model,flutter,format"}
{"id":"mem-b859f9cf1f1cb83b","information":"FFmpeg 3-track audio mixing pattern: Use amix filter with volume controls: `-filter_complex \"[0:a]volume={vol1}[n];[1:a]volume={vol2}[s];[2:a]volume={vol3}[m];[n][s][m]amix=inputs=3:duration=longest[aout]\"`. Volume values should be formatted with F2 and InvariantCulture for consistent decimal formatting. The amix filter automatically handles different track lengths with `duration=longest`.","created_at":"2026-02-26T09:47:50.474Z","tags":"ffmpeg,audio-mixing,amix,csharp"}
{"id":"mem-b89a25c48ddedf84","information":"ASP.NET Core GET by ID endpoint pattern: Use [HttpGet(\"{id}\")] attribute with [ProducesResponseType(typeof(ResponseType), StatusCodes.Status200OK)] and [ProducesResponseType(StatusCodes.Status404NotFound)]. Query repository GetByIdAsync, return NotFound() if null, return Ok(response) with mapped DTO. Use existing MapToResponse helper to ensure consistent HATEOAS links across list and single-item endpoints.","created_at":"2026-02-25T23:56:33.733Z","tags":"aspnet-core,api,controller,get-by-id,tdd"}
{"id":"mem-b95f5a9b47378558","information":"Created AppOptions configuration classes using IOptions pattern in src/Yallarhorn/Configuration/ folder:\n- DatabaseOptions.cs: SQLite settings (DataSource, JournalMode, Synchronous, CacheSize, PageSize)\n- SchedulerOptions.cs: Cron scheduling (DefaultCronExpression, MaxConcurrentJobs, TimeZoneId, retry settings)\n- YtDlOptions.cs: yt-dlp media download settings (BinaryPath, format options, media storage, retries, FFmpeg path)\n- AppOptions.cs: Root aggregation class with Database, Scheduler, YtDl, App sub-sections\n- Updated appsettings.json with Yallarhorn configuration section\n- Added Microsoft.Extensions.Options packages to csproj\n- Build verified successful","created_at":"2026-02-24T05:05:35.008Z","tags":"[\"configuration\",\"IOptions\",\"AppOptions\",\"database\",\"scheduler\",\"yt-dlp\"]"}
{"id":"mem-ba68d44e76d4a233","information":"Yallarhorn API design: Use HTTP Basic Auth for management API (configured via admin_auth in YAML). All endpoints require authentication except /api/v1/health. Refresh operations are async (return 202 Accepted). Channels cascade delete to episodes. Episode status values: pending, downloading, processing, completed, failed, deleted. Queue status: pending, in_progress, completed, failed, cancelled.","created_at":"2026-02-24T08:55:31.057Z","tags":"yallarhorn,api,authentication,design-patterns"}
{"id":"mem-ba993eee2cee2482","information":"Spectre.Console markup escaping: When using AnsiConsole.MarkupLine() or ctx.AddTask() with interpolated strings, dynamic text containing square brackets (e.g., \"[concat]\" from FFmpeg output) will be interpreted as markup tags, causing \"Could not find color or style 'concat'\" errors. Solution: Wrap ALL dynamic values with Markup.Escape() or manually replace \"[\" with \"[[\" and \"]\" with \"]]\". Key locations to check: task descriptions updated after creation, error messages, progress stages.","created_at":"2026-02-21T10:32:03.377Z","tags":"spectre-console,bug-fix,markup-escaping,csharp"}
{"id":"mem-bac22b70d8143ea8","information":"Yallarhorn configuration schema: Uses single YAML file with 3 main sections: (1) Global settings - poll_interval, max_concurrent_downloads, transcode_settings, server, database, logging; (2) Auth - api_credentials (api_key or OAuth2) and feed_credentials for HTTP Basic Auth; (3) Channels list with name, url, episode_count, enabled, feed_type, custom_settings. Supports environment variable substitution with ${VAR} syntax. Validation enforces required fields, type checking, enum values for feed_type (audio/video/both), audio_format, and URL format validation for YouTube channel URLs only.","created_at":"2026-02-24T08:40:53.076Z","tags":"yallarhorn,configuration,yaml,schema,validation"}
{"id":"mem-bace3882af68ceee","information":"Catholic Prayer App Gap Analysis: App has 67 prayers but missing key categories:\n- ZERO litanies (Litany of Loreto, Sacred Heart, St. Joseph, Holy Spirit)\n- Missing Kyrie (basic penitential Mass prayer)\n- Missing 2 Marian antiphons (Alma Redemptoris Mater for Advent/Christmas, Ave Regina Caelorum for Lent)\n- Missing sacramental preparation prayers (before Confession, before/after Communion)\n- Missing Pentecost sequence (Veni Sancte Spiritus)\n\n40 prayers recommended for addition across litanies, liturgical, Marian, devotional, and seasonal categories.","created_at":"2026-02-22T02:28:19.617Z","tags":"catholic-prayers,gap-analysis,content-addition,sancta-via"}
{"id":"mem-bc6ffced1667413f","information":".NET yt-dlp download options implementation: Use DownloadOptionsDto with Quality enum (Best/P1080/P720/P480) and DownloadFormat enum (Video/AudioOnly). Build format strings dynamically: Best uses \"bv*[vcodec*=avc1]+ba[acodec*=mp4a]/bv*[vcodec*=avc1]+ba/b[ext=mp4]/bv*+ba/best\", quality-limited uses height constraints like \"bestvideo[height<=1080]+bestaudio/best[height<=1080]\". Audio-only uses \"-x --audio-format mp3 --audio-quality 0\" flags instead of format string. Store options as int in EF Core entity for compatibility with enum values.","created_at":"2026-02-20T19:51:14.632Z","tags":".NET,yt-dlp,download-options,quality-selection,format-selection"}
{"id":"mem-bda38a3a04aec3ae","information":"CharacterAnalyzer minimal orchestration pattern: ExtractDialogueText from scenes → CharacterExtractionPrompt.CreateUserPrompt → OllamaRequest with Temperature 0.3 → CharacterParser.Parse → List<Character>. Use IOllamaClient interface. CharacterParser has Parse method returning (List<Character>, List<string> errors) tuple.","created_at":"2026-02-20T01:05:06.804Z","tags":"csharp,ai,character-extraction,ollama,pipeline"}
{"id":"mem-bef9b781aa6cb48d","information":"Fixed WAV loading bug in SoundFlowStitcher by implementing manual WAV parsing. The root cause: SoundFlow's WavReader.ReadAsync fails when WAV files have LIST chunks before the data chunk (common in Kokoro TTS output), causing DataSize=0xFFFFFFFF (-1 as signed int) which leads to negative stream position calculations. SOLUTION: Replace StreamDataProvider(ReadOptions) with manual WAV loading: parse WAV header manually using BinaryReader, find 'data' chunk, read actual data size (handle 0/0xFFFFFFFF as \"read to EOF\"), convert 16-bit PCM samples to float array, and create RawDataProvider with correct AudioFormat from parsed header. Supports 8/16/24/32-bit PCM formats.","created_at":"2026-02-22T02:47:59.458Z","tags":"skaldforge,wav,soundflow,audio,bugfix,kokoro-tts"}
{"id":"mem-bf073bacaff52b53","information":"Dockerfile pattern for .NET 10 application with media processing: Use multi-stage build with mcr.microsoft.com/dotnet/sdk:10.0 for build and mcr.microsoft.com/dotnet/aspnet:10.0 for runtime. Install yt-dlp and ffmpeg via apt-get in runtime stage to keep image size small. Use --no-install-recommends and clean apt cache. Set ASPNETCORE_URLS=http://+:5001 for port configuration.","created_at":"2026-02-26T08:54:26.639Z","tags":"docker,.NET 10,yt-dlp,ffmpeg,multi-stage-build"}
{"id":"mem-bf9998eab37b46d7","information":"Yallarhorn uses a generic repository pattern where DeleteAsync takes the entity object, not the entity ID. When implementing deletion, first retrieve the entity with GetByIdAsync, then pass the entity to DeleteAsync. This is consistent across all repositories (IEpisodeRepository, IDownloadQueueRepository, etc.).","created_at":"2026-02-26T00:03:44.663Z","tags":"yallarhorn,repository-pattern,EntityFramework,dotnet,deletion"}
{"id":"mem-c033e59f1d62394d","information":"Created 3 Marian novenas for sancta_via_novena_companion app with exact data model match: Our Lady of Lourdes (healing), Our Lady of Fatima (peace), Immaculate Conception (purity). Each has 9 complete daily prayers with all required fields: opening_prayer, daily_prayer, closing_prayer, reflection, intention_prayer, scripture. Novenas auto-discovered from assets/novenas/ via AssetManifest at runtime.","created_at":"2026-02-22T04:19:18.818Z","tags":"novena,marian,flutter,json,data-model"}
{"id":"mem-c07313d742dcea21","information":"## Flutter Monorepo Build Errors - 2026-02-21\n\n### AppLogger Import Conflict (3 apps affected: bible_reading_app, confession_companion, novena_companion)\n\n**Root Cause:** Each app has its own `utils/logger.dart` that exports `AppLogger` class, AND they also depend on `sancta_via_shared_ui` which exports its own `AppLogger` from `package:sancta_via_shared_ui/src/utils/app_logger.dart`.\n\n**Error Pattern:**\n```\nlib/main.dart:51:7: Error: 'AppLogger' is imported from both 'package:bible_reading_app/utils/logger.dart' and 'package:sancta_via_shared_ui/src/utils/app_logger.dart'.\n```\n\n**Fix:** Either:\n1. Remove local `utils/logger.dart` from each app and use the shared one from `sancta_via_shared_ui`\n2. Or use explicit import prefixes to disambiguate\n\n### material_color_utilities Dependency Conflict (liturgical_calendar_app)\n\n**Root Cause:** The app has `material_color_utilities: ^0.11.1` in pubspec.yaml but Flutter SDK requires exactly `0.13.0`.\n\n**Error:**\n```\nBecause liturgical_calendar_app depends on flutter from sdk which depends on material_color_utilities 0.13.0, material_color_utilities 0.13.0 is required.\nSo, because liturgical_calendar_app depends on material_color_utilities ^0.11.1, version solving failed.\n```\n\n**Fix:** Run `flutter pub add material_color_utilities:^0.13.0` or remove the explicit dependency\n\n### Successful Build (prayer_companion)\nBuilt successfully - 57.1MB APK, 46.9MB AAB, 20.5MB iOS app","created_at":"2026-02-21T05:05:23.814Z","tags":"flutter,build-error,monorepo,import-conflict,dependency-conflict"}
{"id":"mem-c0b1201c6511514a","information":"Bun test patterns: Use `import { test, expect, describe, beforeEach, afterEach } from 'bun:test'`. For route testing with Hono, use `app.request('/path')` to get Response objects. Empty query parameters fall back to defaults, so test with invalid values rather than empty strings. Type assertions needed when using response.json() to avoid 'unknown' type errors.","created_at":"2026-02-20T20:50:48.188Z","tags":"bun,testing,typescript,hono,patterns"}
{"id":"mem-c0c28338148196ae","information":"Spectre.Console markup escaping: When using AnsiConsole.MarkupLine, ctx.AddTask, or task.Description with interpolated strings containing dynamic data (user input, FFmpeg output, error messages, file paths, chapter titles), ALWAYS wrap dynamic values with Markup.Escape() or use .Replace(\"[\", \"[[\").Replace(\"]\", \"]]\"). \n\nCommon patterns that need escaping:\n- task.Description = $\"[color]{dynamicVar}[/]\" → task.Description = $\"[color]{Markup.Escape(dynamicVar)}[/]\"\n- ctx.AddTask($\"[color]text: {dynamicVar}[/]\") → ctx.AddTask($\"[color]text: {Markup.Escape(dynamicVar)}[/]\")\n\nFFmpeg output often contains \"[filter_name]\" or \"[stream]\" patterns that Spectre.Console interprets as markup tags, causing \"Could not find color or style 'filter_name'\" errors.","created_at":"2026-02-21T10:23:44.950Z","tags":"csharp,spectre-console,markup,escape,bug-fix"}
{"id":"mem-c0c32a57563ac7ed","information":"ManuscriptMerger pattern for combining LLM-generated manuscript chunks: Use Dictionary<string, string> for ID remapping (old->new), Dictionary<string, string>(StringComparer.OrdinalIgnoreCase) for case-insensitive name deduplication. Character merging: first occurrence wins, but merge null properties from later occurrences. Scene/chapter IDs should be regenerated sequentially (char_001, scene_001, chapter_001 format). Dialogue SpeakerId references must be remapped using the character ID map.","created_at":"2026-02-20T08:25:46.717Z","tags":"c#,merger,chunking,manuscript,deduplication,id-remapping"}
{"id":"mem-c1abf3dcf0ec6280","information":"Hono app with Bun uses `export default { port, fetch: app.fetch }` pattern instead of Bun.serve(). Middleware is added via app.use('*', middleware()). Routes are mounted with app.route('/path', router). 404 handler via app.notFound(), errors via app.onError().","created_at":"2026-02-20T20:45:24.621Z","tags":"hono,bun,server,middleware,pattern"}
{"id":"mem-c1d9997d3d1b67cc","information":"Pagination bounds validation added to VideosController.cs to prevent DoS attacks. Added MaxPageSize constant (100) and clamp limit to [1, MaxPageSize] and offset to [0, int.Max]. Pattern: Math.Clamp(limit, 1, MaxPageSize) and Math.Max(0, offset) at start of controller method.","created_at":"2026-02-17T09:31:31.325Z","tags":"security,pagination,dos-prevention,validation"}
{"id":"mem-c2068ab26d7c2308","information":"Yallarhorn implementation task breakdown: 70 tasks across 8 phases totaling ~192 hours. Phase 1: Project setup (16h). Phase 2: Data layer & configuration (24h). Phase 3: Download pipeline - CRITICAL PATH (40h) with yt-dlp integration, FFmpeg transcoding, and background workers. Phase 4: Feed generation (20h) with RSS/Atom/iTunes support. Phase 5: API implementation (32h). Phase 6: Authentication (16h) with dual Basic Auth. Phase 7: Docker/deployment (20h). Phase 8: Testing/docs (24h). Critical path runs through download pipeline. Maximum parallelization with Track A (backend), Track B (infrastructure), Track C (documentation). Testing strategy: 80%+ unit test coverage, integration tests for key flows, E2E for critical paths.","created_at":"2026-02-24T14:07:36.761Z","tags":"yallarhorn,implementation,task-breakdown,phases,planning"}
{"id":"mem-c22a615909673ae4","information":"Added data annotations to C# entity classes in Odeon project: Use System.ComponentModel.DataAnnotations namespace. [Required] for non-nullable properties, [StringLength(200)] for name fields, [Url] for URL properties. Place annotations on separate lines above properties for readability.","created_at":"2026-02-18T02:34:21.363Z","tags":"csharp,data-annotations,validation,entity-framework"}
{"id":"mem-c2b51cfad005cfef","information":"Flutter ApiClient refactoring: When migrating from mutable fields (_baseUrl, _apiKey) to immutable ApiConfig, ensure ALL references to the old fields are updated. Two methods commonly missed: _buildUri() and getVideoFileUrl() which may use the internal field directly.","created_at":"2026-02-17T04:06:02.193Z","tags":"flutter,refactoring,api-client,immutable"}
{"id":"mem-c356f7bcd2d9d4af","information":"Yallarhorn server startup and endpoint testing: Fixed multiple issues including port 5000 conflict with macOS AirPlay, TranscodeService DI registration, background worker scoped service resolution, HTTPS redirection in dev, and SQLite DateTimeOffset ORDER BY compatibility. Server now starts successfully on port 5001 and all endpoints work correctly.","created_at":"2026-02-26T05:45:14.568Z","tags":"yallarhorn,server,endpoint-testing,sqlite,di,background-workers"}
{"id":"mem-c43477b693ff92d2","information":"Skaldforge configuration pattern: Config classes in Skaldforge.Core/Configuration/{Name}Config.cs follow a simple POCO pattern with XML doc comments and default values. SkaldforgeConfig aggregates all configs. Tests in tests/Skaldforge.Tests/ConfigurationTests.cs verify defaults match expected values.","created_at":"2026-02-21T04:54:37.965Z","tags":"skaldforge,configuration,patterns,testing"}
{"id":"mem-c4756163cf4dd8e4","information":"Yallarhorn database initialization tests: Use in-memory SQLite with connection kept open for EnsureCreated tests. File-based SQLite tests need proper disposal before file access checks. SchemaVersion table name is singular \"schema_version\" not \"schema_versions\". Use PRAGMA table_info() for column inspection, sqlite_master for table/index queries. EF Core model metadata available via context.Model.FindEntityType() for relationship verification.","created_at":"2026-02-26T04:29:14.938Z","tags":"ef-core,sqlite,integration-testing,database-initialization,yallarhorn"}
{"id":"mem-c481c7965561e415","information":"DownloadQueueService uses exponential backoff for retry scheduling: 0, 5min, 30min, 2hr, 8hr delays with max 5 attempts. Queue priority is 1-10 (lower = higher priority). State transitions: Pending→InProgress→Completed/Retrying→Failed. Only Pending and Retrying items can be cancelled.","created_at":"2026-02-25T06:15:32.814Z","tags":"download-queue,retry-backoff,service-pattern"}
{"id":"mem-c4844e59fc6cf7a9","information":"DomoGenerator successfully built and run for domo.json story. Generated 162 WAV files (128 TTS, 32 SFX, 2 music) across 19 scenes in 2 chapters. Services required: ChatterBox TTS (http://jason.lan:4123), TangoFlux SFX/Music. Runtime ~8-10 minutes for full generation. Output in output/domo/ with manifest.json containing segment metadata and durations.","created_at":"2026-02-26T02:03:49.850Z","tags":"DomoGenerator,audio-generation,TTS,SFX,ChatterBox,TangoFlux"}
{"id":"mem-c578d66e1c1cb8be","information":"Navigation Analysis: 5 Sancta Via apps all use GoRouter with flat routes, no ShellRoute. Key conflicts: all apps use / and /settings. Recommend StatefulShellRoute with namespaced routes (/prayer/*, /bible/*, /calendar/*, /confession/*, /novena/*). Novena companion has best pattern with RouteNames class and AppNavigation helper. Deep link schemes are unique per app (no conflicts).","created_at":"2026-02-24T20:15:13.177Z","tags":"navigation go_router architecture"}
{"id":"mem-c5e42652df16b60e","information":"Flutter GoRouter sub-routes for StatefulShellBranch: When adding sub-routes to a tab that uses StatefulShellBranch, the sub-routes must be nested inside the main GoRoute, not the StatefulShellBranch. The pattern is: StatefulShellBranch(routes: [GoRoute(path: '/tab', routes: [GoRoute(path: 'detail/:id', ...)])]). The sub-route path is relative to the parent (e.g., ':prayerId' becomes '/prayer/:prayerId' at runtime).","created_at":"2026-02-26T09:46:04.083Z","tags":"flutter,go_router,navigation,stateful_shell_branch"}
{"id":"mem-c6f55cf5fc45e073","information":"DomoGenerator pipeline requires valid JSON manuscript. Unescaped double quotes inside JSON string values cause parsing failures at line 221+ in domo.json. When regenerating audio, backup existing output/domo to output/domo_N format first. Pipeline generates TTS, SFX, and music audio files organized by chapter with a manifest.json for tracking segments.","created_at":"2026-02-26T03:36:45.858Z","tags":"DomoGenerator,audio,TTS,JSON,pipeline,backup"}
{"id":"mem-ca0a996f9fbeb6f8","information":"Skaldforge Runner Consolidation Analysis (Feb 2026):\n\nOVERLAP FOUND:\n- TestRunner is the most complete (1270 lines) - has TTS, stitching, music, export\n- DomoGenerator adds: SFX generation (TangoFlux), manifest output, mood/SFX inference\n- StitchRunner adds: 3-track mixing (Narration/SFX/Music), manifest input\n- MusicRunner adds: standalone music mode with custom prompts\n\nFEATURES TO MIGRATE TO TestRunner:\n1. SFX Generation - TangoFluxSfxGenerator, InferSfxFromSetting()\n2. 3-Track Mixing - StitchThreeTrackAsync() with volume control\n3. Manifest Support - Generate/read manifest.json for pipeline handoff\n4. Custom Music Prompt - --music-prompt override\n5. Mood Inference - InferMoodFromScene() logic\n6. Standalone Music Mode - Generate without manuscript\n\nPROPOSED CLI STRUCTURE:\nskaldforge <command> [options]\n- synthesize: TTS + voice mapping\n- sfx: Sound effect generation  \n- music: Background music (standalone or manuscript-scoped)\n- stitch: Audio stitching (single or 3-track)\n- export: M4B audiobook export\n- generate: Full pipeline (synth + sfx + music) [DomoGenerator replacement]\n\nRECOMMENDED APPROACH:\nUse Spectre.Console's command pattern (already in TestRunner). Add subcommands\nfor each operation mode. Keep TestRunner as the single entry point.","created_at":"2026-02-26T19:49:50.519Z","tags":"skaldforge,cli,consolidation,refactor,runners"}
{"id":"mem-cab19c01ad3a28fc","information":"ProseAnalysisPrompt class created for prose-to-Manuscript JSON conversion. Key patterns: (1) static string properties for SystemPrompt/JsonOutputFormat/ExampleOutput use raw string literals with triple quotes, (2) methods like CreateUserPrompt use StringBuilder pattern with $ interpolated strings and string concatenation, (3) validation methods use System.Text.Json.JsonDocument for parsing, (4) temperature 0.3 for deterministic extraction. JSON in interpolated strings causes CS9006 - use separate static properties instead.","created_at":"2026-02-20T03:21:15.338Z","tags":"csharp,prompt-templates,manuscript,json-schema,skaldforge"}
{"id":"mem-cb0e9d60b36392b4","information":"Skaldforge project enforces strict C# style rules: IDE0011 requires braces for ALL if/else statements (no single-line if statements). Kokoro TTS API base URL is configured via TtsConfig.BaseUrl (default: http://kokoro.lan/). Voice naming convention: {lang}{gender}_name (e.g., af_heart=American Female, bm_george=British Male). Sample rate is 24000Hz. The KokoroClient.cs implements IDisposable and wraps HttpClient with proper error handling.","created_at":"2026-02-21T05:01:53.767Z","tags":"skaldforge kokoro tts csharp style-rules httpclient"}
{"id":"mem-cc0a5c548e7381c0","information":"Created PlaylistsProvider using Riverpod StateNotifier pattern following existing provider patterns (ChannelsNotifier, VideosNotifier). Included methods: loadPlaylists(), getPlaylist(id), createPlaylist(name, description), updatePlaylist(), deletePlaylist(), addItem(), removeItem(). Handles loading/error states with PlaylistsState class. Uses ApiClient for backend communication. File: frontend/lib/providers/playlists_provider.dart","created_at":"2026-02-23T19:48:53.910Z","tags":"riverpod,provider,playlist,frontend,dart"}
{"id":"mem-ce507df9a899fea2","information":"Harmony 2.0 .NET Modernization Audit: Identified 3 critical bugs - Thread.Sleep(600) should be 5 minutes, malformed FFprobe command always returns true, and null dereference in GenerateCover. Codebase is well-structured but needs bug fixes before production. Newtonsoft.Json should be kept for AudibleVoucherDto due to JsonConvert consumer usage. Key patterns: System.Text.Json migration done for most DTOs, nullable reference types enabled, pattern matching (is null/is not null) used throughout.","created_at":"2026-02-21T22:50:00.653Z","tags":"dotnet audit harmony bugs modernization newtonsoft system.text.json"}
{"id":"mem-cee77e222a024304","information":"AAXtoM4BConvertor.cs modernization: Safe auto-fixes applied include: string interpolation ($\"\"), pattern matching (is not null instead of != null), var instead of explicit types for locals, string.Empty constant, null-coalescing for Path.GetDirectoryName. The file uses Xabe.FFmpeg library with .Wait() pattern for async operations - this is intentional for console apps. Multiple nullable reference warnings remain in AddMetadataToM4A method where aaxInfo?.format?.tags chain is dereferenced - these require careful null checks or guard clauses and should be reviewed manually.","created_at":"2026-02-21T22:44:46.828Z","tags":"csharp,modernization,nullable-reference-types,ffmpeg,audit"}
{"id":"mem-cfed4037c30a472f","information":"Program.cs refactoring: Extracted duplicate FFmpeg fetch logic into `FetchFFmpegAsync(Logger logger)` method using async/await pattern with Task.Delay instead of Thread.Sleep. HandleParseError implemented to log CLI errors to Console.Error and call Environment.Exit(1). The method is public static async Task for testability. Tests verify existence via reflection since methods involve external FFmpeg downloads and process exit.","created_at":"2026-02-22T02:36:49.104Z","tags":"csharp,refactoring,async,ffmepg,cli,testing"}
{"id":"mem-d0456b55a83742df","information":"**dotnet test failure pattern analysis for Yallarhorn:**\n\n17 of 30 test failures stem from controller/repository method mismatch:\n- EpisodesController tests mock IEpisodeRepository.GetPagedAsync() but controller calls FindAsync()\n- ChannelsController tests mock IChannelRepository.GetPagedAsync() but controller calls GetAllAsync()\n\nWhen tests return empty results ({empty}) or \"Sequence contains no elements\", check if the controller is calling a different repository method than what's being mocked. The Moq MockException shows actual invocations in the error output.\n\nFix approach: Either update controllers to use GetPagedAsync for pagination, or update tests to mock the correct method (FindAsync/GetAllAsync).","created_at":"2026-02-27T02:00:56.181Z","tags":"dotnet,testing,moq,repository-pattern,controller-tests"}
{"id":"mem-d0ae4f50cc35eed4","information":"AWESOMEASSERTIONS NAMESPACE GOTCHA: AwesomeAssertions package v8.0 maintains FluentAssertions API compatibility. The namespace is still `FluentAssertions`, NOT `AwesomeAssertions`. When migrating from FluentAssertions to AwesomeAssertions, keep `using FluentAssertions;` - only change the PackageReference name and version in Central Package Management.\n\n.NET TEST PROJECT SETUP: For NUnit + AwesomeAssertions setup:\n1. Packages needed: NUnit, NUnit3TestAdapter, NUnit.Analyzers, AwesomeAssertions, Microsoft.NET.Test.Sdk, coverlet.collector\n2. Using statements: `NUnit.Framework` and `FluentAssertions` (not AwesomeAssertions!)\n3. Use [Test] attribute (NUnit) not [Fact] (xUnit)\n4. For Central Package Management, define PackageVersion items matching PackageReference names","created_at":"2026-02-19T19:34:04.690Z","tags":".NET,NUnit,AwesomeAssertions,testing,gotcha,namespace"}
{"id":"mem-d24a9a0efd0e389b","information":"THEMING VERIFICATION COMPLETE: All 6 apps correctly wire shared theming:\n\n1. **Provider Source**: `currentLiturgicalColorProvider` from `sancta_via_liturgical_calendar_riverpod` returns liturgical color as string (GREEN, PURPLE, ROSE, WHITE, RED, GOLD).\n\n2. **Color Intensity**: `colorIntensityProvider` from `sancta_via_shared_ui` manages vibrant/muted preference with SharedPreferences persistence.\n\n3. **Theme Integration Pattern**: All apps follow the same pattern in main.dart:\n   - Watch `currentLiturgicalColorProvider` and `colorIntensityProvider`\n   - Convert string to `LiturgicalColor` enum via `LiturgicalColor.fromString()`\n   - Pass to `AppTheme.lightTheme(liturgicalColor, colorIntensity)` and `AppTheme.darkTheme()`\n\n4. **Extension Methods**: The `String.toLiturgicalColor(colorIntensity)` extension in `sancta_via_shared_ui` ensures consistent color values across all apps, respecting the intensity setting.\n\n5. **Apps Verified**:\n   - sancta_via_prayer_companion ✓\n   - sancta_via_bible_reading_app ✓\n   - sancta_via_novena_companion ✓\n   - sancta_via_confession_companion ✓\n   - sancta_via_liturgical_calendar_app ✓\n   - apps/sancta_via (combined app) ✓\n\n6. **Tests Pass**: All shared_ui tests (32 tests), riverpod tests (31 tests), combined app tests (3 tests), and prayer companion tests (69 tests) pass.","created_at":"2026-02-25T20:17:06.398Z","tags":"theming,verification,liturgical-colors,shared-ui,riverpod"}
{"id":"mem-d27218488cfee659","information":"SQLite with EF Core has a limitation: DateTimeOffset expressions cannot be used in ORDER BY clauses. This affects integration tests using in-memory SQLite databases. When creating integration tests for paginated endpoints that sort by DateTimeOffset fields, either use in-memory provider or real PostgreSQL/SQL Server. For Yallarhorn, tests that don't use pagination sorting work fine with SQLite.","created_at":"2026-02-26T04:02:55.743Z","tags":"testing,sqlite,ef-core,known-issue,integration-tests"}
{"id":"mem-d29a29f9f8a33031","information":"AudioPipeline orchestrator pattern for Manuscript → Audio conversion:\n- Uses ITtsEngine for synthesis and optional IVoiceMapper for AI voice assignment\n- Supports both pre-configured voice assignments (manual) and AI-assisted mapping\n- Implements IProgress<T> for progress reporting during long-running synthesis\n- Handles cancellation via CancellationToken\n- Splits long narration into chunks (500 chars) for better TTS synthesis\n- Creates chapter subdirectories for organized output\n- Tracks segments with full metadata (chapter, scene, character, line index)\n- Supports partial success via ContinueOnError option\n- Naming pattern supports {chapter}, {scene}, {type}, {index} placeholders","created_at":"2026-02-21T05:26:17.339Z","tags":"audio,pipeline,tts,synthesis,orchestration,progress-reporting,cancellation"}
{"id":"mem-d3b30c36d2042a94","information":"Yallarhorn uses ASP.NET Core 10.0 with health endpoints at /health, /health/live, /health/ready, and /health/simple. The Dockerfile requires curl for Docker health checks - must add curl to apt-get install in runtime stage. SQLite database is at ./data/yallarhorn.db. Config file is yallarhorn.yaml at project root.","created_at":"2026-02-26T09:38:22.524Z","tags":"docker,aspnet,health-check,yallarhorn"}
{"id":"mem-d3e14b6da88f3d34","information":"Removed legacy files from novena_companion: novena_settings_screen_old_monolithic.dart and novena_app_settings_provider_old_complex.dart. These were identified as obsolete in code review. Verified no imports via grep before deletion, then confirmed with flutter analyze. Pattern: always grep for imports before deleting files, and run analyze to verify.","created_at":"2026-02-23T00:38:45.998Z","tags":"cleanup,legacy,novena,flutter"}
{"id":"mem-d455ff28fbf0fd9a","information":"Fixed nullable reference type warnings (CS8604, CS8602) in .NET project:\n1. For methods returning nullable types (like CleanTitle() returning string?), use null-coalescing `?? \"Unknown\"` or null checks before passing to non-nullable contexts\n2. For JSON deserialization results (like GetAaxInfo() returning AaxInfoDto?), always add null checks before using the result\n3. For null-conditional chains like `voucher?.content_license.license_response.iv`, the intermediate properties also need null-conditional operators. Better to check the whole chain: `if (voucher?.content_license?.license_response is null)` then use non-null access\n4. For LINQ chains on nullable string Split() results, use `?.` throughout: `data.genres?.Split(',')?.Select(...)` then `?? new List<string>()`\n5. In interpolated strings with nullable data, use null-conditional on all property accesses: `$\"{data?.series_title} #{data?.series_sequence}\"`","created_at":"2026-02-23T00:34:39.407Z","tags":"C# nullable reference types CS8604 CS8602 .NET"}
{"id":"mem-d4f9975f5b0aeaf7","information":"FFmpeg concat demuxer \"Line 1: string required\" error debugging:\n1. Check for empty filesToConcat list before writing concat file\n2. Skip null/empty paths in WriteConcatFileAsync\n3. Add debug Console.WriteLine to show file count, paths, and actual concat content\n4. Use Encoding.UTF8 explicitly for WriteAllTextAsync to avoid BOM issues\n5. Validate file paths exist before writing to concat file (log warning if not)\n6. The error \"Line 1: string required\" usually means the concat file is empty or has invalid content on the first line - add validation to throw InvalidOperationException with helpful message when no valid files to process.","created_at":"2026-02-21T10:49:31.011Z","tags":"ffmpeg,concat,debug,error-handling"}
{"id":"mem-d5548d16ecdfa84e","information":"BibleVerse.toString() was crashing on empty text because substring(0, 0) on empty string still causes issues. Fixed by adding `text.isEmpty ? '' :` guard before the substring call. Always check for empty strings before using substring operations in Dart.","created_at":"2026-02-20T04:33:38.955Z","tags":"bug-fix,dart,substring,empty-string,bible-data"}
{"id":"mem-d5e35d3c2dc6ae09","information":".NET 10 includes System.Text.Json as a built-in library. When upgrading from net9.0 to net10.0, explicit PackageReference to System.Text.Json becomes unnecessary and triggers NU1510 warning. If TreatWarningsAsErrors is enabled, this will fail the build. Solution: remove the explicit System.Text.Json package reference from .csproj files when targeting .NET 10+.","created_at":"2026-02-19T22:00:23.533Z","tags":"dotnet,net10.0,upgrade,System.Text.Json,NU1510"}
{"id":"mem-d5f3554821495684","information":"CombinedFeedService aggregates episodes from all enabled channels into a single RSS feed limited to 100 episodes. Key patterns: (1) Create ICombinedFeedService interface with GenerateCombinedFeedAsync(FeedType, CancellationToken) returning FeedGenerationResult. (2) Inject IChannelRepository, IEpisodeRepository, IRssFeedBuilder. (3) Use synthetic Channel entity with Title=\"All Channels\", Description=\"Combined feed from all channels\" for the feed metadata. (4) Query GetEnabledAsync on channelRepository, then GetDownloadedAsync for each channel. (5) Order by PublishedAt descending, take 100 max. (6) Return SHA256 ETag hash of XML content.","created_at":"2026-02-25T21:56:57.819Z","tags":"combined feed,aggregation,C#,RSS,feed service,TDD"}
{"id":"mem-d63388d5383372c8","information":"ASP.NET Core Domain Authorization Pattern (P6-003): When implementing domain-specific authentication (feed vs admin endpoints), use separate authentication schemes with the AddScheme method. Create policy constants (FeedPolicy, AdminPolicy) and scheme constants (FeedAuthScheme, AdminAuthScheme). Register policies with AddAuthorization that tie schemes to policies via AddAuthenticationSchemes. The ICredentialValidator supports domain-aware validation which can validate credentials against a specific domain requirement. For conditional auth (optional based on config), use AddYallarhornAuthIfNeeded which checks AuthOptions.FeedCredentials.Enabled and AdminAuth.Enabled before registering schemes.","created_at":"2026-02-26T02:59:13.082Z","tags":"ASP.NET Core,authentication,authorization,BasicAuth,domain-specific,policies"}
{"id":"mem-d6bd6a83a0a97fa3","information":"Kokoro TTS API voices endpoint returns `{\"voices\": [\"af_heart\", \"am_adam\", ...]}` - an array of voice ID strings, NOT objects. The GetVoicesAsync method must deserialize to a `KokoroVoicesResponse` wrapper class with `voices` property, then transform the string IDs into `KokoroVoice` objects by parsing the voice ID naming convention (e.g., \"af_heart\" = American Female).","created_at":"2026-02-21T06:55:53.510Z","tags":"kokoro,tts,api,json,response-parsing"}
{"id":"mem-d742a719237108a5","information":"VoiceMapper test patterns: \n1. NSubstitute for mocking IOllamaClient works well with Arg.Do for capturing requests and Returns for responses\n2. For fallback testing, use Task.FromException<OllamaResponse>(new OllamaException(...))\n3. Voice ID format is {lang}{gender}_name where lang=(a=American, b=British, f=French, h=Hindi, i=Italian, j=Japanese, p=Portuguese, z=Chinese), gender=(m=male, f=female)\n4. Score formula: 0.5 base + 0.3 gender match + 0.2 language match + 0.05 warm voice name (heart, emma, sarah, sparkle, nova, blaze, serene, peace, calm)\n5. Confidence is capped at 1.0, so avoid tests that expect values > 1.0\n6. The VoiceMapper stores assignments in ConcurrentDictionary - manuscript IDs are case-sensitive, but character IDs within a manuscript are case-insensitive","created_at":"2026-02-21T05:46:50.155Z","tags":"testing,voicemapper,nsubstitute,patterns,c#"}
{"id":"mem-d7b39e98292614cd","information":"AAXCtoM4BConvertor metadata fixes: (1) Use null-coalescing for Split operations on authors/narrators/genres fields from AudibleLibraryDto - these can be null. (2) Use string.Equals with StringComparison.OrdinalIgnoreCase for title matching to handle case variations. (3) Generate metadata.json file using AbsMetadata class pattern from AAXtoM4BConvertor - includes title, subtitle, authors, narrators, series, genres, publishedYear, publishedDate, description, asin.","created_at":"2026-02-22T03:42:08.783Z","tags":"AAXCtoM4BConvertor,metadata,null-safety,case-insensitive,audiobook"}
{"id":"mem-d7be63630a08b7a2","information":"**KokoroVoiceMapper Implementation Pattern**\n\nWhen implementing VoiceMapper for Kokoro TTS voice selection:\n1. Voice ID format: `{lang}{gender}_name` (e.g., `af_heart` = American Female)\n2. Language codes: a=American, b=British, f=French, h=Hindi, i=Italian, j=Japanese, p=Portuguese, z=Chinese\n3. Gender codes: m=male, f=female\n4. IVoiceMapper interface from Skaldforge.Core.Interfaces requires: SuggestVoicesAsync, AssignVoiceAsync, GetAssignmentsAsync, BatchAssignAsync, PreviewVoiceAsync\n5. VoiceMappingPrompt uses temperature 0.4 for creative matching (vs 0.3 for extraction)\n6. Fallback voice scoring: 0.5 base + 0.3 gender match + 0.2 language match\n7. CharacterProfile has Analysis with VocalGender, VocalAge, AccentHints for voice matching\n8. VoiceSuggestion has required VoiceId property - must use object initializer","created_at":"2026-02-21T05:16:35.139Z","tags":"kokoro,voice-mapping,ai-services,patterns"}
{"id":"mem-d7e8021aa210b5eb","information":"When testing file persistence in TTS engines, verify: 1) Directory creation is lazy (not in constructor), 2) Files are written with correct names ({segmentId}.{format}), 3) AudioUrl contains actual file path not placeholder URLs, 4) File contents match audio bytes. Use [SetUp] to create temp directory with Guid in name for isolation, [TearDown] to clean up.","created_at":"2026-02-21T06:42:13.755Z","tags":"testing,audio-persistence,temp-directory,unit-tests"}
{"id":"mem-d83eaa7969dcf65a","information":"Flutter URL validation with SSRF protection: Use Uri.tryParse() for parsing, check scheme (http/https), validate host is non-empty, and block private IP ranges (127.0.0.0/8 localhost, 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, 0.0.0.0, ::1 IPv6 localhost, 'localhost' hostname). Create a UrlValidationResult class for clean return values. The 172.16-31.x.x range check is tricky: check if first octet is 172 AND second is between 16-31 inclusive.","created_at":"2026-02-18T00:17:49.316Z","tags":"flutter,url-validation,ssrf,security,dart"}
{"id":"mem-d847d7c8d3907cc0","information":"SoundFlow 1.4.0 for audio stitching in .NET:\n- Cross-platform (Windows, macOS, Linux) via MiniAudio backend\n- Key classes: MiniAudioEngine, StreamDataProvider, RawDataProvider\n- No built-in LUFS normalization or crossfade - both need custom implementation\n- Crossfade: Use linear volume ramping on overlapping segments\n- Silence: Use RawDataProvider with silent PCM data\n- Namespace conflict: SoundFlow.AudioFormat conflicts with Skaldforge.Core.Models.AudioFormat - use type alias\n- For M4B/MP3 with chapters: delegate to FFmpeg since SoundFlow doesn't support these formats\n- Package: SoundFlow 1.4.0 from NuGet","created_at":"2026-02-22T01:18:22.613Z","tags":"soundflow,audio,stitching,dotnet,cross-platform"}
{"id":"mem-d8e05817d58bf253","information":"3-track stitching implementation in Skaldforge:\n- StitchThreeTrackAsync method in FFmpegStitcher.cs separates audio into 3 tracks: Narration, SFX, Music\n- Each track is built with proper silence gaps then mixed using FFmpeg amix filter\n- Default volumes: Narration 1.0 (100%), SFX 0.7 (70%), Music 0.3 (30%)\n- CLI flag: --three-track or -3 to enable 3-track mode in StitchRunner\n- Debug tracks are saved to temp directory when OutputDebugTracks=true\n- FFmpeg amix uses duration=longest to handle tracks of different lengths\n- Final output is normalized to -16 LUFS as configured\n- SFX track only contains sound effect segments (shorter duration), correctly mixed with longest duration\n\nTest results with domo.json:\n- Narration track: 785.68s (13:05.68) - contains all narration/dialogue\n- SFX track: 139s (2:19) - contains only sound effects\n- Music track: 785.68s (13:05.68) - contains music bed\n- Final mix: 785.68s (13:05.68) - correctly uses longest duration\n- Final loudness: -18.9 LUFS (close to target -16 LUFS)\n- Max volume: -1.5 dB (no clipping)","created_at":"2026-02-26T09:54:02.773Z","tags":"skaldforge,3-track-stitching,ffmpeg,amix,audio-processing"}
{"id":"mem-d8fde7953022b480","information":"Integration tests for RefreshWorker and DownloadWorker should use IHostedService pattern tests (StartAsync/StopAsync), mock external dependencies (YtDlpClient, FfmpegClient, DownloadCoordinator), and use real services for database operations. Key learning: DownloadWorker tests should verify ExecuteDownloadAsync on coordinator, not AcquireSlot/ReleaseSlot.","created_at":"2026-02-26T03:46:17.206Z","tags":"testing integration-workers background-services mock-coordinator"}
{"id":"mem-d9b1b4b0f75bc64b","information":"Android Auto Media Browser for Flutter: media_kit does NOT support Android Auto natively - requires audio_service package as wrapper. Root cause of \"no audio until another app plays\": missing proper AudioFocusRequest with AUDIOFOCUS_GAIN. Solution: Implement AudioHandler interface bridging media_kit Player to audio_service's MediaBrowserServiceCompat. Key gotchas: media_kit video won't display on Android Auto (headless only), need androidStopForegroundOnPause: false for Android 12+ background restart, browse tree size limits.","created_at":"2026-02-21T23:56:22.617Z","tags":"android-auto,flutter,media_kit,audio_service,audio-focus"}
{"id":"mem-da6f642647df4a5f","information":"Yallarhorn configuration validation requires at least one channel defined in the 'channels' array (see YallarhornOptions.Validate() at line 94-97). For development, use 'enabled: false' on a sample channel to satisfy this requirement without actually monitoring any feeds. The YAML configuration uses snake_case for keys which get flattened to PascalCase via the YAML configuration provider (e.g., 'transcodeSettings' maps to 'TranscodeSettings').","created_at":"2026-02-26T02:42:08.674Z","tags":"configuration,yaml,validation,development-setup,yallarhorn"}
{"id":"mem-da7f8e6b60f469f9","information":"Worker test constructor signatures: RefreshWorker and DownloadWorker both use IServiceScopeFactory for scoped service resolution, not direct service mocks. Tests must mock IServiceScopeFactory with proper chain: scopeFactory.CreateScope() → scope.ServiceProvider → GetService(typeof(TService)). Integration tests should use real ServiceProvider.GetService<IServiceScopeFactory>().","created_at":"2026-02-27T00:44:17.859Z","tags":"testing,background-workers,DI,IServiceScopeFactory,mock-setup-pattern"}
{"id":"mem-da8e98b1566359d4","information":"PipelineMetrics implementation pattern for thread-safe statistics: Use Interlocked for simple counters (int64), use lock objects for multi-value consistency (e.g., computing averages requires both count and sum), use ConcurrentDictionary for category-based tracking. IPipelineMetrics interface enables DI/testability. Reset() method clears all state by setting counters to 0 and clearing dictionaries.","created_at":"2026-02-25T09:51:54.680Z","tags":"C#,metrics,thread-safe,counters,Interlocked,ConcurrentDictionary,patterns"}
{"id":"mem-dbb108eb7829016c","information":"Chatterbox TTS integration is complete: TtsConfig.cs has TtsEngine enum (Chatterbox default, Kokoro alternative) and ChatterboxUrl config. DI registration in Program.cs registers both clients and switches ITtsEngine based on config.Engine.","created_at":"2026-02-22T23:18:52.508Z","tags":"tts,chatterbox,kokoro,configuration,di-registration"}
{"id":"mem-dcdc472e0cd797d9","information":"NSubstitute can only mock virtual methods on classes. When testing a class that depends on another concrete class (not an interface), the dependent class methods must be marked as virtual to allow NSubstitute to intercept and mock them. For KokoroClient, I had to make SynthesizeAsync, GetVoicesAsync, IsHealthyAsync, and Dispose virtual to enable proper mocking in tests.","created_at":"2026-02-21T05:37:14.999Z","tags":"testing,nsubstitute,mocking,dotnet,csharp"}
{"id":"mem-dd7b37c392cc146e","information":"StoryParser implementation in Skaldforge.Core uses System.Text.Json with snake_case naming policy (JsonNamingPolicy.SnakeCaseLower). The ValidationResult, ValidationError, ValidationWarning, and ManuscriptStatistics classes are defined in IStoryParser.cs. Domain models use required properties with snake_case JSON property names via JsonPropertyNameAttribute. Schema validation performed manually since no JSON schema library is in dependencies - validates required fields, ID patterns (chapter_xxx, char_xxx, scene_xxx), enum values, and reference integrity between chapters/scenes and dialogue/characters.","created_at":"2026-02-19T20:02:06.235Z","tags":"skaldforge,json-parsing,validation,system.text.json,.net"}
{"id":"mem-de717e7d9c738607","information":"Designed comprehensive architecture for yallarhorn - a greenfield .NET 10 podcast feed generator using youtube-dl. Document includes: high-level component diagram showing REST API, scheduler, download service, feed generator, data access layer; detailed data flow diagrams for downloads, feed requests, and configuration; youtube-dl integration strategy with yt-dlp, supported sources, metadata extraction patterns; REST API boundaries with versioning strategy, resource models, and error codes; Docker container architecture with multi-stage Dockerfile, docker-compose, volume management, and networking. Key design decisions: SQLite for persistence, NCrontab for scheduling, yt-dlp over vanilla youtube-dl, non-root container user, URL path versioning.","created_at":"2026-02-24T00:46:23.538Z","tags":"architecture,design,yallarhorn,podcast,youtube-dl,dotnet,docker"}
{"id":"mem-de92902ca6a4bc96","information":"PagedResult refactoring: Changed from non-generic PagedResult class (Odeon.Core.Interfaces) to generic PagedResult<T> class (Odeon.Core.DTOs). When updating tests:\n1. Add `using Odeon.Core.DTOs;` import\n2. Change all `new PagedResult()` to `new PagedResult<Video>()`\n3. Update method return type assertions from `Task<PagedResult>` to `Task<PagedResult<Video>>`\n4. The generic version has additional properties: PageNumber, TotalPages, HasPreviousPage, HasNextPage, and static methods Empty() and Create()","created_at":"2026-02-17T08:59:53.338Z","tags":"csharp,testing,pagedresult,refactoring"}
{"id":"mem-df15278b4626cace","information":"Watch history tracking implementation pattern in Odeon .NET backend: \n1. Entity with Guid Id, foreign key reference, navigation property using null! for nullable reference types\n2. ApplicationDbContext adds DbSet and configures entity with OnDelete(DeleteBehavior.Cascade)\n3. Interface in Odeon.Core/Interfaces with async methods and XML docs\n4. Service implementation uses scoped lifetime (DbContext), includes logging, structured error handling\n5. Controller uses ApiController attribute, rate limiting, XML doc comments\n6. DTOs are records in Odeon.Api/DTOs\n7. Register service as Scoped in Program.cs after other services","created_at":"2026-02-20T19:45:33.936Z","tags":".NET,EF Core,entity,pattern,Odeon"}
{"id":"mem-e24434189e23101a","information":"Fixed NormalizeAsync in SoundFlowStitcher to copy normalized file back to stitched folder. The bug was that NormalizeAsync wrote to a temp file via _ffmpeg.GetTempFilePath(\"wav\") but the caller used that temp path as the final output. Fix: copy the normalized temp file back to the original outputPath using File.Copy with overwrite, then cleanup the temp file. Final output path now correctly points to the stitched folder location.","created_at":"2026-02-22T03:37:02.519Z","tags":"bugfix,audio,normalization,soundflow,file-path"}
{"id":"mem-e2f4e3b57572604d","information":"Hono API routes pattern for TypeScript:\n- Import Hono from 'hono' and create router with `new Hono()`\n- Use router.get('/path', async (c) => { ... }) for route handlers\n- Access query params with `c.req.query('param')` and path params with `c.req.param('name')`\n- Return JSON with `c.json(data, status?)`\n- Export router as default\n\nError response pattern:\n- Create typed ErrorResponse objects with error code, message, and status\n- Return with appropriate HTTP status codes (400 for validation, 404 for not found, 500 for server errors)\n\nRe-export pattern:\n- Create index.ts that re-exports all routers for clean imports","created_at":"2026-02-20T20:43:53.735Z","tags":"hono,typescript,api-routes,error-handling"}
{"id":"mem-e52dced268f52ce2","information":"FFProbeAnalyzerTests.cs in Harmony.Tests already uses async Task pattern correctly. When task says to convert tests to async, verify current state first - may already be done. The test methods use: `public async Task MethodName()` with `await analyzer.AnalyzeFile()`.","created_at":"2026-02-22T23:13:23.875Z","tags":"c#,xunit,async,testing,harmony"}
{"id":"mem-e5a81bbbf53b6185","information":"Implemented PlaylistService in Odeon.Infrastructure following existing service patterns. Used ApplicationDbContext with EF Core, async methods, proper error handling with try-catch blocks, logging at appropriate levels (LogInformation for operations, LogWarning for not found, LogError for exceptions). Used Include() for eager loading navigation properties (Playlist -> Items -> Video). Implemented all CRUD operations: GetAllPlaylistsAsync, GetPlaylistByIdAsync, CreatePlaylistAsync, UpdatePlaylistAsync, DeletePlaylistAsync (cascades to remove items), AddItemAsync (with position support), RemoveItemAsync (with position recalculation), ReorderItemsAsync (validates item ownership). Build succeeded with 0 warnings, all 394 tests pass.","created_at":"2026-02-23T09:14:15.680Z","tags":"[\"PlaylistService\",\"EF Core\",\"Odeon\",\"CRUD\",\"backend\"]"}
{"id":"mem-e6ccbb34bb0ecac9","information":"Updated docs/TASK_BREAKDOWN.md with 85 new tasks across 6 new phases:\n- Phase 11: Feed Types (Channel Type enum) - T-134 to T-143\n- Phase 12: Transcoding Service (FFmpeg/MP4) - T-144 to T-155  \n- Phase 13: Dual Firehose Feeds (video/audio) - T-156 to T-173\n- Phase 14: Feed Discovery Index - T-174 to T-186\n- Phase 15: Static RSS File Generation - T-187 to T-202\n- Phase 16: System-Wide Download Scheduler - T-203 to T-218\n\nTotal tasks: 218 (was 133). Priority system maintained (P0/P1/P2). Dependencies graph updated. Sprint recommendations expanded to 10 sprints.","created_at":"2026-02-24T04:04:05.673Z","tags":"task-breakdown,documentation,feature-tasks,phases"}
{"id":"mem-e7742dbd1fbca2e3","information":"Liturgical color consistency fix: The sancta_via_shared_ui package provides toLiturgicalColor() extension on String that returns proper liturgical colors respecting colorIntensityProvider. Always use this instead of hardcoded Material Colors. The extension is on the String class (e.g., \"GREEN\".toLiturgicalColor(colorIntensity)) and also as LiturgicalColor enum's toFlutterColor() method. WHITE color returns a vibrant blue (#2196F3) for visibility, not grey.","created_at":"2026-02-24T20:11:09.770Z","tags":"liturgical-colors,shared-ui,riverpod,flutter"}
{"id":"mem-e7d4aded9ed5eb9a","information":"Silence cache race condition: When caching generated silence files for reuse, NEVER add them to the tempFiles cleanup list. The race condition flow: Job A creates silence, caches it, adds to tempFiles, finishes and deletes all tempFiles including the cached silence. Job B requests same silence duration, gets stale cached path that no longer exists. Fix: Silence files are managed by _silenceCache and cleaned in Dispose(), not in job-scoped tempFiles cleanup.","created_at":"2026-02-21T22:00:27.334Z","tags":"ffmpeg,race-condition,temp-files,caching,bug-fix"}
{"id":"mem-e9bf7f0771b1338c","information":"Parallelized batch video info fetching in YtDlpService.GetChannelVideosAsync using IConcurrencyManager.DownloadSemaphore. The key pattern is:\n1. Inject IConcurrencyManager into YtDlpService constructor\n2. Use await _concurrencyManager.DownloadSemaphore.WaitAsync() before fetching each video\n3. Wrap in try/finally with semaphore.Release() to ensure proper cleanup\n4. This throttles parallel fetching to respect MaxConcurrentDownloads limit\n\nThe semaphore ensures that even when processing batches of videos in parallel, the total concurrent yt-dlp calls are limited to prevent rate limiting and resource exhaustion.","created_at":"2026-02-17T23:24:57.903Z","tags":"parallel,semaphore,throttling,yt-dlp,batch-processing,concurrency"}
{"id":"mem-eb2cec88bc7cf944","information":"Silence cache race condition fix verified: Silence files created by GenerateSilenceAsync are no longer added to tempFiles cleanup list. This prevents files from being deleted while cached for reuse across jobs. The fix was confirmed working - cleanup only removes concat artifacts, not silence cache files.","created_at":"2026-02-21T21:59:42.964Z","tags":"stitching,silence-cache,race-condition,fix-verified"}
{"id":"mem-ebcfe3673d343a91","information":"FFmpeg audio format uniformity fix: When concatenating audio files with different formats (TTS: 24000Hz mono 16-bit, SFX/Music: 44100Hz stereo 32-bit float), using `-c copy` causes static/corruption. Solution: Remove `-c copy` and add explicit format parameters `-ar 44100 -ac 2 -c:a pcm_s16le` to normalize all audio to 44100Hz stereo 16-bit PCM during concatenation. This ensures proper transcoding for format compatibility.","created_at":"2026-02-26T05:23:02.481Z","tags":"ffmpeg,audio,concat,transcoding,format,static,pcm_s16le"}
{"id":"mem-ec6326a2dc3e065d","information":"GitHub repository initialization pattern for new projects: 1) git init, 2) Create .gitignore (node_modules, dist, .env, logs, IDE files, coverage), 3) Create LICENSE with Apache 2.0 text (full license text required), 4) Create README.md with project name, description, badge placeholders, installation/usage sections, 5) git add .gitignore LICENSE README.md, 6) git commit -m \"Initial commit: project scaffold\", 7) gh repo create <name> --public --source=. --push. This creates a clean scaffold without code files for separate workers to implement.","created_at":"2026-02-20T20:02:17.195Z","tags":"github,git,initialization,setup,apache-2.0,scaffold,bun,node"}
{"id":"mem-ed689cceed429660","information":"Updated audio session configuration for background playback in Flutter app. Added: 1) WidgetsBindingObserver to handle app lifecycle (paused/resumed) and maintain audio session when app goes to background, 2) WakelockPlus to keep screen on during playback, 3) Audio session configuration in both video_player_provider.dart and audio_service_handler.dart with proper audio attributes for background media playback, 4) Audio focus handling for interruptions (phone calls) and headphone disconnect events.","created_at":"2026-02-23T06:22:57.547Z","tags":"flutter,audio,background-playback,media_kit,wakelock"}
{"id":"mem-ed8c63dd29f5746e","information":"EpisodeCleanupService implementation follows the rolling window pattern from docs/download-pipeline.md:\n\n1. **Rolling Window Cleanup**: Identifies episodes outside channel's episode_count_config by ordering completed episodes by published_at DESC and skipping the first N (keeping newest, deleting oldest).\n\n2. **File Structure**: Handles the standard file structure:\n   - downloads/{channel_id}/audio/{video_id}.mp3\n   - downloads/{channel_id}/video/{video_id}.mp4\n   - downloads/{channel_id}/thumbnails/{video_id}.jpg\n\n3. **Key Design Decisions**:\n   - IFileService abstraction for testability (mockable file operations)\n   - CleanupResult DTO tracks episodesRemoved and bytesFreed (sum of audio + video file sizes)\n   - Only removes episodes with Completed status (not Pending, Failed, etc.)\n   - Marks episodes as Deleted status in database, doesn't hard delete\n   - Handles null file paths gracefully\n   - Thumbnails only deleted if ThumbnailUrl is a local path (not http URL)\n   - Continues on file deletion errors, doesn't fail the whole operation\n\n4. **Testing Pattern**: Used \"\" (empty string) as sentinel in helper method to explicitly set null values, since null means \"use default\".","created_at":"2026-02-25T06:51:16.037Z","tags":"episode-cleanup,rolling-window,file-deletion,yallarhorn,TDD"}
{"id":"mem-ee3d3e5f27b86459","information":"Odeon Backend Security Review: Strong command injection prevention using SecurityHelper.EscapeShellArgument() with null byte removal, newline rejection, and proper quoting. BCrypt with work factor 12 for API key storage. EF Core prevents SQL injection. HTTPS enforced. Rate limiting implemented. Areas for improvement: DTO validation attributes missing, API key logged on startup, video file endpoints bypass auth (documented design decision). No critical vulnerabilities found.","created_at":"2026-02-17T03:04:30.751Z","tags":"security,command-injection,api-authentication,owasp,odeon,backend"}
{"id":"mem-eee33abc1a2ec634","information":"Skaldforge Project Assessment: The project is ~27% complete with Milestone 1 at 60%. Key blockers: no CI/CD, no CLI implementation, no parser implementation. Critical path: CI/CD -> StoryParser -> CLI Commands -> Unit Tests. Placeholder projects (Skaldforge.Tts, Skaldforge.Ai, Skaldforge.Audio) contain only Class1.cs stubs. Exception handling partially exists (only ManuscriptParseException). Note: .NET 8 currently, planned upgrade to .NET 9 recommended after Milestone 1.","created_at":"2026-02-19T21:18:19.222Z","tags":"skaldforge,assessment,project-status,.net,blockers"}
{"id":"mem-ef58b3761fee06ed","information":".NET framework migration: When upgrading .NET projects, check the installed runtime version on the target system. The system had .NET 10 installed but not .NET 9 runtime, so we upgraded directly to net10.0 instead of net9.0. This saved significant debugging time compared to installing a separate runtime. Also: System.Text.Json is built into .NET 10, so explicit package references can be removed to avoid NU1510 warnings.","created_at":"2026-02-19T22:09:08.533Z","tags":"dotnet,migration,runtime-version,skaldforge"}
{"id":"mem-f0a6966cf6ed9103","information":"SoundFlow WavReader failure with LIST chunks: SoundFlow's WavReader.ReadAsync fails when WAV files have LIST chunks before the data chunk (common in Kokoro TTS output). The parser incorrectly calculates DataSize as 0xFFFFFFFF (-1) leading to negative stream position in FileStream.set_Position. Solution: Implement manual WAV parsing with BinaryReader - iterate through chunks until finding 'fmt ' and 'data' chunks, manually convert PCM bytes to float samples, create RawDataProvider with AudioFormat from parsed header. This bypasses SoundFlow's buggy StreamDataProvider(ReadOptions) constructor.","created_at":"2026-02-22T02:50:19.192Z","tags":"soundflow,wav,bug-fix,kokoro-tts,manual-parsing"}
{"id":"mem-f11f35fe4d589a5a","information":"Regex pattern `Part [0-9]` matches \"Part 1\" within \"Part 10\" because it has no word boundary. The pattern only matches a single digit, but without `\\b` boundaries it will find partial matches in longer strings. If you want to match only single-digit part numbers, use `\\bPart [0-9]\\b` or explicitly use `[0-9]` with a trailing boundary check.","created_at":"2026-02-22T21:15:33.510Z","tags":"regex,testing,dotnet,bug-fix"}
{"id":"mem-f13ed999961d5e4e","information":"Prayer JSON format in sancta_via_prayer_companion uses these fields: id (slug), title, text, translation.latin, attribution, notes, categories[], description, tags[], isLiturgical (bool), liturgicalPriority (int 0-10), liturgicalSeason (null or season string like 'easter', 'lent', 'ordinary'), timeOfDay ('morning', 'evening', 'anytime'). New prayers must also be added to prayers_metadata.json with same fields plus fileName.","created_at":"2026-02-22T02:40:02.918Z","tags":"prayer-companion,json-format,data-model"}
{"id":"mem-f388cfa19ef90349","information":"Removed output.json default loading behavior from TestRunner. The LoadManuscriptAsync method now only: (1) loads from command-line argument if provided, or (2) falls back to built-in test manuscript. This ensures explicit file specification by users.","created_at":"2026-02-21T07:14:29.374Z","tags":"testrunner,manuscript-loading,behavior-change"}
{"id":"mem-f3f31c238857e072","information":"When copying providers between apps in a monorepo, check for differences in logging utilities. The unified app uses AppLogger.bibleReading from sancta_via_shared_ui instead of a local AppLogger. Also check for user messaging patterns - the unified app may not have a UserMessageService and may need one created if the provider uses UI messages/snackbars.","created_at":"2026-02-26T19:45:59.904Z","tags":"flutter,riverpod,monorepo,provider-migration,logging"}
{"id":"mem-f49a4bb4aea8407c","information":"SoundFlowStitcher sample rate fix: The audio distortion was caused by using Config.DefaultSampleRate (44100Hz) for crossfade calculations while the actual audio from Kokoro TTS was 24000Hz. Fix: Detect sample rate from the first loaded WAV file in LoadWavDataAsync, store it in _detectedSampleRate and _detectedChannels fields, and use these detected values instead of config defaults for: crossfade samples calculation, silence generation, duration calculation, and audio output format. The LoadWavDataAsync method already extracted sample rate from WAV header - just needed to return it and persist it.","created_at":"2026-02-22T04:07:46.782Z","tags":"audio,sample-rate,distortion,WAV,SoundFlow,Kokoro-TTS"}
{"id":"mem-f59180b71c74b7d1","information":"Flutter Security Best Practices: 1) Always enforce HTTPS for API endpoints, warn on HTTP URLs. 2) Never store API keys in SharedPreferences - use FlutterSecureStorage only. 3) Background services in Flutter cannot access FlutterSecureStorage directly - use encrypted IPC or secure arguments. 4) Always cancel Timer and StreamSubscription in StateNotifier dispose(). 5) Validate and sanitize all URLs before API calls. 6) Use Uri.encodeComponent for URL path segments. 7) Always use try-finally for resource cleanup (HttpClient, etc).","created_at":"2026-02-17T03:16:05.870Z","tags":"flutter,security,async,dispose,api-key,https"}
{"id":"mem-f5b33ed83d24d5d4","information":"EF Core Entity Models for SQLite: When creating entity models with [Key] attribute, the [Required] attribute is not needed on primary key properties as Key implies required. Navigation properties should be declared with virtual for proxy support. Use [Column(\"snake_case\")] to map C# PascalCase to SQLite snake_case naming convention.","created_at":"2026-02-24T22:12:38.822Z","tags":"ef-core,sqlite,entity-models,c-sharp"}
{"id":"mem-f5ccaee091d25027","information":"Async migration verification for Harmony 2.0 .NET project: dotnet build succeeded with 0 errors, dotnet test passed 211/211 tests (213ms), dotnet format Harmony.sln --verify-no-changes passed. When running dotnet format, specify the solution file explicitly (Harmony.sln) when both .sln and .csproj files exist in the root to avoid \"Both a MSBuild project file and solution file found\" error.","created_at":"2026-02-22T23:42:34.001Z","tags":"dotnet async migration build test format C#"}
{"id":"mem-f6e852c5d3fb3fed","information":"Flutter immutable model pattern: Use @immutable annotation from flutter/foundation.dart, const constructor with default values, copyWith with clearApiKey pattern for nullable fields, and Object.hash for hashCode. Test with flutter_test expecting 17+ test cases for robust coverage.","created_at":"2026-02-17T03:30:18.536Z","tags":"flutter,immutable,model,copyWith,testing"}
{"id":"mem-f769c22998eaabec","information":"Set up Serilog logging infrastructure in Program.cs: Configured console and file sinks, minimum log levels (Debug default, Information for Microsoft, Warning for ASP.NET Core), daily rolling file logs with 7-day retention, request logging middleware with request host and scheme enrichment.","created_at":"2026-02-24T04:55:27.535Z","tags":"serilog,logging,Program.cs,dotnet"}
{"id":"mem-f87f1999711e34bd","information":"GoRouter StatefulShellRoute removal pattern in Flutter apps:\n\n**Context:** When removing bottom navigation with StatefulShellRoute to use a simpler route tree:\n\n1. Replace StatefulShellRoute.indexedStack with plain GoRoute list\n2. Each StatefulShellBranch becomes a top-level GoRoute\n3. Remove TabConfig, tabConfigs, and ScaffoldWithBottomNav widgets\n4. Use NoTransitionPage for tab-level screens to maintain instant-switch feel\n5. Add redirect route for backward compatibility: `GoRoute(path: '/home', redirect: (context, state) => '/')` \n\n**Route nesting preserved:** All sub-routes that were inside branch routes work identically when moved to top-level GoRoute routes list.\n\n**Files that reference old routes:** Other screens may have hardcoded `/home` - use redirect for compatibility or update those files.\n\n**Why this matters:** StatefulShellRoute adds complexity for tab state preservation. If tabs don't need independent navigation stacks, standard GoRoute tree is cleaner and easier to understand.","created_at":"2026-02-27T18:44:50.806Z","tags":"flutter,go_router,refactoring,navigation,routes"}
{"id":"mem-f8ac906a55eb63d6","information":"When creating LLM prompt templates for structured JSON extraction in C#, use static classes with string properties for system prompts and factory methods for user prompts. Include: (1) System prompt with role definition and rules, (2) JSON output format specification with examples, (3) User prompt factory methods that accept both text and optional hints, (4) A JSON structure validator. Use temperature 0.3 for deterministic output. Always tell LLM to output ONLY valid JSON with no markdown code blocks.","created_at":"2026-02-20T00:31:50.679Z","tags":"prompt-engineering,llm,json-extraction,csharp,skaldforge"}
{"id":"mem-f91a15ea3c285abd","information":"When copying screens between apps in a monorepo, check provider naming conventions carefully. The unified app uses namespaced provider names (e.g., `bibleTextScaleProvider` instead of `textScaleProvider`). Always verify the correct provider name by checking existing files in the target app. Also, ` ConsumerWidget` can omit flutter_riverpod import if sancta_via_liturgical_calendar_riverpod already re-exports it, but `ConsumerStatefulWidget` requires the explicit flutter_riverpod import for `ConsumerState`.","created_at":"2026-02-26T20:21:06.003Z","tags":"flutter,riverpod,migration,monorepo,providers"}
{"id":"mem-f940e0dce7f2a9fc","information":"Designed youtube-dl (yt-dlp) integration for Yallarhorn podcast feed generator. Key components: Process management with proper lifecycle handling (spawn, monitor, cleanup), output format selection (audio/video, multiple codecs), download queue with priority scheduling and persistence, error classification and retry strategies, rate limiting with per-domain and automatic backoff, and full CLI design with commands for download, queue, status, feed, source, episode, and config management. Document covers all major design decisions and implementation patterns.","created_at":"2026-02-24T02:04:35.383Z","tags":"yt-dlp,youtube-dl,integration,design,process-management,queue,rate-limiting"}
{"id":"mem-fb9a29c9ec297f3c","information":"Testing private methods in C# with xUnit and FluentAssertions: Use reflection with BindingFlags.NonPublic | BindingFlags.Instance to invoke private methods. Pattern: var method = typeof(ClassName).GetMethod(\"MethodName\", BindingFlags.NonPublic | BindingFlags.Instance); return method?.Invoke(instance, new object?[] { param }) as ReturnType. For void methods that throw exceptions, use TargetInvocationException wrapper pattern.","created_at":"2026-02-22T05:10:02.712Z","tags":"c#,testing,xunit,reflection,private-methods,fluentassertions"}
{"id":"mem-fcc034f256957cdd","information":"P5-011: TriggersController implements manual refresh and retry endpoints. \n- POST /api/v1/channels/{id}/refresh returns 202 Accepted with RefreshChannelResponse\n- POST /api/v1/refresh-all returns 202 Accepted with RefreshAllChannelsResponse  \n- POST /api/v1/episodes/{id}/retry returns 202 Accepted or 400/404\n- Uses IChannelRefreshService.RefreshChannelAsync() and RefreshAllChannelsAsync()\n- Retry resets episode Status to Pending, clears RetryCount and ErrorMessage, re-queues via IDownloadQueueService.EnqueueAsync()\n- TDD approach: 18 tests all pass","created_at":"2026-02-26T00:25:28.648Z","tags":"yallarhorn,api-controller,triggers,refresh,retry,episode"}
{"id":"mem-fdc38f3db60ab635","information":"FFmpeg Audio Stitching Implementation Patterns:\n1. Use concat demuxer with file list for combining audio segments - more reliable than filter_complex concat\n2. Two-pass loudnorm requires JSON parsing; single-pass is simpler and still EBU R128 compliant\n3. Silence generation uses lavfi anullsrc - cache silence files for reuse to avoid regeneration\n4. Acrossfade filter syntax: `acrossfade=d={seconds}:c1=tri:c2=tri` with triangle curves\n5. For M4B/Mp3 chapter marks, use FFMETADATA file format with TIMEBASE=1/1000\n6. Always use StringComparison.Ordinal for StartsWith calls to avoid CA1310 warnings\n7. FFmpegWrapper uses Xabe.FFmpeg library which handles process execution and progress reporting","created_at":"2026-02-21T07:30:55.724Z","tags":"ffmpeg,audio-processing,csharp,stitching,loudnorm,crossfade"}
{"id":"mem-ff056cd28a364c71","information":"RSS 2.0 Feed Implementation: Created compliant feed generator using XmlWriter with iTunes namespace support. Key learnings: UTF-8 encoding without BOM requires using UTF8Encoding(false) and MemoryStream. Use feedPath parameter correctly when constructing enclosure URLs. Filter episodes by feed type (Audio needs audio files, Video needs video files). Format iTunes duration as HH:MM:SS for >=1 hour or MM:SS for <1 hour.","created_at":"2026-02-25T21:37:05.811Z","tags":"RSS,XmlWriter,podcast,iTunes,feed-generation,encoding,UTF-8"}
{"id":"mem-ff26103f1cd3c833","information":"FFmpeg sidechaincompress filter for audio ducking: Use `[voice][music]sidechaincompress=threshold=X:ratio=Y:attack=Z:release=W[out]` to automatically duck music when voice is present. Input 0 (voice) acts as sidechain trigger, Input 1 (music) gets compressed. Apply volume filter first to set base music level. Typical values: threshold=0.2, ratio=4, attack=50ms, release=200ms.","created_at":"2026-02-22T23:52:37.220Z","tags":"ffmpeg,audio,ducking,sidechaincompress,mixing"}
{"id":"mem-ffcffc80c8aa3070","information":"POST /api/v1/channels endpoint implementation: CreateChannelRequest model with validation attributes, URL validation for YouTube URLs supporting @channel, /c/, /channel/, /user/ patterns. Returns 201 Created with Location header, 409 Conflict for duplicates, 422 for invalid URLs. Uses IChannelRepository.ExistsByUrlAsync for duplicate check, AddAsync for creation. Channel ID format: ch-{guid}.","created_at":"2026-02-25T22:59:08.502Z","tags":"yallarhorn,api,channels,rest,validation,tdd"}
{"id":"mem-fff101241e8c47d3","information":"FlutterSecureStorage migration for Odeon: AuthService already uses FlutterSecureStorage for credentials. The security issue was in background_polling_service.dart which used SharedPreferences for api_key and server_url. Fixed by updating callbackDispatcher to use FlutterSecureStorage.read() for credentials while keeping SharedPreferences for non-sensitive settings (notifications_enabled, last_check_time). Both storages have different use cases: FlutterSecureStorage for sensitive data (credentials), SharedPreferences for non-sensitive preferences.","created_at":"2026-02-18T00:27:05.213Z","tags":"flutter,security,flutter_secure_storage,shared_preferences,background_task,credentials"}